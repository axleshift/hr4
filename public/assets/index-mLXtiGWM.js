import{r as l,_ as D,R as g,a as A,c as I,P as m,j as e,q as K}from"./index-DsAgKg7Z.js";import{C as b,a as y}from"./CRow-VPNvViah.js";import{C as me,a as fe}from"./CCardBody-gky4UI2P.js";import{C as ve}from"./CCardHeader-2gLzdVZE.js";import{a as N,c as T,d as $}from"./index.esm-C6jsnNTZ.js";import{_ as Ce,f as xe,a as ge,T as je,u as Ne}from"./CCloseButton-DqDioCiC.js";import{C as Ee,a as be,b as V,c as H,d as ye,e as O}from"./CTable-CkW6wg6s.js";import{a as z,b as W,c as q,d as U,e as G}from"./DefaultLayout-D_2L0uY5.js";import{C as J}from"./cil-user-Baf0wv_S.js";import{C as Q}from"./CFormTextarea-d9_kHojz.js";var ce=l.createContext({}),Z=l.forwardRef(function(s,i){var p=s.children,r=s.activeItemKey,o=s.alwaysOpen,d=o===void 0?!1:o,h=s.className,a=s.flush,t=D(s,["children","activeItemKey","alwaysOpen","className","flush"]),n=l.useState(r),f=n[0],v=n[1];return g.createElement("div",A({className:I("accordion",{"accordion-flush":a},h)},t,{ref:i}),g.createElement(ce.Provider,{value:{_activeItemKey:f,alwaysOpen:d,setActiveKey:v}},p))});Z.propTypes={alwaysOpen:m.bool,activeItemKey:m.oneOfType([m.number,m.string]),children:m.node,className:m.string,flush:m.bool};Z.displayName="CAccordion";var ee=l.createContext({}),se=l.forwardRef(function(s,i){var p=s.children,r=s.className,o=s.id,d=s.itemKey,h=D(s,["children","className","id","itemKey"]),a=o??l.useId(),t=l.useRef(d??a),n=l.useContext(ce),f=n._activeItemKey,v=n.alwaysOpen,C=n.setActiveKey,x=l.useState(f===t.current),j=x[0],E=x[1];return l.useEffect(function(){!v&&j&&C(t.current)},[j]),l.useEffect(function(){E(f===t.current)},[f]),g.createElement("div",A({className:I("accordion-item",r)},h,{ref:i}),g.createElement(ee.Provider,{value:{id:a,setVisible:E,visible:j}},p))});se.propTypes={children:m.node,className:m.string,itemKey:m.oneOfType([m.number,m.string])};se.displayName="CAccordionItem";function Y(){return Y=Object.assign?Object.assign.bind():function(s){for(var i=1;i<arguments.length;i++){var p=arguments[i];for(var r in p)({}).hasOwnProperty.call(p,r)&&(s[r]=p[r])}return s},Y.apply(null,arguments)}function Ae(s,i){return s.classList?!!i&&s.classList.contains(i):(" "+(s.className.baseVal||s.className)+" ").indexOf(" "+i+" ")!==-1}function we(s,i){s.classList?s.classList.add(i):Ae(s,i)||(typeof s.className=="string"?s.className=s.className+" "+i:s.setAttribute("class",(s.className&&s.className.baseVal||"")+" "+i))}function le(s,i){return s.replace(new RegExp("(^|\\s)"+i+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function Se(s,i){s.classList?s.classList.remove(i):typeof s.className=="string"?s.className=le(s.className,i):s.setAttribute("class",le(s.className&&s.className.baseVal||"",i))}var Te=function(i,p){return i&&p&&p.split(" ").forEach(function(r){return we(i,r)})},X=function(i,p){return i&&p&&p.split(" ").forEach(function(r){return Se(i,r)})},re=function(s){Ce(i,s);function i(){for(var r,o=arguments.length,d=new Array(o),h=0;h<o;h++)d[h]=arguments[h];return r=s.call.apply(s,[this].concat(d))||this,r.appliedClasses={appear:{},enter:{},exit:{}},r.onEnter=function(a,t){var n=r.resolveArguments(a,t),f=n[0],v=n[1];r.removeClasses(f,"exit"),r.addClass(f,v?"appear":"enter","base"),r.props.onEnter&&r.props.onEnter(a,t)},r.onEntering=function(a,t){var n=r.resolveArguments(a,t),f=n[0],v=n[1],C=v?"appear":"enter";r.addClass(f,C,"active"),r.props.onEntering&&r.props.onEntering(a,t)},r.onEntered=function(a,t){var n=r.resolveArguments(a,t),f=n[0],v=n[1],C=v?"appear":"enter";r.removeClasses(f,C),r.addClass(f,C,"done"),r.props.onEntered&&r.props.onEntered(a,t)},r.onExit=function(a){var t=r.resolveArguments(a),n=t[0];r.removeClasses(n,"appear"),r.removeClasses(n,"enter"),r.addClass(n,"exit","base"),r.props.onExit&&r.props.onExit(a)},r.onExiting=function(a){var t=r.resolveArguments(a),n=t[0];r.addClass(n,"exit","active"),r.props.onExiting&&r.props.onExiting(a)},r.onExited=function(a){var t=r.resolveArguments(a),n=t[0];r.removeClasses(n,"exit"),r.addClass(n,"exit","done"),r.props.onExited&&r.props.onExited(a)},r.resolveArguments=function(a,t){return r.props.nodeRef?[r.props.nodeRef.current,a]:[a,t]},r.getClassNames=function(a){var t=r.props.classNames,n=typeof t=="string",f=n&&t?t+"-":"",v=n?""+f+a:t[a],C=n?v+"-active":t[a+"Active"],x=n?v+"-done":t[a+"Done"];return{baseClassName:v,activeClassName:C,doneClassName:x}},r}var p=i.prototype;return p.addClass=function(o,d,h){var a=this.getClassNames(d)[h+"ClassName"],t=this.getClassNames("enter"),n=t.doneClassName;d==="appear"&&h==="done"&&n&&(a+=" "+n),h==="active"&&o&&xe(o),a&&(this.appliedClasses[d][h]=a,Te(o,a))},p.removeClasses=function(o,d){var h=this.appliedClasses[d],a=h.base,t=h.active,n=h.done;this.appliedClasses[d]={},a&&X(o,a),t&&X(o,t),n&&X(o,n)},p.render=function(){var o=this.props;o.classNames;var d=ge(o,["classNames"]);return g.createElement(je,Y({},d,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},i}(g.Component);re.defaultProps={classNames:""};re.propTypes={};var ae=l.forwardRef(function(s,i){var p=s.children,r=s.className,o=s.horizontal,d=s.onHide,h=s.onShow,a=s.visible,t=D(s,["children","className","horizontal","onHide","onShow","visible"]),n=l.useRef(null),f=Ne(i,n),v=l.useState(),C=v[0],x=v[1],j=l.useState(),E=j[0],w=j[1],P=function(){if(h&&h(),o){n.current&&w(n.current.scrollWidth);return}n.current&&x(n.current.scrollHeight)},k=function(){if(o){w(0);return}x(0)},M=function(){if(o){n.current&&w(n.current.scrollWidth);return}n.current&&x(n.current.scrollHeight)},B=function(){if(d&&d(),o){w(0);return}x(0)},_=function(){if(o){w(0);return}x(0)};return g.createElement(re,{in:a,nodeRef:n,onEntering:P,onEntered:k,onExit:M,onExiting:B,onExited:_,timeout:350},function(S){var F=C===0?null:{height:C},L=E===0?null:{width:E};return g.createElement("div",A({className:I(r,{"collapse-horizontal":o,collapsing:S==="entering"||S==="exiting","collapse show":S==="entered",collapse:S==="exited"}),style:A(A({},F),L)},t,{ref:f}),p)})});ae.propTypes={children:m.node,className:m.string,horizontal:m.bool,onHide:m.func,onShow:m.func,visible:m.bool};ae.displayName="CCollapse";var ne=l.forwardRef(function(s,i){var p=s.children,r=s.className,o=D(s,["children","className"]),d=l.useContext(ee),h=d.id,a=d.visible;return g.createElement(ae,{className:"accordion-collapse",id:h,visible:a},g.createElement("div",A({className:I("accordion-body",r)},o,{ref:i}),p))});ne.propTypes={children:m.node,className:m.string};ne.displayName="CAccordionBody";var ie=l.forwardRef(function(s,i){var p=s.children,r=s.className,o=D(s,["children","className"]),d=l.useContext(ee),h=d.id,a=d.visible,t=d.setVisible;return g.createElement("button",A({type:"button",className:I("accordion-button",{collapsed:!a},r),"aria-controls":h,"aria-expanded":a,onClick:function(){return t(!a)}},o,{ref:i}),p)});ie.propTypes={children:m.node,className:m.string};ie.displayName="CAccordionButton";var te=l.forwardRef(function(s,i){var p=s.children,r=s.className,o=D(s,["children","className"]);return g.createElement("div",A({className:I("accordion-header",r)},o,{ref:i}),g.createElement(ie,null,p))});te.propTypes={children:m.node,className:m.string};te.displayName="CAccordionHeader";const ke=()=>{const[s,i]=l.useState([]),[p,r]=l.useState([]),[o,d]=l.useState(""),[h,a]=l.useState(""),[t,n]=l.useState(""),[f,v]=l.useState(""),[C,x]=l.useState({title:"",description:"",file:null}),[j,E]=l.useState(null),[w,P]=l.useState(!1),[k,M]=l.useState(!1),[B,_]=l.useState(!1),[S,F]=l.useState([]);l.useEffect(()=>{(async()=>{try{const u=await K.get("/api/programs");i(u.data.data)}catch(u){console.error("Error fetching programs:",u)}})()},[]),l.useEffect(()=>{(async()=>{try{const u=await K.get("/api/courses");r(u.data.data)}catch(u){console.error("Error fetching courses:",u)}})()},[]),l.useEffect(()=>{(async()=>{if(j)try{const u=await K.get(`/api/modules?course_id=${j}`);F(u.data.data)}catch(u){console.error("Error fetching modules:",u)}})()},[j]);const L=async()=>{try{const c=await K.post("/api/programs",{title:o,description:h});i(u=>[...u,c.data.data]),d(""),a(""),P(!1)}catch(c){console.error("Error adding program:",c)}},de=async()=>{try{const c=await K.post("/api/courses",{title:t,description:f,program_id:j});r([...p,c.data]),M(!1)}catch(c){console.error("Error saving course:",c)}},oe=c=>{const{id:u,value:R}=c.target;x(he=>({...he,[u]:R}))},ue=c=>{x(u=>({...u,file:c.target.files[0]}))},pe=async()=>{var u;const c=new FormData;c.append("title",C.title),c.append("description",C.description),c.append("course_id",j),C.file&&c.append("file",C.file);try{await K.post("/api/modules",c,{headers:{"Content-Type":"multipart/form-data"}}),x({title:"",description:"",file:null}),_(!1)}catch(R){console.error("Error uploading module:",((u=R.response)==null?void 0:u.data)||R.message)}};return e.jsxs(b,{children:[e.jsx(y,{xs:12,children:e.jsxs(me,{className:"mb-4",children:[e.jsxs(ve,{children:[e.jsx("strong",{children:"List of Programs"}),e.jsx("div",{className:"d-grid gap-2 d-md-flex justify-content-md-end",children:e.jsx(N,{color:"primary",onClick:()=>P(!0),children:"Add Program"})})]}),e.jsx(fe,{children:e.jsx(Z,{alwaysOpen:!0,children:s.map(c=>e.jsxs(se,{children:[e.jsx(te,{onClick:()=>{E(c.id)},children:c.title}),e.jsxs(ne,{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Description:"})," ",c.description]}),e.jsx(N,{color:"primary",onClick:()=>{E(c.id),M(!0)},children:"Add Course"}),e.jsxs(Ee,{striped:!0,className:"mt-3",children:[e.jsx(be,{children:e.jsxs(V,{children:[e.jsx(H,{children:"Title"}),e.jsx(H,{children:"Description"}),e.jsx(H,{children:"Module"}),e.jsx(H,{children:"Actions"})]})}),e.jsx(ye,{children:S.length>0?S.map((u,R)=>e.jsxs(V,{children:[e.jsx(H,{children:R+1}),e.jsx(O,{children:u.title}),e.jsx(O,{children:u.description}),e.jsx(O,{children:u.file_url?e.jsx("a",{href:u.file_url,target:"_blank",rel:"noopener noreferrer",children:u.file_name||"Download"}):e.jsx("span",{children:"No File"})}),e.jsx(O,{children:e.jsx(N,{color:"danger",size:"sm",onClick:()=>handleDelete(u.id),children:"Delete"})})]},u.id)):e.jsx(V,{children:e.jsx(O,{colSpan:5,className:"text-center",children:"No modules available."})})})]})]})]},c.id))})})]})}),e.jsxs(z,{size:"xl",visible:w,onClose:()=>P(!1),children:[e.jsx(W,{children:e.jsx(q,{children:"Add Program"})}),e.jsx(U,{children:e.jsxs(J,{children:[e.jsx(b,{className:"mb-3",children:e.jsxs(y,{md:12,children:[e.jsx(T,{children:"Program Title"}),e.jsx($,{value:o,onChange:c=>d(c.target.value)})]})}),e.jsx(b,{className:"mb-3",children:e.jsxs(y,{md:12,children:[e.jsx(T,{children:"Program Description"}),e.jsx(Q,{value:h,onChange:c=>a(c.target.value)})]})})]})}),e.jsxs(G,{children:[e.jsx(N,{color:"secondary",onClick:()=>P(!1),children:"Close"}),e.jsx(N,{color:"primary",onClick:L,children:"Save Program"})]})]}),e.jsxs(z,{size:"xl",visible:k,onClose:()=>M(!1),children:[e.jsx(W,{children:e.jsx(q,{children:"Add Course"})}),e.jsx(U,{children:e.jsxs(J,{children:[e.jsx(b,{className:"mb-3",children:e.jsxs(y,{md:12,children:[e.jsx(T,{children:"Course Title"}),e.jsx($,{value:t,onChange:c=>n(c.target.value)})]})}),e.jsx(b,{className:"mb-3",children:e.jsxs(y,{md:12,children:[e.jsx(T,{children:"Course Description"}),e.jsx(Q,{value:f,onChange:c=>v(c.target.value)})]})})]})}),e.jsxs(G,{children:[e.jsx(N,{color:"secondary",onClick:()=>M(!1),children:"Close"}),e.jsx(N,{color:"primary",onClick:de,disabled:!t||!f,children:"Save Course"})]})]}),e.jsxs(z,{size:"xl",visible:B,onClose:()=>_(!1),children:[e.jsx(W,{children:e.jsx(q,{children:"Add Module"})}),e.jsx(U,{children:e.jsxs(J,{children:[e.jsx(b,{className:"mb-3",children:e.jsxs(y,{md:12,children:[e.jsx(T,{children:"Module Title"}),e.jsx($,{id:"title",value:C.title,onChange:oe})]})}),e.jsx(b,{className:"mb-3",children:e.jsxs(y,{md:12,children:[e.jsx(T,{children:"Module Description"}),e.jsx(Q,{id:"description",value:C.description,onChange:oe})]})}),e.jsx(b,{className:"mb-3",children:e.jsxs(y,{md:12,children:[e.jsx(T,{children:"Upload File"}),e.jsx($,{type:"file",onChange:ue})]})})]})}),e.jsxs(G,{children:[e.jsx(N,{color:"secondary",onClick:()=>_(!1),children:"Close"}),e.jsx(N,{color:"primary",onClick:pe,children:"Save Module"})]})]})]})};export{ke as default};
