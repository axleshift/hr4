import{r as d,_ as D,R as j,a as w,c as q,P as o,j as e,q as S}from"./index-6NfMQuN0.js";import{a as B,b as L,c as z,d as M,e as W}from"./DefaultLayout-cj7-gBMi.js";import{C as ae}from"./cil-user-C4A4TsWl.js";import{C as A,a as P}from"./CRow-C91XLr1-.js";import{c as $,d as U,a as E}from"./index.esm-DHHhxzBY.js";import{C as te}from"./CFormTextarea-BJTiTDYY.js";import{C as ye,a as Ne}from"./CCardBody-Cm6e7ssY.js";import{C as Ee}from"./CCardHeader-nZW_hCNQ.js";import{_ as we,f as Re,a as Te,T as Se,u as Ae}from"./CCloseButton-B3BzSZCr.js";import{C as Pe,a as De,b as ne,c as O,d as qe,e as V}from"./CTable-BL3Qcmr0.js";var le=d.createContext({}),Q=d.forwardRef(function(r,t){var m=r.children,s=r.activeItemKey,l=r.alwaysOpen,u=l===void 0?!1:l,p=r.className,i=r.flush,n=D(r,["children","activeItemKey","alwaysOpen","className","flush"]),a=d.useState(s),h=a[0],v=a[1];return j.createElement("div",w({className:q("accordion",{"accordion-flush":i},p)},n,{ref:t}),j.createElement(le.Provider,{value:{_activeItemKey:h,alwaysOpen:u,setActiveKey:v}},m))});Q.propTypes={alwaysOpen:o.bool,activeItemKey:o.oneOfType([o.number,o.string]),children:o.node,className:o.string,flush:o.bool};Q.displayName="CAccordion";var X=d.createContext({}),Y=d.forwardRef(function(r,t){var m=r.children,s=r.className,l=r.id,u=r.itemKey,p=D(r,["children","className","id","itemKey"]),i=l??d.useId(),n=d.useRef(u??i),a=d.useContext(le),h=a._activeItemKey,v=a.alwaysOpen,C=a.setActiveKey,g=d.useState(h===n.current),b=g[0],y=g[1];return d.useEffect(function(){!v&&b&&C(n.current)},[b]),d.useEffect(function(){y(h===n.current)},[h]),j.createElement("div",w({className:q("accordion-item",s)},p,{ref:t}),j.createElement(X.Provider,{value:{id:i,setVisible:y,visible:b}},m))});Y.propTypes={children:o.node,className:o.string,itemKey:o.oneOfType([o.number,o.string])};Y.displayName="CAccordionItem";function J(){return J=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var m=arguments[t];for(var s in m)({}).hasOwnProperty.call(m,s)&&(r[s]=m[s])}return r},J.apply(null,arguments)}function Fe(r,t){return r.classList?!!t&&r.classList.contains(t):(" "+(r.className.baseVal||r.className)+" ").indexOf(" "+t+" ")!==-1}function Ke(r,t){r.classList?r.classList.add(t):Fe(r,t)||(typeof r.className=="string"?r.className=r.className+" "+t:r.setAttribute("class",(r.className&&r.className.baseVal||"")+" "+t))}function oe(r,t){return r.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function _e(r,t){r.classList?r.classList.remove(t):typeof r.className=="string"?r.className=oe(r.className,t):r.setAttribute("class",oe(r.className&&r.className.baseVal||"",t))}var $e=function(t,m){return t&&m&&m.split(" ").forEach(function(s){return Ke(t,s)})},G=function(t,m){return t&&m&&m.split(" ").forEach(function(s){return _e(t,s)})},Z=function(r){we(t,r);function t(){for(var s,l=arguments.length,u=new Array(l),p=0;p<l;p++)u[p]=arguments[p];return s=r.call.apply(r,[this].concat(u))||this,s.appliedClasses={appear:{},enter:{},exit:{}},s.onEnter=function(i,n){var a=s.resolveArguments(i,n),h=a[0],v=a[1];s.removeClasses(h,"exit"),s.addClass(h,v?"appear":"enter","base"),s.props.onEnter&&s.props.onEnter(i,n)},s.onEntering=function(i,n){var a=s.resolveArguments(i,n),h=a[0],v=a[1],C=v?"appear":"enter";s.addClass(h,C,"active"),s.props.onEntering&&s.props.onEntering(i,n)},s.onEntered=function(i,n){var a=s.resolveArguments(i,n),h=a[0],v=a[1],C=v?"appear":"enter";s.removeClasses(h,C),s.addClass(h,C,"done"),s.props.onEntered&&s.props.onEntered(i,n)},s.onExit=function(i){var n=s.resolveArguments(i),a=n[0];s.removeClasses(a,"appear"),s.removeClasses(a,"enter"),s.addClass(a,"exit","base"),s.props.onExit&&s.props.onExit(i)},s.onExiting=function(i){var n=s.resolveArguments(i),a=n[0];s.addClass(a,"exit","active"),s.props.onExiting&&s.props.onExiting(i)},s.onExited=function(i){var n=s.resolveArguments(i),a=n[0];s.removeClasses(a,"exit"),s.addClass(a,"exit","done"),s.props.onExited&&s.props.onExited(i)},s.resolveArguments=function(i,n){return s.props.nodeRef?[s.props.nodeRef.current,i]:[i,n]},s.getClassNames=function(i){var n=s.props.classNames,a=typeof n=="string",h=a&&n?n+"-":"",v=a?""+h+i:n[i],C=a?v+"-active":n[i+"Active"],g=a?v+"-done":n[i+"Done"];return{baseClassName:v,activeClassName:C,doneClassName:g}},s}var m=t.prototype;return m.addClass=function(l,u,p){var i=this.getClassNames(u)[p+"ClassName"],n=this.getClassNames("enter"),a=n.doneClassName;u==="appear"&&p==="done"&&a&&(i+=" "+a),p==="active"&&l&&Re(l),i&&(this.appliedClasses[u][p]=i,$e(l,i))},m.removeClasses=function(l,u){var p=this.appliedClasses[u],i=p.base,n=p.active,a=p.done;this.appliedClasses[u]={},i&&G(l,i),n&&G(l,n),a&&G(l,a)},m.render=function(){var l=this.props;l.classNames;var u=Te(l,["classNames"]);return j.createElement(Se,J({},u,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},t}(j.Component);Z.defaultProps={classNames:""};Z.propTypes={};var ee=d.forwardRef(function(r,t){var m=r.children,s=r.className,l=r.horizontal,u=r.onHide,p=r.onShow,i=r.visible,n=D(r,["children","className","horizontal","onHide","onShow","visible"]),a=d.useRef(null),h=Ae(t,a),v=d.useState(),C=v[0],g=v[1],b=d.useState(),y=b[0],N=b[1],H=function(){if(p&&p(),l){a.current&&N(a.current.scrollWidth);return}a.current&&g(a.current.scrollHeight)},F=function(){if(l){N(0);return}g(0)},R=function(){if(l){a.current&&N(a.current.scrollWidth);return}a.current&&g(a.current.scrollHeight)},x=function(){if(u&&u(),l){N(0);return}g(0)},K=function(){if(l){N(0);return}g(0)};return j.createElement(Z,{in:i,nodeRef:a,onEntering:H,onEntered:F,onExit:R,onExiting:x,onExited:K,timeout:350},function(T){var I=C===0?null:{height:C},k=y===0?null:{width:y};return j.createElement("div",w({className:q(s,{"collapse-horizontal":l,collapsing:T==="entering"||T==="exiting","collapse show":T==="entered",collapse:T==="exited"}),style:w(w({},I),k)},n,{ref:h}),m)})});ee.propTypes={children:o.node,className:o.string,horizontal:o.bool,onHide:o.func,onShow:o.func,visible:o.bool};ee.displayName="CCollapse";var se=d.forwardRef(function(r,t){var m=r.children,s=r.className,l=D(r,["children","className"]),u=d.useContext(X),p=u.id,i=u.visible;return j.createElement(ee,{className:"accordion-collapse",id:p,visible:i},j.createElement("div",w({className:q("accordion-body",s)},l,{ref:t}),m))});se.propTypes={children:o.node,className:o.string};se.displayName="CAccordionBody";var re=d.forwardRef(function(r,t){var m=r.children,s=r.className,l=D(r,["children","className"]),u=d.useContext(X),p=u.id,i=u.visible,n=u.setVisible;return j.createElement("button",w({type:"button",className:q("accordion-button",{collapsed:!i},s),"aria-controls":p,"aria-expanded":i,onClick:function(){return n(!i)}},l,{ref:t}),m)});re.propTypes={children:o.node,className:o.string};re.displayName="CAccordionButton";var ie=d.forwardRef(function(r,t){var m=r.children,s=r.className,l=D(r,["children","className"]);return j.createElement("div",w({className:q("accordion-header",s)},l,{ref:t}),j.createElement(re,null,m))});ie.propTypes={children:o.node,className:o.string};ie.displayName="CAccordionHeader";const ce=({visibleProgram:r,setVisibleProgram:t,programTitle:m,setProgramTitle:s,programDescription:l,setProgramDescription:u,handleSaveProgram:p,visibleCourse:i,setVisibleCourse:n,courseTitle:a,setCourseTitle:h,courseDescription:v,setCourseDescription:C,setCourseFile:g,handleSaveCourse:b,modalVisible:y,setModalVisible:N,base64Doc:H,mimeType:F,fileName:R})=>e.jsxs(e.Fragment,{children:[e.jsxs(B,{size:"lg",visible:r,onClose:()=>t(!1),children:[e.jsx(L,{children:e.jsx(z,{children:"Add Program"})}),e.jsx(M,{children:e.jsxs(ae,{children:[e.jsx(A,{className:"mb-3",children:e.jsxs(P,{md:12,children:[e.jsx($,{children:"Program Title"}),e.jsx(U,{value:m,onChange:x=>s(x.target.value)})]})}),e.jsx(A,{className:"mb-3",children:e.jsxs(P,{md:12,children:[e.jsx($,{children:"Program Description"}),e.jsx(te,{value:l,onChange:x=>u(x.target.value)})]})})]})}),e.jsxs(W,{children:[e.jsx(E,{color:"secondary",onClick:()=>t(!1),children:"Close"}),e.jsx(E,{color:"primary",onClick:p,children:"Save Program"})]})]}),e.jsxs(B,{size:"lg",visible:i,onClose:()=>n(!1),children:[e.jsx(L,{children:e.jsx(z,{children:"Add Course"})}),e.jsx(M,{children:e.jsxs(ae,{children:[e.jsx(A,{className:"mb-3",children:e.jsxs(P,{md:12,children:[e.jsx($,{children:"Course Title"}),e.jsx(U,{value:a,onChange:x=>h(x.target.value)})]})}),e.jsx(A,{className:"mb-3",children:e.jsxs(P,{md:12,children:[e.jsx($,{children:"Course Description"}),e.jsx(te,{value:v,onChange:x=>C(x.target.value)})]})}),e.jsx(A,{className:"mb-3",children:e.jsxs(P,{md:12,children:[e.jsx($,{children:"Upload File"}),e.jsx(U,{type:"file",onChange:x=>g(x.target.files[0])})]})})]})}),e.jsxs(W,{children:[e.jsx(E,{color:"secondary",onClick:()=>n(!1),children:"Close"}),e.jsx(E,{color:"primary",onClick:b,children:"Save Course"})]})]}),e.jsxs(B,{size:"lg",visible:y,onClose:()=>N(!1),children:[e.jsx(L,{children:e.jsx(z,{children:R})}),e.jsx(M,{children:e.jsx("object",{data:H,type:F,style:{width:"100%",height:"600px"},children:"Document Preview Unavailable"})}),e.jsx(W,{children:e.jsx(E,{color:"secondary",onClick:()=>N(!1),children:"Close"})})]})]});ce.propTypes={visibleProgram:o.bool.isRequired,setVisibleProgram:o.func.isRequired,programTitle:o.string.isRequired,setProgramTitle:o.func.isRequired,programDescription:o.string.isRequired,setProgramDescription:o.func.isRequired,handleSaveProgram:o.func.isRequired,visibleCourse:o.bool.isRequired,setVisibleCourse:o.func.isRequired,courseTitle:o.string.isRequired,setCourseTitle:o.func.isRequired,courseDescription:o.string.isRequired,setCourseDescription:o.func.isRequired,setCourseFile:o.func.isRequired,handleSaveCourse:o.func.isRequired,modalVisible:o.bool.isRequired,setModalVisible:o.func.isRequired,base64Doc:o.string.isRequired,mimeType:o.string.isRequired,fileName:o.string.isRequired};const Ue=()=>{const[r,t]=d.useState([]),[m,s]=d.useState([]),[l,u]=d.useState(""),[p,i]=d.useState(""),[n,a]=d.useState(""),[h,v]=d.useState(""),[C,g]=d.useState(null),[b,y]=d.useState(null),[N,H]=d.useState(null),[F,R]=d.useState(!1),[x,K]=d.useState(!1),[T,I]=d.useState(!1),[k,de]=d.useState(""),[ue,pe]=d.useState(""),[me,he]=d.useState("");d.useEffect(()=>{(async()=>{try{const c=await S.get("/api/programs");t(c.data.data)}catch(c){console.error("Error fetching programs:",c)}})()},[]);const fe=async f=>{try{const c=await S.get(`/api/courses?program_id=${f}`);s(c.data.data)}catch(c){console.error("Error fetching courses:",c)}},ve=async f=>{try{const c=await S.get(`/api/courses/${f}/preview`);de(c.data.base64),pe(c.data.mime_type),he(c.data.file_name),I(!0)}catch(c){console.error("Error fetching document preview:",c),alert("Failed to fetch document preview.")}},Ce=async()=>{if(!l||!p){alert("Please provide both title and description for the program.");return}try{const f=await S.post("/api/programs",{title:l,description:p});t(c=>[...c,f.data.data]),u(""),i(""),R(!1)}catch(f){console.error("Error adding program:",f),alert("Failed to add program.")}},ge=async f=>{if(f.preventDefault(),!n||!h){alert("Please provide both title and description for the course.");return}const c=new FormData;c.append("title",n),c.append("description",h),c.append("program_id",b),C&&c.append("file",C);try{const _=await S.post("/api/courses",c,{headers:{"Content-Type":"multipart/form-data"}});s(be=>[...be,_.data]),K(!1),a(""),v(""),g(null)}catch(_){console.error("Error saving course:",_),alert("Failed to save course.")}},xe=async f=>{try{await S.delete(`/api/courses/${f}`),s(c=>c.filter(_=>_.id!==f))}catch(c){console.error("Error deleting course:",c),alert("Failed to delete course.")}},je=f=>{ve(f)};return e.jsxs(A,{children:[e.jsx(P,{xs:12,children:e.jsxs(ye,{className:"mb-4",children:[e.jsxs(Ee,{children:[e.jsx("strong",{children:"List of Programs"}),e.jsx("div",{className:"d-grid gap-2 d-md-flex justify-content-md-end",children:e.jsx(E,{color:"primary",onClick:()=>R(!0),children:"Add Program"})})]}),e.jsx(Ne,{children:e.jsx(Q,{alwaysOpen:!0,children:r.map(f=>e.jsxs(Y,{children:[e.jsx(ie,{onClick:()=>{fe(f.id)},children:f.title}),e.jsxs(se,{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Description:"})," ",f.description]}),e.jsx(E,{color:"primary",onClick:()=>{y(f.id),K(!0)},children:"Add Course"}),e.jsxs(Pe,{striped:!0,className:"mt-3",children:[e.jsx(De,{children:e.jsxs(ne,{children:[e.jsx(O,{children:"Course Title"}),e.jsx(O,{children:"Description"}),e.jsx(O,{children:"File"}),e.jsx(O,{children:"Actions"})]})}),e.jsx(qe,{children:m.filter(c=>c.program_id===f.id).map(c=>e.jsxs(ne,{children:[e.jsx(V,{children:c.title}),e.jsx(V,{children:c.description}),e.jsx(V,{children:c.file_path?e.jsx("a",{href:c.file_path,target:"_blank",rel:"noopener noreferrer",children:c.file_name||"Download"}):e.jsx("span",{children:"No File"})}),e.jsxs(V,{children:[e.jsx(E,{color:"info",onClick:()=>je(c.id),children:"Preview"}),e.jsx(E,{color:"danger",onClick:()=>xe(c.id),children:"Delete"})]})]},c.id))})]})]})]},f.id))})})]})}),e.jsx(ce,{visibleProgram:F,setVisibleProgram:R,programTitle:l,setProgramTitle:u,programDescription:p,setProgramDescription:i,handleSaveProgram:Ce,visibleCourse:x,setVisibleCourse:K,courseTitle:n,setCourseTitle:a,courseDescription:h,setCourseDescription:v,setCourseFile:g,handleSaveCourse:ge,modalVisible:T,setModalVisible:I,base64Doc:k,mimeType:ue,fileName:me})]})};export{Ue as default};
