import{r,x as y,i as E,j as s}from"./index-BY04eC3l.js";import{C as w,a as m}from"./CRow-DB-IXRfA.js";import{C as R,a as $}from"./CCardBody-CJp85-qd.js";import{C as L}from"./CCardHeader-1FNO5P_i.js";import{d as U,a as u}from"./index.esm-fSmVhdgo.js";import{C as N}from"./CFormSelect-DxQbLg0R.js";import{C as A,a as O,b as x,c as n,d as z,e as a}from"./CTable-UIr1Z46E.js";import{a as Y,b as q,c as G,d as J,e as K,f as p}from"./DefaultLayout-BnqhCivS.js";import"./CCloseButton-CyiN9K0a.js";import"./cil-user-D-eyR8GA.js";const le=()=>{const[S,o]=r.useState([]),[b,j]=r.useState([]),[g,v]=r.useState(""),[i,T]=r.useState("all"),[H,l]=r.useState(!1),[c,B]=r.useState(null),[d,C]=r.useState("pending");r.useEffect(()=>{M(),F()},[]);const M=async()=>{try{const e=await y.get("https://backend-hr1.axleshift.com/api/employees");o(e.data.data||e.data)}catch(e){console.error("Error fetching external employees:",e);try{const t=await E.get("/api/employee");o(t.data.data)}catch(t){console.error("Error fetching local employees:",t)}}},F=async()=>{try{const e=await y.get("https://backend-hr1.axleshift.com/api/newhires");j(e.data.data||e.data)}catch(e){console.error("Error fetching new hires:",e)}},I=e=>{const t=e.middleName?` ${e.middleName}`:"";return`${e.firstName}${t} ${e.lastName}`},k=e=>{switch(e){case"completed":return s.jsx(p,{color:"success",children:"Completed"});case"in progress":return s.jsx(p,{color:"warning",children:"In Progress"});case"pending":default:return s.jsx(p,{color:"secondary",children:"Pending"})}},D=e=>{B(e),C(e.status||"pending"),l(!0)},P=async()=>{if(c)try{await E.put(`/api/employee-training-status/${c.id}`,{status:d});const e=t=>t.map(h=>h.id===c.id?{...h,status:d}:h);o(t=>e(t)),j(t=>e(t)),l(!1)}catch(e){console.error("Error updating status:",e)}},f=[...S.map(e=>({...e,source:"regular"})),...b.map(e=>({...e,source:"new"}))].filter(e=>i==="new"?e.source==="new":i==="regular"?e.source==="regular":!0).filter(e=>[e.employeeId,e.firstName,e.middleName,e.lastName,e.position,e.department,e.email,e.dateHired].filter(Boolean).some(t=>t.toLowerCase().includes(g.toLowerCase())));return s.jsxs(s.Fragment,{children:[s.jsx(w,{children:s.jsx(m,{xs:12,children:s.jsxs(R,{className:"mb-4",children:[s.jsx(L,{className:"d-flex justify-content-between align-items-center",children:s.jsx("strong",{children:"Employee Management"})}),s.jsxs($,{children:[s.jsxs(w,{className:"mb-3",children:[s.jsx(m,{md:6,children:s.jsx(U,{placeholder:"Search by ID, name, position, department, etc...",value:g,onChange:e=>v(e.target.value)})}),s.jsx(m,{md:3,children:s.jsxs(N,{value:i,onChange:e=>T(e.target.value),children:[s.jsx("option",{value:"all",children:"All Employees"}),s.jsx("option",{value:"new",children:"New Hires Only"}),s.jsx("option",{value:"regular",children:"Regular Employees Only"})]})})]}),s.jsx("div",{style:{maxHeight:"500px",overflowY:"auto"},children:s.jsxs(A,{align:"middle",className:"mb-0 border",hover:!0,responsive:!0,children:[s.jsx(O,{children:s.jsxs(x,{children:[s.jsx(n,{children:"Employee ID"}),s.jsx(n,{children:"Name"}),s.jsx(n,{children:"Position"}),s.jsx(n,{children:"Department"}),s.jsx(n,{children:"Date Hired"}),s.jsx(n,{children:"Email"}),s.jsx(n,{className:"text-center",children:"Status"}),s.jsx(n,{className:"text-center",children:"Action"})]})}),s.jsx(z,{children:f.length>0?f.map(e=>s.jsxs(x,{children:[s.jsx(a,{children:e.employeeId}),s.jsx(a,{children:I(e)}),s.jsx(a,{children:e.position}),s.jsx(a,{children:e.department}),s.jsx(a,{children:e.dateHired}),s.jsx(a,{children:e.email}),s.jsx(a,{className:"text-center",children:k(e.status)}),s.jsx(a,{className:"text-center",children:s.jsx(u,{color:"primary",size:"sm",onClick:()=>D(e),children:"Edit Status"})})]},e.id)):s.jsx(x,{children:s.jsx(a,{colSpan:8,className:"text-center",children:"No employees found."})})})]})})]})]})})}),s.jsxs(Y,{visible:H,onClose:()=>l(!1),children:[s.jsx(q,{closeButton:!0,children:s.jsx(G,{children:"Edit Training Status"})}),s.jsx(J,{children:s.jsxs(N,{label:"Training Status",value:d,onChange:e=>C(e.target.value),children:[s.jsx("option",{value:"pending",children:"Pending"}),s.jsx("option",{value:"in progress",children:"In Progress"}),s.jsx("option",{value:"completed",children:"Completed"})]})}),s.jsxs(K,{children:[s.jsx(u,{color:"secondary",onClick:()=>l(!1),children:"Cancel"}),s.jsx(u,{color:"primary",onClick:P,children:"Save"})]})]})]})};export{le as default};
