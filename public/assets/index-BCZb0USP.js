import{r as l,_ as T,R as g,a as A,c as P,P as h,j as e,q as R}from"./index-Den53O81.js";import{C as D,a as I}from"./CRow-18d1DY9J.js";import{C as je,a as Ee}from"./CCardBody-_hjZAbeO.js";import{C as Ne}from"./CCardHeader-ClHQBOSg.js";import{a as N,c as w,d as O}from"./index.esm-D8Hv7iju.js";import{_ as ye,f as be,a as Ae,T as we,u as Se}from"./CCloseButton-DG4DzUyi.js";import{C as Te,a as Pe,b as ue,c as _,d as Me,e as H}from"./CTable-DfF7J49I.js";import{a as z,b as W,c as U,d as q,e as X}from"./DefaultLayout-CbDwQ2BM.js";import{C as G}from"./cil-user-Cuf7iOg1.js";import{C as J}from"./CFormTextarea-Cktr3_pD.js";var me=l.createContext({}),Z=l.forwardRef(function(r,t){var p=r.children,s=r.activeItemKey,c=r.alwaysOpen,d=c===void 0?!1:c,m=r.className,a=r.flush,i=T(r,["children","activeItemKey","alwaysOpen","className","flush"]),n=l.useState(s),f=n[0],v=n[1];return g.createElement("div",A({className:P("accordion",{"accordion-flush":a},m)},i,{ref:t}),g.createElement(me.Provider,{value:{_activeItemKey:f,alwaysOpen:d,setActiveKey:v}},p))});Z.propTypes={alwaysOpen:h.bool,activeItemKey:h.oneOfType([h.number,h.string]),children:h.node,className:h.string,flush:h.bool};Z.displayName="CAccordion";var ee=l.createContext({}),se=l.forwardRef(function(r,t){var p=r.children,s=r.className,c=r.id,d=r.itemKey,m=T(r,["children","className","id","itemKey"]),a=c??l.useId(),i=l.useRef(d??a),n=l.useContext(me),f=n._activeItemKey,v=n.alwaysOpen,C=n.setActiveKey,x=l.useState(f===i.current),E=x[0],y=x[1];return l.useEffect(function(){!v&&E&&C(i.current)},[E]),l.useEffect(function(){y(f===i.current)},[f]),g.createElement("div",A({className:P("accordion-item",s)},m,{ref:t}),g.createElement(ee.Provider,{value:{id:a,setVisible:y,visible:E}},p))});se.propTypes={children:h.node,className:h.string,itemKey:h.oneOfType([h.number,h.string])};se.displayName="CAccordionItem";function Y(){return Y=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var p=arguments[t];for(var s in p)({}).hasOwnProperty.call(p,s)&&(r[s]=p[s])}return r},Y.apply(null,arguments)}function Re(r,t){return r.classList?!!t&&r.classList.contains(t):(" "+(r.className.baseVal||r.className)+" ").indexOf(" "+t+" ")!==-1}function De(r,t){r.classList?r.classList.add(t):Re(r,t)||(typeof r.className=="string"?r.className=r.className+" "+t:r.setAttribute("class",(r.className&&r.className.baseVal||"")+" "+t))}function pe(r,t){return r.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function Ie(r,t){r.classList?r.classList.remove(t):typeof r.className=="string"?r.className=pe(r.className,t):r.setAttribute("class",pe(r.className&&r.className.baseVal||"",t))}var Ke=function(t,p){return t&&p&&p.split(" ").forEach(function(s){return De(t,s)})},Q=function(t,p){return t&&p&&p.split(" ").forEach(function(s){return Ie(t,s)})},re=function(r){ye(t,r);function t(){for(var s,c=arguments.length,d=new Array(c),m=0;m<c;m++)d[m]=arguments[m];return s=r.call.apply(r,[this].concat(d))||this,s.appliedClasses={appear:{},enter:{},exit:{}},s.onEnter=function(a,i){var n=s.resolveArguments(a,i),f=n[0],v=n[1];s.removeClasses(f,"exit"),s.addClass(f,v?"appear":"enter","base"),s.props.onEnter&&s.props.onEnter(a,i)},s.onEntering=function(a,i){var n=s.resolveArguments(a,i),f=n[0],v=n[1],C=v?"appear":"enter";s.addClass(f,C,"active"),s.props.onEntering&&s.props.onEntering(a,i)},s.onEntered=function(a,i){var n=s.resolveArguments(a,i),f=n[0],v=n[1],C=v?"appear":"enter";s.removeClasses(f,C),s.addClass(f,C,"done"),s.props.onEntered&&s.props.onEntered(a,i)},s.onExit=function(a){var i=s.resolveArguments(a),n=i[0];s.removeClasses(n,"appear"),s.removeClasses(n,"enter"),s.addClass(n,"exit","base"),s.props.onExit&&s.props.onExit(a)},s.onExiting=function(a){var i=s.resolveArguments(a),n=i[0];s.addClass(n,"exit","active"),s.props.onExiting&&s.props.onExiting(a)},s.onExited=function(a){var i=s.resolveArguments(a),n=i[0];s.removeClasses(n,"exit"),s.addClass(n,"exit","done"),s.props.onExited&&s.props.onExited(a)},s.resolveArguments=function(a,i){return s.props.nodeRef?[s.props.nodeRef.current,a]:[a,i]},s.getClassNames=function(a){var i=s.props.classNames,n=typeof i=="string",f=n&&i?i+"-":"",v=n?""+f+a:i[a],C=n?v+"-active":i[a+"Active"],x=n?v+"-done":i[a+"Done"];return{baseClassName:v,activeClassName:C,doneClassName:x}},s}var p=t.prototype;return p.addClass=function(c,d,m){var a=this.getClassNames(d)[m+"ClassName"],i=this.getClassNames("enter"),n=i.doneClassName;d==="appear"&&m==="done"&&n&&(a+=" "+n),m==="active"&&c&&be(c),a&&(this.appliedClasses[d][m]=a,Ke(c,a))},p.removeClasses=function(c,d){var m=this.appliedClasses[d],a=m.base,i=m.active,n=m.done;this.appliedClasses[d]={},a&&Q(c,a),i&&Q(c,i),n&&Q(c,n)},p.render=function(){var c=this.props;c.classNames;var d=Ae(c,["classNames"]);return g.createElement(we,Y({},d,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},t}(g.Component);re.defaultProps={classNames:""};re.propTypes={};var ae=l.forwardRef(function(r,t){var p=r.children,s=r.className,c=r.horizontal,d=r.onHide,m=r.onShow,a=r.visible,i=T(r,["children","className","horizontal","onHide","onShow","visible"]),n=l.useRef(null),f=Se(t,n),v=l.useState(),C=v[0],x=v[1],E=l.useState(),y=E[0],b=E[1],$=function(){if(m&&m(),c){n.current&&b(n.current.scrollWidth);return}n.current&&x(n.current.scrollHeight)},K=function(){if(c){b(0);return}x(0)},k=function(){if(c){n.current&&b(n.current.scrollWidth);return}n.current&&x(n.current.scrollHeight)},oe=function(){if(d&&d(),c){b(0);return}x(0)},le=function(){if(c){b(0);return}x(0)};return g.createElement(re,{in:a,nodeRef:n,onEntering:$,onEntered:K,onExit:k,onExiting:oe,onExited:le,timeout:350},function(M){var ce=C===0?null:{height:C},L=y===0?null:{width:y};return g.createElement("div",A({className:P(s,{"collapse-horizontal":c,collapsing:M==="entering"||M==="exiting","collapse show":M==="entered",collapse:M==="exited"}),style:A(A({},ce),L)},i,{ref:f}),p)})});ae.propTypes={children:h.node,className:h.string,horizontal:h.bool,onHide:h.func,onShow:h.func,visible:h.bool};ae.displayName="CCollapse";var ne=l.forwardRef(function(r,t){var p=r.children,s=r.className,c=T(r,["children","className"]),d=l.useContext(ee),m=d.id,a=d.visible;return g.createElement(ae,{className:"accordion-collapse",id:m,visible:a},g.createElement("div",A({className:P("accordion-body",s)},c,{ref:t}),p))});ne.propTypes={children:h.node,className:h.string};ne.displayName="CAccordionBody";var te=l.forwardRef(function(r,t){var p=r.children,s=r.className,c=T(r,["children","className"]),d=l.useContext(ee),m=d.id,a=d.visible,i=d.setVisible;return g.createElement("button",A({type:"button",className:P("accordion-button",{collapsed:!a},s),"aria-controls":m,"aria-expanded":a,onClick:function(){return i(!a)}},c,{ref:t}),p)});te.propTypes={children:h.node,className:h.string};te.displayName="CAccordionButton";var ie=l.forwardRef(function(r,t){var p=r.children,s=r.className,c=T(r,["children","className"]);return g.createElement("div",A({className:P("accordion-header",s)},c,{ref:t}),g.createElement(te,null,p))});ie.propTypes={children:h.node,className:h.string};ie.displayName="CAccordionHeader";const Ue=()=>{const[r,t]=l.useState(!1),[p,s]=l.useState(!1),[c,d]=l.useState([]),[m,a]=l.useState([]),[i,n]=l.useState([]),[f,v]=l.useState(null),[C,x]=l.useState(""),[E,y]=l.useState(""),[b,$]=l.useState(""),[K,k]=l.useState(""),[oe,le]=l.useState(""),[M,ce]=l.useState(""),[L,V]=l.useState(!1),[Oe,he]=l.useState(null),[S,B]=l.useState({title:"",description:"",file:null});l.useEffect(()=>{(async()=>{try{const u=await R.get("/api/programs");d(u.data.data)}catch(u){console.error("Error fetching programs:",u)}})()},[]),l.useEffect(()=>{(async()=>{try{const u=await R.get("/api/courses");a(u.data.data)}catch(u){console.error("Error fetching courses:",u)}})()},[]);const fe=async()=>{try{const u=(await R.post("/api/programs",{title:C,description:E})).data.data;d(j=>[...j,u]),x(""),y(""),t(!1)}catch(o){console.error("Error adding program:",o)}},ve=async()=>{try{const o=await R.post("/api/courses",{title:b,description:K,program_id:f});console.log("Course saved:",o.data),a([...m,o.data]),s(!1)}catch(o){console.error("Error saving course:",o)}},de=o=>{const{id:u,value:j}=o.target;B(F=>({...F,[u]:j}))},Ce=o=>{console.log(`Opening modal for course ID: ${o}`),he(o),setVisibleXL(!0)},xe=o=>{B(u=>({...u,file:o.target.files[0]}))},ge=async()=>{var u;const o=new FormData;o.append("title",S.title),o.append("description",S.description),o.append("course_id",selectedCourseId),S.file&&o.append("file",S.file);try{await R.post("/api/modules",o,{headers:{"Content-Type":"multipart/form-data"}}),B({title:"",description:"",file:null}),V(!1)}catch(j){console.error("Error uploading module:",((u=j.response)==null?void 0:u.data)||j.message)}};return e.jsxs(D,{children:[e.jsx(I,{xs:12,children:e.jsxs(je,{className:"mb-4",children:[e.jsxs(Ne,{children:[e.jsx("strong",{children:"List of Programs"}),e.jsx("div",{className:"d-grid gap-2 d-md-flex justify-content-md-end",children:e.jsx(N,{color:"primary",onClick:()=>t(!0),children:"Add Program"})})]}),e.jsx(Ee,{children:e.jsx(Z,{alwaysOpen:!0,children:c.map(o=>e.jsxs(se,{children:[e.jsx(ie,{onClick:()=>{v(o.id)},children:o.title}),e.jsxs(ne,{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Description:"})," ",o.description]}),e.jsx(N,{color:"primary",onClick:()=>{v(o.id),s(!0)},children:"Add Course"}),e.jsxs(Te,{striped:!0,className:"mt-3",children:[e.jsx(Pe,{children:e.jsxs(ue,{children:[e.jsx(_,{children:"Title"}),e.jsx(_,{children:"Description"}),e.jsx(_,{children:"Module"}),e.jsx(_,{children:"Actions"})]})}),e.jsx(Me,{children:m.filter(u=>u.program_id===o.id).map(u=>e.jsxs(ue,{children:[e.jsx(H,{children:u.title}),e.jsx(H,{children:u.description}),e.jsx(H,{children:u.modules&&u.modules.length>0?u.modules.map((j,F)=>e.jsx("div",{children:j.file_url?e.jsx("a",{href:j.file_url,target:"_blank",rel:"noopener noreferrer",children:j.file_name||"Download"}):e.jsx("span",{children:"No File"})},F)):e.jsx("span",{children:"—"})}),e.jsx(H,{children:e.jsx(N,{color:"primary",onClick:()=>Ce(u.id),children:u.modules&&u.modules.length>0?"Edit Module":"Add Module"})})]},u.id))})]})]})]},o.id))})})]})}),e.jsxs(z,{size:"xl",visible:r,onClose:()=>t(!1),children:[e.jsx(W,{children:e.jsx(U,{children:"Add Program"})}),e.jsx(q,{children:e.jsxs(G,{children:[e.jsx(D,{className:"mb-3",children:e.jsxs(I,{md:12,children:[e.jsx(w,{children:"Program Title"}),e.jsx(O,{value:C,onChange:o=>x(o.target.value)})]})}),e.jsx(D,{className:"mb-3",children:e.jsxs(I,{md:12,children:[e.jsx(w,{children:"Program Description"}),e.jsx(J,{value:E,onChange:o=>y(o.target.value)})]})})]})}),e.jsxs(X,{children:[e.jsx(N,{color:"secondary",onClick:()=>t(!1),children:"Close"}),e.jsx(N,{color:"primary",onClick:fe,children:"Save Program"})]})]}),e.jsxs(z,{size:"xl",visible:p,onClose:()=>s(!1),children:[e.jsx(W,{children:e.jsx(U,{children:"Add Course"})}),e.jsx(q,{children:e.jsxs(G,{children:[e.jsx(D,{className:"mb-3",children:e.jsxs(I,{md:12,children:[e.jsx(w,{children:"Course Title"}),e.jsx(O,{value:b,onChange:o=>$(o.target.value)})]})}),e.jsx(D,{className:"mb-3",children:e.jsxs(I,{md:12,children:[e.jsx(w,{children:"Course Description"}),e.jsx(J,{value:K,onChange:o=>k(o.target.value)})]})})]})}),e.jsxs(X,{children:[e.jsx(N,{color:"secondary",onClick:()=>s(!1),children:"Close"}),e.jsx(N,{color:"primary",onClick:ve,children:"Save Course"})]})]}),e.jsxs(z,{size:"xl",visible:L,onClose:()=>V(!1),children:[e.jsx(W,{children:e.jsx(U,{children:"Add Module"})}),e.jsx(q,{children:e.jsxs(G,{children:[e.jsx(w,{children:"Module Title"}),e.jsx(O,{id:"title",value:S.title,onChange:de}),e.jsx(w,{className:"mt-3",children:"Module Description"}),e.jsx(J,{id:"description",value:S.description,onChange:de}),e.jsx(w,{className:"mt-3",children:"Upload File"}),e.jsx(O,{type:"file",onChange:xe})]})}),e.jsxs(X,{children:[e.jsx(N,{color:"secondary",onClick:()=>V(!1),children:"Cancel"}),e.jsx(N,{color:"primary",onClick:ge,children:"Upload Module"})]})]})]})};export{Ue as default};
