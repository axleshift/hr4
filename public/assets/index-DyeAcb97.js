import{r as c,_ as I,R as j,a as w,c as O,P as m,j as e,q as _}from"./index-Jt5_3o27.js";import{C as y,a as A}from"./CRow-_OFy44p-.js";import{C as fe,a as ve}from"./CCardBody-BxYldHhN.js";import{C as Ce}from"./CCardHeader-DwICsY5j.js";import{a as b,c as M,d as D}from"./index.esm-BCjipPlm.js";import{_ as xe,f as ge,a as je,T as Ne,u as Ee}from"./CCloseButton-CgJcPBP2.js";import{C as be,a as ye,b as oe,c as H,d as Ae,e as $}from"./CTable-BA-pU3sJ.js";import{a as V,b as z,c as W,d as q,e as U}from"./DefaultLayout-UiYQod3e.js";import{C as G}from"./cil-user-C3Qj-5kT.js";import{C as J}from"./CFormTextarea-3k11SCdZ.js";var ce=c.createContext({}),Y=c.forwardRef(function(s,i){var p=s.children,r=s.activeItemKey,l=s.alwaysOpen,d=l===void 0?!1:l,h=s.className,a=s.flush,t=I(s,["children","activeItemKey","alwaysOpen","className","flush"]),n=c.useState(r),f=n[0],v=n[1];return j.createElement("div",w({className:O("accordion",{"accordion-flush":a},h)},t,{ref:i}),j.createElement(ce.Provider,{value:{_activeItemKey:f,alwaysOpen:d,setActiveKey:v}},p))});Y.propTypes={alwaysOpen:m.bool,activeItemKey:m.oneOfType([m.number,m.string]),children:m.node,className:m.string,flush:m.bool};Y.displayName="CAccordion";var Z=c.createContext({}),ee=c.forwardRef(function(s,i){var p=s.children,r=s.className,l=s.id,d=s.itemKey,h=I(s,["children","className","id","itemKey"]),a=l??c.useId(),t=c.useRef(d??a),n=c.useContext(ce),f=n._activeItemKey,v=n.alwaysOpen,C=n.setActiveKey,g=c.useState(f===t.current),N=g[0],E=g[1];return c.useEffect(function(){!v&&N&&C(t.current)},[N]),c.useEffect(function(){E(f===t.current)},[f]),j.createElement("div",w({className:O("accordion-item",r)},h,{ref:i}),j.createElement(Z.Provider,{value:{id:a,setVisible:E,visible:N}},p))});ee.propTypes={children:m.node,className:m.string,itemKey:m.oneOfType([m.number,m.string])};ee.displayName="CAccordionItem";function X(){return X=Object.assign?Object.assign.bind():function(s){for(var i=1;i<arguments.length;i++){var p=arguments[i];for(var r in p)({}).hasOwnProperty.call(p,r)&&(s[r]=p[r])}return s},X.apply(null,arguments)}function we(s,i){return s.classList?!!i&&s.classList.contains(i):(" "+(s.className.baseVal||s.className)+" ").indexOf(" "+i+" ")!==-1}function Se(s,i){s.classList?s.classList.add(i):we(s,i)||(typeof s.className=="string"?s.className=s.className+" "+i:s.setAttribute("class",(s.className&&s.className.baseVal||"")+" "+i))}function le(s,i){return s.replace(new RegExp("(^|\\s)"+i+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function Te(s,i){s.classList?s.classList.remove(i):typeof s.className=="string"?s.className=le(s.className,i):s.setAttribute("class",le(s.className&&s.className.baseVal||"",i))}var Me=function(i,p){return i&&p&&p.split(" ").forEach(function(r){return Se(i,r)})},Q=function(i,p){return i&&p&&p.split(" ").forEach(function(r){return Te(i,r)})},se=function(s){xe(i,s);function i(){for(var r,l=arguments.length,d=new Array(l),h=0;h<l;h++)d[h]=arguments[h];return r=s.call.apply(s,[this].concat(d))||this,r.appliedClasses={appear:{},enter:{},exit:{}},r.onEnter=function(a,t){var n=r.resolveArguments(a,t),f=n[0],v=n[1];r.removeClasses(f,"exit"),r.addClass(f,v?"appear":"enter","base"),r.props.onEnter&&r.props.onEnter(a,t)},r.onEntering=function(a,t){var n=r.resolveArguments(a,t),f=n[0],v=n[1],C=v?"appear":"enter";r.addClass(f,C,"active"),r.props.onEntering&&r.props.onEntering(a,t)},r.onEntered=function(a,t){var n=r.resolveArguments(a,t),f=n[0],v=n[1],C=v?"appear":"enter";r.removeClasses(f,C),r.addClass(f,C,"done"),r.props.onEntered&&r.props.onEntered(a,t)},r.onExit=function(a){var t=r.resolveArguments(a),n=t[0];r.removeClasses(n,"appear"),r.removeClasses(n,"enter"),r.addClass(n,"exit","base"),r.props.onExit&&r.props.onExit(a)},r.onExiting=function(a){var t=r.resolveArguments(a),n=t[0];r.addClass(n,"exit","active"),r.props.onExiting&&r.props.onExiting(a)},r.onExited=function(a){var t=r.resolveArguments(a),n=t[0];r.removeClasses(n,"exit"),r.addClass(n,"exit","done"),r.props.onExited&&r.props.onExited(a)},r.resolveArguments=function(a,t){return r.props.nodeRef?[r.props.nodeRef.current,a]:[a,t]},r.getClassNames=function(a){var t=r.props.classNames,n=typeof t=="string",f=n&&t?t+"-":"",v=n?""+f+a:t[a],C=n?v+"-active":t[a+"Active"],g=n?v+"-done":t[a+"Done"];return{baseClassName:v,activeClassName:C,doneClassName:g}},r}var p=i.prototype;return p.addClass=function(l,d,h){var a=this.getClassNames(d)[h+"ClassName"],t=this.getClassNames("enter"),n=t.doneClassName;d==="appear"&&h==="done"&&n&&(a+=" "+n),h==="active"&&l&&ge(l),a&&(this.appliedClasses[d][h]=a,Me(l,a))},p.removeClasses=function(l,d){var h=this.appliedClasses[d],a=h.base,t=h.active,n=h.done;this.appliedClasses[d]={},a&&Q(l,a),t&&Q(l,t),n&&Q(l,n)},p.render=function(){var l=this.props;l.classNames;var d=je(l,["classNames"]);return j.createElement(Ne,X({},d,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},i}(j.Component);se.defaultProps={classNames:""};se.propTypes={};var re=c.forwardRef(function(s,i){var p=s.children,r=s.className,l=s.horizontal,d=s.onHide,h=s.onShow,a=s.visible,t=I(s,["children","className","horizontal","onHide","onShow","visible"]),n=c.useRef(null),f=Ee(i,n),v=c.useState(),C=v[0],g=v[1],N=c.useState(),E=N[0],S=N[1],P=function(){if(h&&h(),l){n.current&&S(n.current.scrollWidth);return}n.current&&g(n.current.scrollHeight)},k=function(){if(l){S(0);return}g(0)},R=function(){if(l){n.current&&S(n.current.scrollWidth);return}n.current&&g(n.current.scrollHeight)},B=function(){if(d&&d(),l){S(0);return}g(0)},K=function(){if(l){S(0);return}g(0)};return j.createElement(se,{in:a,nodeRef:n,onEntering:P,onEntered:k,onExit:R,onExiting:B,onExited:K,timeout:350},function(T){var F=C===0?null:{height:C},L=E===0?null:{width:E};return j.createElement("div",w({className:O(r,{"collapse-horizontal":l,collapsing:T==="entering"||T==="exiting","collapse show":T==="entered",collapse:T==="exited"}),style:w(w({},F),L)},t,{ref:f}),p)})});re.propTypes={children:m.node,className:m.string,horizontal:m.bool,onHide:m.func,onShow:m.func,visible:m.bool};re.displayName="CCollapse";var ae=c.forwardRef(function(s,i){var p=s.children,r=s.className,l=I(s,["children","className"]),d=c.useContext(Z),h=d.id,a=d.visible;return j.createElement(re,{className:"accordion-collapse",id:h,visible:a},j.createElement("div",w({className:O("accordion-body",r)},l,{ref:i}),p))});ae.propTypes={children:m.node,className:m.string};ae.displayName="CAccordionBody";var ne=c.forwardRef(function(s,i){var p=s.children,r=s.className,l=I(s,["children","className"]),d=c.useContext(Z),h=d.id,a=d.visible,t=d.setVisible;return j.createElement("button",w({type:"button",className:O("accordion-button",{collapsed:!a},r),"aria-controls":h,"aria-expanded":a,onClick:function(){return t(!a)}},l,{ref:i}),p)});ne.propTypes={children:m.node,className:m.string};ne.displayName="CAccordionButton";var ie=c.forwardRef(function(s,i){var p=s.children,r=s.className,l=I(s,["children","className"]);return j.createElement("div",w({className:O("accordion-header",r)},l,{ref:i}),j.createElement(ne,null,p))});ie.propTypes={children:m.node,className:m.string};ie.displayName="CAccordionHeader";const Be=()=>{const[s,i]=c.useState([]),[p,r]=c.useState([]),[l,d]=c.useState(""),[h,a]=c.useState(""),[t,n]=c.useState(""),[f,v]=c.useState(""),[C,g]=c.useState({title:"",description:"",file:null}),[N,E]=c.useState(null),[S,P]=c.useState(!1),[k,R]=c.useState(!1),[B,K]=c.useState(!1),[T,F]=c.useState([]);c.useEffect(()=>{(async()=>{try{const u=await _.get("/api/programs");i(u.data.data)}catch(u){console.error("Error fetching programs:",u)}})()},[]),c.useEffect(()=>{(async()=>{try{const u=await _.get("/api/courses");r(u.data.data)}catch(u){console.error("Error fetching courses:",u)}})()},[]),c.useEffect(()=>{(async()=>{try{const u=await _.get("/api/modules");F(u.data.data)}catch(u){console.error("Error fetching modules:",u)}})()},[]);const L=async()=>{try{const o=await _.post("/api/programs",{title:l,description:h});i(u=>[...u,o.data.data]),d(""),a(""),P(!1)}catch(o){console.error("Error adding program:",o)}},de=async()=>{try{const o=await _.post("/api/courses",{title:t,description:f,program_id:N});r([...p,o.data]),R(!1)}catch(o){console.error("Error saving course:",o)}},te=o=>{const{id:u,value:x}=o.target;g(me=>({...me,[u]:x}))},ue=o=>{g(u=>({...u,file:o.target.files[0]}))},pe=async()=>{var u;const o=new FormData;o.append("title",C.title),o.append("description",C.description),o.append("course_id",N),C.file&&o.append("file",C.file);try{await _.post("/api/modules",o,{headers:{"Content-Type":"multipart/form-data"}}),g({title:"",description:"",file:null}),K(!1)}catch(x){console.error("Error uploading module:",((u=x.response)==null?void 0:u.data)||x.message)}},he=o=>{E(o),K(!0)};return e.jsxs(y,{children:[e.jsx(A,{xs:12,children:e.jsxs(fe,{className:"mb-4",children:[e.jsxs(Ce,{children:[e.jsx("strong",{children:"List of Programs"}),e.jsx("div",{className:"d-grid gap-2 d-md-flex justify-content-md-end",children:e.jsx(b,{color:"primary",onClick:()=>P(!0),children:"Add Program"})})]}),e.jsx(ve,{children:e.jsx(Y,{alwaysOpen:!0,children:s.map(o=>e.jsxs(ee,{children:[e.jsx(ie,{onClick:()=>{E(o.id)},children:o.title}),e.jsxs(ae,{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Description:"})," ",o.description]}),e.jsx(b,{color:"primary",onClick:()=>{E(o.id),R(!0)},children:"Add Course"}),e.jsxs(be,{striped:!0,className:"mt-3",children:[e.jsx(ye,{children:e.jsxs(oe,{children:[e.jsx(H,{children:"Course Title"}),e.jsx(H,{children:"Description"}),e.jsx(H,{children:"Modules"}),e.jsx(H,{children:"Actions"})]})}),e.jsx(Ae,{children:p.filter(u=>u.program_id===o.id).map(u=>e.jsxs(oe,{children:[e.jsx($,{children:u.title}),e.jsx($,{children:u.description}),e.jsx($,{children:e.jsxs("ul",{className:"mb-0",children:[T.filter(x=>x.course_id===u.id).map(x=>e.jsxs("li",{children:[e.jsx("strong",{children:x.title})," ","- ",x.description," ",x.file_url&&e.jsxs(e.Fragment,{children:["[",e.jsx("a",{href:x.file_url,target:"_blank",rel:"noopener noreferrer",children:x.file_name||"Download"}),"]"]})]},x.id)),T.filter(x=>x.course_id===u.id).length===0&&e.jsx("li",{children:"No modules available"})]})}),e.jsx($,{children:e.jsx(b,{color:"success",size:"sm",onClick:()=>he(u.id),children:"Add Module"})})]},u.id))})]})]})]},o.id))})})]})}),e.jsxs(V,{size:"xl",visible:S,onClose:()=>P(!1),children:[e.jsx(z,{children:e.jsx(W,{children:"Add Program"})}),e.jsx(q,{children:e.jsxs(G,{children:[e.jsx(y,{className:"mb-3",children:e.jsxs(A,{md:12,children:[e.jsx(M,{children:"Program Title"}),e.jsx(D,{value:l,onChange:o=>d(o.target.value)})]})}),e.jsx(y,{className:"mb-3",children:e.jsxs(A,{md:12,children:[e.jsx(M,{children:"Program Description"}),e.jsx(J,{value:h,onChange:o=>a(o.target.value)})]})})]})}),e.jsxs(U,{children:[e.jsx(b,{color:"secondary",onClick:()=>P(!1),children:"Close"}),e.jsx(b,{color:"primary",onClick:L,children:"Save Program"})]})]}),e.jsxs(V,{size:"xl",visible:k,onClose:()=>R(!1),children:[e.jsx(z,{children:e.jsx(W,{children:"Add Course"})}),e.jsx(q,{children:e.jsxs(G,{children:[e.jsx(y,{className:"mb-3",children:e.jsxs(A,{md:12,children:[e.jsx(M,{children:"Course Title"}),e.jsx(D,{value:t,onChange:o=>n(o.target.value)})]})}),e.jsx(y,{className:"mb-3",children:e.jsxs(A,{md:12,children:[e.jsx(M,{children:"Course Description"}),e.jsx(J,{value:f,onChange:o=>v(o.target.value)})]})})]})}),e.jsxs(U,{children:[e.jsx(b,{color:"secondary",onClick:()=>R(!1),children:"Close"}),e.jsx(b,{color:"primary",onClick:de,disabled:!t||!f,children:"Save Course"})]})]}),e.jsxs(V,{size:"xl",visible:B,onClose:()=>K(!1),children:[e.jsx(z,{children:e.jsx(W,{children:"Add Module"})}),e.jsx(q,{children:e.jsxs(G,{children:[e.jsx(y,{className:"mb-3",children:e.jsxs(A,{md:12,children:[e.jsx(M,{children:"Module Title"}),e.jsx(D,{id:"title",value:C.title,onChange:te})]})}),e.jsx(y,{className:"mb-3",children:e.jsxs(A,{md:12,children:[e.jsx(M,{children:"Module Description"}),e.jsx(J,{id:"description",value:C.description,onChange:te})]})}),e.jsx(y,{className:"mb-3",children:e.jsxs(A,{md:12,children:[e.jsx(M,{children:"Upload File"}),e.jsx(D,{type:"file",onChange:ue})]})})]})}),e.jsxs(U,{children:[e.jsx(b,{color:"secondary",onClick:()=>K(!1),children:"Close"}),e.jsx(b,{color:"primary",onClick:pe,children:"Save Module"})]})]})]})};export{Be as default};
