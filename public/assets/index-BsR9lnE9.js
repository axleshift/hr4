import{r,q as f,j as e}from"./index-C10Ndz3v.js";import{C as S,a as E}from"./CRow-8TF5T-xd.js";import{C as B,a as F}from"./CCardBody-DH12tY5Q.js";import{C as N}from"./CCardHeader-Bbzc4c9T.js";import{C as P,a as H,b as j,c as t,d as L,e as l}from"./CTable-BK0o9P73.js";import{a as C}from"./index.esm-CzM0CwIj.js";import{a as _,b as $,d as R,e as V}from"./DefaultLayout-DIWLtGyY.js";import"./CCloseButton-DeWglTfY.js";import"./cil-user-DL92sTA7.js";const J=()=>{const[u,b]=r.useState([]),[d,v]=r.useState(""),[c,w]=r.useState(""),[y,g]=r.useState(""),[M,i]=r.useState(!1),[n,h]=r.useState(!1),[m,o]=r.useState(null);r.useEffect(()=>{D()},[]);const D=async()=>{try{const s=await f.get("/api/modules");b(s.data.data)}catch(s){console.error("Error fetching modules:",s),o("Failed to load modules.")}},T=async s=>{h(!0),o(null);try{const a=await f.get(`/api/modules/${s}/preview`);v(a.data.base64),w(a.data.mime_type),g(a.data.file_name),i(!0)}catch(a){console.error("Error fetching document preview:",a),o("Failed to load document preview.")}finally{h(!1)}};return e.jsxs(S,{children:[e.jsx(E,{xs:12,children:e.jsxs(B,{className:"mb-4",children:[e.jsx(N,{children:e.jsx("strong",{children:"MODULES"})}),e.jsxs(F,{children:[m&&e.jsx("div",{className:"alert alert-danger",children:m}),e.jsxs(P,{striped:!0,hover:!0,children:[e.jsx(H,{children:e.jsxs(j,{children:[e.jsx(t,{children:"#"}),e.jsx(t,{children:"Title"}),e.jsx(t,{children:"Description"}),e.jsx(t,{children:"Actions"})]})}),e.jsx(L,{children:u.map((s,a)=>{var p,x;return e.jsxs(j,{children:[e.jsx(t,{children:a+1}),e.jsx(l,{children:s.title}),e.jsx(l,{children:s.description}),e.jsx(l,{children:(((p=s.file_name)==null?void 0:p.endsWith(".docx"))||((x=s.file_name)==null?void 0:x.endsWith(".pdf")))&&e.jsx(C,{color:"info",onClick:()=>T(s.id),disabled:n,children:n?"Loading...":"View"})})]},a)})})]})]})]})}),e.jsxs(_,{visible:M,onClose:()=>i(!1),size:"xl",fullscreen:!0,children:[e.jsx($,{children:"Document Preview"}),e.jsx(R,{style:{padding:0},children:d?c==="application/pdf"?e.jsx("iframe",{src:`data:${c};base64,${d}`,style:{width:"100%",height:"90vh",border:"none"},title:"PDF Preview"}):e.jsx("iframe",{src:`https://view.officeapps.live.com/op/embed.aspx?src=https://hr4.axleshift.com/uploads/${y}`,style:{width:"100%",height:"90vh",border:"none"},title:"Office Document Preview"}):e.jsx("p",{children:"No preview available."})}),e.jsx(V,{children:e.jsx(C,{color:"secondary",onClick:()=>i(!1),children:"Close"})})]})]})};export{J as default};
