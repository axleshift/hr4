import{r,x as w,i as m,j as s}from"./index-O3FIm1KD.js";import{C as N,a as p}from"./CRow-BgUZgY-0.js";import{C as $,a as L}from"./CCardBody-B8rB6gPW.js";import{C as U}from"./CCardHeader-BoiBcjuO.js";import{d as A,a as u}from"./index.esm-dwFQoV7S.js";import{C as v}from"./CFormSelect-efNqcd4X.js";import{C as O,a as z,b as x,c as l,d as Y,e as a}from"./CTable-BPP-pkRz.js";import{a as q,b as G,c as J,d as K,e as Q,f as j}from"./DefaultLayout-BL4kRkFI.js";import"./CCloseButton-BRetwled.js";import"./cil-user-suTBkcCi.js";const oe=()=>{const[S,o]=r.useState([]),[b,g]=r.useState([]),[C,T]=r.useState(""),[i,H]=r.useState("all"),[B,n]=r.useState(!1),[c,M]=r.useState(null),[d,f]=r.useState("pending");r.useEffect(()=>{F(),I()},[]);const y=async e=>{try{await m.post("/api/employees/save-external",{employees:e}),console.log("Employees saved to local database.")}catch(t){console.error("Error saving employees to local database:",t)}},F=async()=>{try{const e=await w.get("https://backend-hr1.axleshift.com/api/employees"),t=e.data.data||e.data;o(t),y(t)}catch(e){console.error("Error fetching external employees:",e);try{const t=await m.get("/api/employee");o(t.data.data)}catch(t){console.error("Error fetching local employees:",t)}}},I=async()=>{try{const e=await w.get("https://backend-hr1.axleshift.com/api/newhires"),t=e.data.data||e.data;g(t),y(t)}catch(e){console.error("Error fetching new hires:",e)}},D=e=>{const t=e.middleName?` ${e.middleName}`:"";return`${e.firstName}${t} ${e.lastName}`},k=e=>{switch(e){case"completed":return s.jsx(j,{color:"success",children:"Completed"});case"in progress":return s.jsx(j,{color:"warning",children:"In Progress"});case"pending":default:return s.jsx(j,{color:"secondary",children:"Pending"})}},P=e=>{M(e),f(e.status||"pending"),n(!0)},R=async()=>{if(c)try{await m.put(`/api/employee-training-status/${c.id}`,{status:d});const e=t=>t.map(h=>h.id===c.id?{...h,status:d}:h);o(t=>e(t)),g(t=>e(t)),n(!1)}catch(e){console.error("Error updating status:",e)}},E=[...S.map(e=>({...e,source:"regular"})),...b.map(e=>({...e,source:"new"}))].filter(e=>i==="new"?e.source==="new":i==="regular"?e.source==="regular":!0).filter(e=>[e.employeeId,e.firstName,e.middleName,e.lastName,e.position,e.department,e.email,e.dateHired].filter(Boolean).some(t=>t.toLowerCase().includes(C.toLowerCase())));return s.jsxs(s.Fragment,{children:[s.jsx(N,{children:s.jsx(p,{xs:12,children:s.jsxs($,{className:"mb-4",children:[s.jsx(U,{className:"d-flex justify-content-between align-items-center",children:s.jsx("strong",{children:"Employee Management"})}),s.jsxs(L,{children:[s.jsxs(N,{className:"mb-3",children:[s.jsx(p,{md:6,children:s.jsx(A,{placeholder:"Search by ID, name, position, department, etc...",value:C,onChange:e=>T(e.target.value)})}),s.jsx(p,{md:3,children:s.jsxs(v,{value:i,onChange:e=>H(e.target.value),children:[s.jsx("option",{value:"all",children:"All Employees"}),s.jsx("option",{value:"new",children:"New Hires Only"}),s.jsx("option",{value:"regular",children:"Regular Employees Only"})]})})]}),s.jsx("div",{style:{maxHeight:"500px",overflowY:"auto"},children:s.jsxs(O,{align:"middle",className:"mb-0 border",hover:!0,responsive:!0,children:[s.jsx(z,{children:s.jsxs(x,{children:[s.jsx(l,{children:"Employee ID"}),s.jsx(l,{children:"Name"}),s.jsx(l,{children:"Position"}),s.jsx(l,{children:"Department"}),s.jsx(l,{children:"Date Hired"}),s.jsx(l,{children:"Email"}),s.jsx(l,{className:"text-center",children:"Status"}),s.jsx(l,{className:"text-center",children:"Action"})]})}),s.jsx(Y,{children:E.length>0?E.map(e=>s.jsxs(x,{children:[s.jsx(a,{children:e.employeeId}),s.jsx(a,{children:D(e)}),s.jsx(a,{children:e.position}),s.jsx(a,{children:e.department}),s.jsx(a,{children:e.dateHired}),s.jsx(a,{children:e.email}),s.jsx(a,{className:"text-center",children:k(e.status)}),s.jsx(a,{className:"text-center",children:s.jsx(u,{color:"primary",size:"sm",onClick:()=>P(e),children:"Edit Status"})})]},e.id)):s.jsx(x,{children:s.jsx(a,{colSpan:8,className:"text-center",children:"No employees found."})})})]})})]})]})})}),s.jsxs(q,{visible:B,onClose:()=>n(!1),children:[s.jsx(G,{closeButton:!0,children:s.jsx(J,{children:"Edit Training Status"})}),s.jsx(K,{children:s.jsxs(v,{label:"Training Status",value:d,onChange:e=>f(e.target.value),children:[s.jsx("option",{value:"pending",children:"Pending"}),s.jsx("option",{value:"in progress",children:"In Progress"}),s.jsx("option",{value:"completed",children:"Completed"})]})}),s.jsxs(Q,{children:[s.jsx(u,{color:"secondary",onClick:()=>n(!1),children:"Cancel"}),s.jsx(u,{color:"primary",onClick:R,children:"Save"})]})]})]})};export{oe as default};
