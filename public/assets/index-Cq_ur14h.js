import{r as d,q as m,j as e}from"./index-CQ4bySkn.js";import{C as T,a as w}from"./CRow-De_OBzUP.js";import{C as D,a as N}from"./CCardBody-Cab34X6S.js";import{C as E}from"./CCardHeader-Ce9a0BEG.js";import{a as c,c as x,d as g}from"./index.esm-Cg0z4teA.js";import{a as S,b as k,c as L,d as B,e as H}from"./DefaultLayout-C7J1tsKe.js";import{C as _}from"./cil-user-DFSBgfuH.js";import{C as I}from"./CFormTextarea-GGmSGmlB.js";import{C as R,a as q,b as j,c as t,d as z,e as o}from"./CTable-lv4KTbQj.js";import"./CCloseButton-DTieXLLc.js";const Q=()=>{const[C,n]=d.useState(!1),[f,h]=d.useState([]),[i,p]=d.useState({title:"",description:"",file:null});d.useEffect(()=>{b()},[]);const b=async()=>{try{const s=await m.get("/api/modules");h(s.data.data)}catch(s){console.error("Error fetching modules:",s)}},y=async s=>{var l;s.preventDefault();const r=new FormData;r.append("title",i.title),r.append("description",i.description),i.file&&r.append("file",i.file);try{const a=await m.post("/api/modules",r,{headers:{"Content-Type":"multipart/form-data"}});h(v=>[...v,a.data.data]),n(!1),p({title:"",description:"",file:null})}catch(a){console.error("Error adding module:",((l=a.response)==null?void 0:l.data)||a.message)}},u=s=>{const{id:r,value:l}=s.target;p(a=>({...a,[r]:l}))},M=s=>{p(r=>({...r,file:s.target.files[0]}))},F=async s=>{var r;try{await m.delete(`/api/modules/${s}`),h(l=>l.filter(a=>a.id!==s))}catch(l){console.error("Error deleting module:",((r=l.response)==null?void 0:r.data)||l.message)}};return e.jsx(T,{children:e.jsx(w,{xs:12,children:e.jsxs(D,{className:"mb-4",children:[e.jsxs(E,{children:[e.jsx("strong",{children:"MODULES"}),e.jsxs("div",{className:"d-grid gap-2 d-md-flex justify-content-md-end",children:[e.jsx(c,{color:"primary",onClick:()=>n(!C),children:"Create Module"}),e.jsxs(S,{alignment:"center",backdrop:"static",size:"lg",visible:C,onClose:()=>n(!1),children:[e.jsx(k,{children:e.jsx(L,{children:"Create Module"})}),e.jsx(B,{children:e.jsxs(_,{children:[e.jsxs("div",{className:"mb-3",children:[e.jsx(x,{htmlFor:"file",children:"Upload File"}),e.jsx(g,{type:"file",id:"file",onChange:M})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(x,{htmlFor:"title",children:"Module Title"}),e.jsx(g,{required:!0,type:"text",id:"title",value:i.title,onChange:u,placeholder:"Input title"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(x,{htmlFor:"description",children:"Description"}),e.jsx(I,{id:"description",rows:3,value:i.description,onChange:u})]})]})}),e.jsxs(H,{children:[e.jsx(c,{color:"secondary",onClick:()=>n(!1),children:"Cancel"}),e.jsx(c,{color:"primary",onClick:y,children:"Add Module"})]})]})]})]}),e.jsx(N,{children:e.jsxs(R,{striped:!0,hover:!0,children:[e.jsx(q,{children:e.jsxs(j,{children:[e.jsx(t,{children:"#"}),e.jsx(t,{children:"Title"}),e.jsx(t,{children:"Description"}),e.jsx(t,{children:"File"}),e.jsx(t,{children:"Actions"})]})}),e.jsx(z,{children:f.length>0?f.map((s,r)=>e.jsxs(j,{children:[e.jsx(t,{children:r+1}),e.jsx(o,{children:s.title}),e.jsx(o,{children:s.description}),e.jsx(o,{children:s.file_url?e.jsx("a",{href:s.file_url,target:"_blank",rel:"noopener noreferrer",children:s.file_name||"Download"}):e.jsx("span",{children:"No File"})}),e.jsx(o,{children:e.jsx(c,{color:"danger",size:"sm",onClick:()=>F(s.id),children:"Delete"})})]},s.id)):e.jsx(j,{children:e.jsx(o,{colSpan:5,className:"text-center",children:"No modules available."})})})]})})]})})})};export{Q as default};
