import{r as d,_ as q,R as j,a as R,c as D,P as o,j as e,q as $}from"./index-C0DRlCh6.js";import{a as B,b as L,c as V,d as z,e as M}from"./DefaultLayout-D9UjuTQ-.js";import{C as ie}from"./cil-user-DfXhKCXZ.js";import{C as P,a as S}from"./CRow-DJOEgblX.js";import{c as _,d as W,a as w}from"./index.esm-B91ILO0J.js";import{C as ae}from"./CFormTextarea-Big9Wg4B.js";import{C as de,a as ue}from"./CCardBody-CQ1Sh3sk.js";import{C as pe}from"./CCardHeader-B7W4DTpq.js";import{_ as me,f as he,a as fe,T as ve,u as Ce}from"./CCloseButton-H5Ubqsmq.js";import{C as ge,a as xe,b as ne,c as H,d as je,e as I}from"./CTable-BlOVtVpl.js";var oe=d.createContext({}),J=d.forwardRef(function(r,n){var p=r.children,s=r.activeItemKey,l=r.alwaysOpen,c=l===void 0?!1:l,u=r.className,i=r.flush,t=q(r,["children","activeItemKey","alwaysOpen","className","flush"]),a=d.useState(s),h=a[0],f=a[1];return j.createElement("div",R({className:D("accordion",{"accordion-flush":i},u)},t,{ref:n}),j.createElement(oe.Provider,{value:{_activeItemKey:h,alwaysOpen:c,setActiveKey:f}},p))});J.propTypes={alwaysOpen:o.bool,activeItemKey:o.oneOfType([o.number,o.string]),children:o.node,className:o.string,flush:o.bool};J.displayName="CAccordion";var Q=d.createContext({}),X=d.forwardRef(function(r,n){var p=r.children,s=r.className,l=r.id,c=r.itemKey,u=q(r,["children","className","id","itemKey"]),i=l??d.useId(),t=d.useRef(c??i),a=d.useContext(oe),h=a._activeItemKey,f=a.alwaysOpen,C=a.setActiveKey,g=d.useState(h===t.current),N=g[0],y=g[1];return d.useEffect(function(){!f&&N&&C(t.current)},[N]),d.useEffect(function(){y(h===t.current)},[h]),j.createElement("div",R({className:D("accordion-item",s)},u,{ref:n}),j.createElement(Q.Provider,{value:{id:i,setVisible:y,visible:N}},p))});X.propTypes={children:o.node,className:o.string,itemKey:o.oneOfType([o.number,o.string])};X.displayName="CAccordionItem";function G(){return G=Object.assign?Object.assign.bind():function(r){for(var n=1;n<arguments.length;n++){var p=arguments[n];for(var s in p)({}).hasOwnProperty.call(p,s)&&(r[s]=p[s])}return r},G.apply(null,arguments)}function Ne(r,n){return r.classList?!!n&&r.classList.contains(n):(" "+(r.className.baseVal||r.className)+" ").indexOf(" "+n+" ")!==-1}function be(r,n){r.classList?r.classList.add(n):Ne(r,n)||(typeof r.className=="string"?r.className=r.className+" "+n:r.setAttribute("class",(r.className&&r.className.baseVal||"")+" "+n))}function te(r,n){return r.replace(new RegExp("(^|\\s)"+n+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function ye(r,n){r.classList?r.classList.remove(n):typeof r.className=="string"?r.className=te(r.className,n):r.setAttribute("class",te(r.className&&r.className.baseVal||"",n))}var Ee=function(n,p){return n&&p&&p.split(" ").forEach(function(s){return be(n,s)})},U=function(n,p){return n&&p&&p.split(" ").forEach(function(s){return ye(n,s)})},Y=function(r){me(n,r);function n(){for(var s,l=arguments.length,c=new Array(l),u=0;u<l;u++)c[u]=arguments[u];return s=r.call.apply(r,[this].concat(c))||this,s.appliedClasses={appear:{},enter:{},exit:{}},s.onEnter=function(i,t){var a=s.resolveArguments(i,t),h=a[0],f=a[1];s.removeClasses(h,"exit"),s.addClass(h,f?"appear":"enter","base"),s.props.onEnter&&s.props.onEnter(i,t)},s.onEntering=function(i,t){var a=s.resolveArguments(i,t),h=a[0],f=a[1],C=f?"appear":"enter";s.addClass(h,C,"active"),s.props.onEntering&&s.props.onEntering(i,t)},s.onEntered=function(i,t){var a=s.resolveArguments(i,t),h=a[0],f=a[1],C=f?"appear":"enter";s.removeClasses(h,C),s.addClass(h,C,"done"),s.props.onEntered&&s.props.onEntered(i,t)},s.onExit=function(i){var t=s.resolveArguments(i),a=t[0];s.removeClasses(a,"appear"),s.removeClasses(a,"enter"),s.addClass(a,"exit","base"),s.props.onExit&&s.props.onExit(i)},s.onExiting=function(i){var t=s.resolveArguments(i),a=t[0];s.addClass(a,"exit","active"),s.props.onExiting&&s.props.onExiting(i)},s.onExited=function(i){var t=s.resolveArguments(i),a=t[0];s.removeClasses(a,"exit"),s.addClass(a,"exit","done"),s.props.onExited&&s.props.onExited(i)},s.resolveArguments=function(i,t){return s.props.nodeRef?[s.props.nodeRef.current,i]:[i,t]},s.getClassNames=function(i){var t=s.props.classNames,a=typeof t=="string",h=a&&t?t+"-":"",f=a?""+h+i:t[i],C=a?f+"-active":t[i+"Active"],g=a?f+"-done":t[i+"Done"];return{baseClassName:f,activeClassName:C,doneClassName:g}},s}var p=n.prototype;return p.addClass=function(l,c,u){var i=this.getClassNames(c)[u+"ClassName"],t=this.getClassNames("enter"),a=t.doneClassName;c==="appear"&&u==="done"&&a&&(i+=" "+a),u==="active"&&l&&he(l),i&&(this.appliedClasses[c][u]=i,Ee(l,i))},p.removeClasses=function(l,c){var u=this.appliedClasses[c],i=u.base,t=u.active,a=u.done;this.appliedClasses[c]={},i&&U(l,i),t&&U(l,t),a&&U(l,a)},p.render=function(){var l=this.props;l.classNames;var c=fe(l,["classNames"]);return j.createElement(ve,G({},c,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},n}(j.Component);Y.defaultProps={classNames:""};Y.propTypes={};var Z=d.forwardRef(function(r,n){var p=r.children,s=r.className,l=r.horizontal,c=r.onHide,u=r.onShow,i=r.visible,t=q(r,["children","className","horizontal","onHide","onShow","visible"]),a=d.useRef(null),h=Ce(n,a),f=d.useState(),C=f[0],g=f[1],N=d.useState(),y=N[0],b=N[1],E=function(){if(u&&u(),l){a.current&&b(a.current.scrollWidth);return}a.current&&g(a.current.scrollHeight)},F=function(){if(l){b(0);return}g(0)},T=function(){if(l){a.current&&b(a.current.scrollWidth);return}a.current&&g(a.current.scrollHeight)},x=function(){if(c&&c(),l){b(0);return}g(0)},O=function(){if(l){b(0);return}g(0)};return j.createElement(Y,{in:i,nodeRef:a,onEntering:E,onEntered:F,onExit:T,onExiting:x,onExited:O,timeout:350},function(A){var k=C===0?null:{height:C},v=y===0?null:{width:y};return j.createElement("div",R({className:D(s,{"collapse-horizontal":l,collapsing:A==="entering"||A==="exiting","collapse show":A==="entered",collapse:A==="exited"}),style:R(R({},k),v)},t,{ref:h}),p)})});Z.propTypes={children:o.node,className:o.string,horizontal:o.bool,onHide:o.func,onShow:o.func,visible:o.bool};Z.displayName="CCollapse";var ee=d.forwardRef(function(r,n){var p=r.children,s=r.className,l=q(r,["children","className"]),c=d.useContext(Q),u=c.id,i=c.visible;return j.createElement(Z,{className:"accordion-collapse",id:u,visible:i},j.createElement("div",R({className:D("accordion-body",s)},l,{ref:n}),p))});ee.propTypes={children:o.node,className:o.string};ee.displayName="CAccordionBody";var se=d.forwardRef(function(r,n){var p=r.children,s=r.className,l=q(r,["children","className"]),c=d.useContext(Q),u=c.id,i=c.visible,t=c.setVisible;return j.createElement("button",R({type:"button",className:D("accordion-button",{collapsed:!i},s),"aria-controls":u,"aria-expanded":i,onClick:function(){return t(!i)}},l,{ref:n}),p)});se.propTypes={children:o.node,className:o.string};se.displayName="CAccordionButton";var re=d.forwardRef(function(r,n){var p=r.children,s=r.className,l=q(r,["children","className"]);return j.createElement("div",R({className:D("accordion-header",s)},l,{ref:n}),j.createElement(se,null,p))});re.propTypes={children:o.node,className:o.string};re.displayName="CAccordionHeader";const le=({visibleProgram:r,setVisibleProgram:n,programTitle:p,setProgramTitle:s,programDescription:l,setProgramDescription:c,handleSaveProgram:u,visibleCourse:i,setVisibleCourse:t,courseTitle:a,setCourseTitle:h,courseDescription:f,setCourseDescription:C,setCourseFile:g,handleSaveCourse:N,modalVisible:y,setModalVisible:b,base64Doc:E,mimeType:F,fileName:T})=>e.jsxs(e.Fragment,{children:[e.jsxs(B,{size:"lg",visible:r,onClose:()=>n(!1),children:[e.jsx(L,{children:e.jsx(V,{children:"Add Program"})}),e.jsx(z,{children:e.jsxs(ie,{children:[e.jsx(P,{className:"mb-3",children:e.jsxs(S,{md:12,children:[e.jsx(_,{children:"Program Title"}),e.jsx(W,{value:p,onChange:x=>s(x.target.value)})]})}),e.jsx(P,{className:"mb-3",children:e.jsxs(S,{md:12,children:[e.jsx(_,{children:"Program Description"}),e.jsx(ae,{value:l,onChange:x=>c(x.target.value)})]})})]})}),e.jsxs(M,{children:[e.jsx(w,{color:"secondary",onClick:()=>n(!1),children:"Close"}),e.jsx(w,{color:"primary",onClick:u,children:"Save Program"})]})]}),e.jsxs(B,{size:"lg",visible:i,onClose:()=>t(!1),children:[e.jsx(L,{children:e.jsx(V,{children:"Add Course"})}),e.jsx(z,{children:e.jsxs(ie,{children:[e.jsx(P,{className:"mb-3",children:e.jsxs(S,{md:12,children:[e.jsx(_,{children:"Course Title"}),e.jsx(W,{value:a,onChange:x=>h(x.target.value)})]})}),e.jsx(P,{className:"mb-3",children:e.jsxs(S,{md:12,children:[e.jsx(_,{children:"Course Description"}),e.jsx(ae,{value:f,onChange:x=>C(x.target.value)})]})}),e.jsx(P,{className:"mb-3",children:e.jsxs(S,{md:12,children:[e.jsx(_,{children:"Upload File"}),e.jsx(W,{type:"file",onChange:x=>g(x.target.files[0])})]})})]})}),e.jsxs(M,{children:[e.jsx(w,{color:"secondary",onClick:()=>t(!1),children:"Close"}),e.jsx(w,{color:"primary",onClick:N,children:"Save Course"})]})]}),e.jsxs(B,{visible:y,onClose:()=>b(!1),size:"xl",fullscreen:!0,children:[e.jsx(L,{children:e.jsx(V,{children:"Document Preview"})}),e.jsx(z,{style:{padding:0},children:E?F==="application/pdf"?e.jsx("iframe",{src:`${E}`,style:{width:"100%",height:"90vh",border:"none"}}):e.jsx("iframe",{src:`https://view.officeapps.live.com/op/embed.aspx?src=${E}`,style:{width:"100%",height:"90vh",border:"none"}}):e.jsx("p",{children:"No preview available."})}),e.jsx(M,{children:e.jsx(w,{color:"secondary",onClick:()=>b(!1),children:"Close"})})]})]});le.propTypes={visibleProgram:o.bool.isRequired,setVisibleProgram:o.func.isRequired,programTitle:o.string.isRequired,setProgramTitle:o.func.isRequired,programDescription:o.string.isRequired,setProgramDescription:o.func.isRequired,handleSaveProgram:o.func.isRequired,visibleCourse:o.bool.isRequired,setVisibleCourse:o.func.isRequired,courseTitle:o.string.isRequired,setCourseTitle:o.func.isRequired,courseDescription:o.string.isRequired,setCourseDescription:o.func.isRequired,setCourseFile:o.func.isRequired,handleSaveCourse:o.func.isRequired,modalVisible:o.bool.isRequired,setModalVisible:o.func.isRequired,base64Doc:o.string.isRequired,mimeType:o.string.isRequired,fileName:o.string.isRequired};const $e=()=>{const[r,n]=d.useState([]),[p,s]=d.useState([]),[l,c]=d.useState(""),[u,i]=d.useState(""),[t,a]=d.useState(""),[h,f]=d.useState(""),[C,g]=d.useState(null),[N,y]=d.useState(null),[b,E]=d.useState(!1),[F,T]=d.useState(!1);d.useEffect(()=>{(async()=>{try{const m=await $.get("/api/programs");n(m.data.data)}catch(m){console.error("Error fetching programs:",m)}})()},[]);const x=async v=>{try{const m=await $.get(`/api/courses?program_id=${v}`);s(m.data.data)}catch(m){console.error("Error fetching courses:",m)}},O=async()=>{if(!l||!u){alert("Please provide both title and description for the program.");return}try{const v=await $.post("/api/programs",{title:l,description:u});n(m=>[...m,v.data.data]),c(""),i(""),E(!1)}catch(v){console.error("Error adding program:",v),alert("Failed to add program.")}},A=async v=>{if(v.preventDefault(),!t||!h){alert("Please provide both title and description for the course.");return}const m=new FormData;m.append("title",t),m.append("description",h),m.append("program_id",N),C&&m.append("file",C);try{const K=await $.post("/api/courses",m,{headers:{"Content-Type":"multipart/form-data"}});s(ce=>[...ce,K.data]),T(!1),a(""),f(""),g(null)}catch(K){console.error("Error saving course:",K),alert("Failed to save course.")}},k=async v=>{try{await $.delete(`/api/courses/${v}`),s(m=>m.filter(K=>K.id!==v))}catch(m){console.error("Error deleting course:",m),alert("Failed to delete course.")}};return e.jsxs(P,{children:[e.jsx(S,{xs:12,children:e.jsxs(de,{className:"mb-4",children:[e.jsxs(pe,{children:[e.jsx("strong",{children:"List of Programs"}),e.jsx("div",{className:"d-grid gap-2 d-md-flex justify-content-md-end",children:e.jsx(w,{color:"primary",onClick:()=>E(!0),children:"Add Program"})})]}),e.jsx(ue,{children:e.jsx(J,{alwaysOpen:!0,children:r.map(v=>e.jsxs(X,{children:[e.jsx(re,{onClick:()=>{x(v.id)},children:v.title}),e.jsxs(ee,{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Description:"})," ",v.description]}),e.jsx(w,{color:"primary",onClick:()=>{y(v.id),T(!0)},children:"Add Course"}),e.jsxs(ge,{striped:!0,className:"mt-3",children:[e.jsx(xe,{children:e.jsxs(ne,{children:[e.jsx(H,{children:"Course Title"}),e.jsx(H,{children:"Description"}),e.jsx(H,{children:"File"}),e.jsx(H,{children:"Actions"})]})}),e.jsx(je,{children:p.filter(m=>m.program_id===v.id).map(m=>e.jsxs(ne,{children:[e.jsx(I,{children:m.title}),e.jsx(I,{children:m.description}),e.jsx(I,{children:m.file_path?e.jsx("a",{href:m.file_path,target:"_blank",rel:"noopener noreferrer",children:m.file_name||"Download"}):e.jsx("span",{children:"No File"})}),e.jsx(I,{children:e.jsx(w,{color:"danger",onClick:()=>k(m.id),children:"Delete"})})]},m.id))})]})]})]},v.id))})})]})}),e.jsx(le,{visibleProgram:b,setVisibleProgram:E,programTitle:l,setProgramTitle:c,programDescription:u,setProgramDescription:i,handleSaveProgram:O,visibleCourse:F,setVisibleCourse:T,courseTitle:t,setCourseTitle:a,courseDescription:h,setCourseDescription:f,setCourseFile:g,handleSaveCourse:A})]})};export{$e as default};
