import{r as d,j as e,o as g,P as t}from"./index-EK1oDtQo.js";import{c as i,a as j,d as v}from"./index.esm-DTqtlBIJ.js";import{a as D,b as T,c as U,d as w}from"./DefaultLayout-ilyUugqX.js";import{C as M}from"./CModalTitle-lzs7gW7I.js";import{C as P}from"./CForm-D3Iuq08t.js";import{C as o}from"./CFormInput-B199oAcv.js";import{C as N}from"./CFormSelect-CwQxpBIU.js";import{C as A,a as H}from"./CRow-C-nD_8v1.js";import{C as k,a as B}from"./CCardBody-CXXmE4BX.js";import{C as O}from"./CCardHeader-DRPIgnI1.js";import{c as z}from"./cil-user-plus-9sfVD_63.js";import{C as I,a as V,b as F,c as h,d as $,e as p}from"./CTable-Ni6uqvI1.js";import{c as G}from"./cil-options-sHCm5Gxk.js";import"./CCloseButton-B0J24H2U.js";import"./cil-user-Ddrdy7PS.js";const E=({modalVisible:f,setModalVisible:m,user:n,fetchUsers:C,roles:_,departments:x})=>{const[a,u]=d.useState({name:"",email:"",role:"",department:"",employee_type:"",employment_status:"",date_of_hire:"",gender:"",phone_number:"",address:""}),[r,c]=d.useState({});d.useEffect(()=>{n&&u({name:n.name||"",email:n.email||"",role:n.role_id||"",department:n.department?n.department.id:"",employee_type:n.employee_type||"",employment_status:n.employment_status||"",date_of_hire:n.date_of_hire||"",gender:n.gender||"",phone_number:n.phone_number||"",address:n.address||""})},[n]);const l=s=>{const{name:y,value:S}=s.target;u(q=>({...q,[y]:S}))},R=()=>{const s={};return a.name||(s.name="Name is required"),a.email||(s.email="Email is required"),a.role||(s.role="Role is required"),a.department||(s.department="Department is required"),a.date_of_hire||(s.date_of_hire="Date of hire is required"),c(s),Object.keys(s).length===0},b=async s=>{if(s.preventDefault(),!!R())try{await g.put(`/api/users/${n.id}`,a),C(),m(!1)}catch(y){console.error("Error updating user profile:",y)}};return e.jsxs(D,{visible:f,onClose:()=>m(!1),size:"lg",children:[e.jsx(T,{children:e.jsx(M,{children:"Edit Profile"})}),e.jsx(U,{children:e.jsxs(P,{onSubmit:b,children:[e.jsx(i,{htmlFor:"name",children:"Full Name"}),e.jsx(o,{id:"name",name:"name",value:a.name,onChange:l,invalid:!!r.name}),r.name&&e.jsx("div",{className:"text-danger",children:r.name}),e.jsx(i,{htmlFor:"email",children:"Email"}),e.jsx(o,{id:"email",name:"email",value:a.email,readOnly:!0,invalid:!!r.email}),r.email&&e.jsx("div",{className:"text-danger",children:r.email}),e.jsx(i,{htmlFor:"role",children:"Role"}),e.jsxs(N,{id:"role",name:"role",value:a.role,onChange:l,invalid:!!r.role,children:[e.jsx("option",{value:"",children:"Select Role"}),_.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),r.role&&e.jsx("div",{className:"text-danger",children:r.role}),e.jsx(i,{htmlFor:"department",children:"Department"}),e.jsxs(N,{id:"department",name:"department",value:a.department,onChange:l,invalid:!!r.department,children:[e.jsx("option",{value:"",children:"Select Department"}),x.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),r.department&&e.jsx("div",{className:"text-danger",children:r.department}),e.jsx(i,{htmlFor:"employee_type",children:"Employee Type"}),e.jsx(o,{id:"employee_type",name:"employee_type",value:a.employee_type,onChange:l}),e.jsx(i,{htmlFor:"employment_status",children:"Employment Status"}),e.jsx(o,{id:"employment_status",name:"employment_status",value:a.employment_status,onChange:l}),e.jsx(i,{htmlFor:"date_of_hire",children:"Date of Hire"}),e.jsx(o,{id:"date_of_hire",name:"date_of_hire",type:"date",value:a.date_of_hire,onChange:l,invalid:!!r.date_of_hire}),r.date_of_hire&&e.jsx("div",{className:"text-danger",children:r.date_of_hire}),e.jsx(i,{htmlFor:"gender",children:"Gender"}),e.jsx(o,{id:"gender",name:"gender",value:a.gender,onChange:l}),e.jsx(i,{htmlFor:"phone_number",children:"Phone Number"}),e.jsx(o,{id:"phone_number",name:"phone_number",value:a.phone_number,onChange:l}),e.jsx(i,{htmlFor:"address",children:"Address"}),e.jsx(o,{id:"address",name:"address",value:a.address,onChange:l})]})}),e.jsxs(w,{children:[e.jsx(j,{color:"secondary",onClick:()=>m(!1),children:"Close"}),e.jsx(j,{color:"primary",onClick:b,children:"Save Changes"})]})]})};E.propTypes={modalVisible:t.bool.isRequired,setModalVisible:t.func.isRequired,user:t.shape({id:t.number.isRequired,name:t.string,email:t.string,role_id:t.number,department:t.shape({id:t.number,name:t.string}),employee_type:t.string,employment_status:t.string,date_of_hire:t.string,gender:t.string,phone_number:t.string,address:t.string}).isRequired,fetchUsers:t.func.isRequired,roles:t.array.isRequired,departments:t.array.isRequired};const le=()=>{const[f,m]=d.useState([]),[n,C]=d.useState(null),[_,x]=d.useState(!1);d.useEffect(()=>{a()},[]);const a=async()=>{try{const r=await g.get("/api/users");m(r.data.data)}catch(r){console.error("Error fetching users:",r)}},u=async r=>{try{const c=await g.get(`/api/users/${r}`);C(c.data.data),x(!0)}catch(c){console.error("Error fetching user profile:",c)}};return e.jsxs(A,{children:[e.jsx(H,{xs:12,children:e.jsxs(k,{className:"mb-4",children:[e.jsxs(O,{className:"d-flex justify-content-between align-items-center",children:[e.jsx("strong",{children:"Access Control"}),e.jsxs(j,{color:"primary",children:[e.jsx(v,{icon:z,className:"me-2"}),"Add User"]})]}),e.jsx(B,{children:e.jsxs(I,{align:"middle",className:"mb-0 border",hover:!0,responsive:!0,children:[e.jsx(V,{children:e.jsxs(F,{children:[e.jsx(h,{children:"Name"}),e.jsx(h,{children:"Email"}),e.jsx(h,{className:"text-center",children:"Role"}),e.jsx(h,{className:"text-center",children:"Department"}),e.jsx(h,{className:"text-center",children:"Actions"})]})}),e.jsx($,{children:f.map(r=>e.jsxs(F,{children:[e.jsx(p,{children:r.name}),e.jsx(p,{children:r.email}),e.jsx(p,{className:"text-center",children:r.role}),e.jsx(p,{className:"text-center",children:r.department}),e.jsx(p,{className:"text-center",children:e.jsxs(j,{color:"secondary",size:"sm",onClick:()=>u(r.id),children:[e.jsx(v,{icon:G,className:"me-1"}),"More"]})})]},r.id))})]})})]})}),n&&e.jsx(E,{modalVisible:_,setModalVisible:x,user:n,fetchUsers:a})]})};export{le as default};
