import{r as a,_ as T,R as j,a as I,c as P,P as o,b as G,h as q,j as e,C as F,q as A,v as B}from"./index-Dn52yOU_.js";import{b as O,e as N,d as w,a as g}from"./index.esm-BiWVw-fo.js";import{C as S,a as k}from"./CRow-6tka5Iz9.js";import{C as _}from"./CCardGroup-DiIVYc9x.js";import{C as $,a as z}from"./CCardBody-BmFUKM8Q.js";import{C as D,c as H}from"./cil-user-BaYaCxCz.js";import{u as J,T as U,C as V}from"./CCloseButton-BoZ0NFmC.js";import{C as E,a as L}from"./CInputGroupText-DC4KhTv2.js";import{c as K}from"./cil-lock-locked-DmxpJbVL.js";var y=a.forwardRef(function(s,C){var p=s.children,b=s.className,n=s.color,l=n===void 0?"primary":n,t=s.dismissible,h=s.variant,f=s.visible,c=f===void 0?!0:f,d=s.onClose,r=T(s,["children","className","color","dismissible","variant","visible","onClose"]),m=a.useRef(null),x=J(C,m),i=a.useState(c),v=i[0],u=i[1];return a.useEffect(function(){u(c)},[c]),j.createElement(U,{in:v,mountOnEnter:!0,nodeRef:m,onExit:d,timeout:150,unmountOnExit:!0},function(R){return j.createElement("div",I({className:P("alert",h==="solid"?"bg-".concat(l," text-white"):"alert-".concat(l),{"alert-dismissible fade":t,show:R==="entered"},b),role:"alert"},r,{ref:x}),p,t&&j.createElement(V,{onClick:function(){return u(!1)}}))})});y.propTypes={children:o.node,className:o.string,color:G.isRequired,dismissible:o.bool,onClose:o.func,variant:o.string,visible:o.bool};y.displayName="CAlert";const te=()=>{const[s,C]=a.useState(""),[p,b]=a.useState(""),[n,l]=a.useState(!1),[t,h]=a.useState({visible:!1,type:"",message:""}),f=q(),c=async r=>{var m,x;r.preventDefault(),l(!0);try{const i=await A.post("/api/auth/login",{email:s,password:p}),{user:v,token:u}=i.data;B.set("token",u,{expires:30,secure:!0,sameSite:"Strict"}),sessionStorage.setItem("token",u),sessionStorage.setItem("user",JSON.stringify(v)),f("/dashboard")}catch(i){h({visible:!0,type:"danger",message:((x=(m=i.response)==null?void 0:m.data)==null?void 0:x.message)||"Login failed. Please try again."})}finally{l(!1)}},d=r=>{window.location.href=`https://hr4.axleshift.com/auth/${r}`};return a.useEffect(()=>{if(t.visible){const r=setTimeout(()=>h({...t,visible:!1}),3e3);return()=>clearTimeout(r)}},[t]),e.jsx("div",{className:"bg-body-tertiary min-vh-100 d-flex flex-row align-items-center",children:e.jsx(O,{children:e.jsx(S,{className:"justify-content-center",children:e.jsx(k,{md:8,children:e.jsx(_,{children:e.jsx($,{className:"p-4",children:e.jsxs(z,{children:[e.jsxs(D,{onSubmit:c,children:[e.jsx("h1",{children:"Login"}),e.jsx("p",{className:"text-body-secondary",children:"Sign in to your account"}),t.visible&&e.jsx(y,{color:t.type,children:t.message}),e.jsxs(E,{className:"mb-3",children:[e.jsx(L,{children:e.jsx(N,{icon:H})}),e.jsx(w,{type:"email",placeholder:"Email",value:s,onChange:r=>C(r.target.value),required:!0})]}),e.jsxs(E,{className:"mb-3",children:[e.jsx(L,{children:e.jsx(N,{icon:K})}),e.jsx(w,{type:"password",placeholder:"Password",value:p,onChange:r=>b(r.target.value),required:!0})]}),e.jsx(S,{children:e.jsx(k,{xs:6,children:e.jsx(g,{type:"submit",color:"primary",disabled:n,children:n?e.jsx(F,{size:"sm"}):"Login"})})})]}),e.jsxs("div",{className:"mt-3 text-center",children:[e.jsx(g,{color:"danger",onClick:()=>d("google"),children:"Login with Google"}),e.jsx(g,{color:"primary",onClick:()=>d("facebook"),className:"mx-2",children:"Login with Facebook"}),e.jsx(g,{color:"secondary",onClick:()=>d("github"),children:"Login with GitHub"})]})]})})})})})})})};export{te as default};
