import{r as m,j as e,h as j,P as n}from"./index-Cmku9UxJ.js";import{c as d,a as y,d as E}from"./index.esm-97JVtHl3.js";import{a as q,b as T,c as w,d as U}from"./DefaultLayout-BCu5N7tl.js";import{C as M}from"./CModalTitle-rLi_CHKC.js";import{C as P}from"./CForm-BC5dFFMM.js";import{C as c}from"./CFormInput-CUSAQ_S9.js";import{C as F}from"./CFormSelect-BkWyTqhZ.js";import{C as A,a as H}from"./CRow-BU1uL-rp.js";import{C as k,a as B}from"./CCardBody-BrgGGhXg.js";import{C as O}from"./CCardHeader-D5P3VmmB.js";import{c as z}from"./cil-user-plus-9sfVD_63.js";import{C as I,a as V,b as R,c as x,d as $,e as u}from"./CTable-DD5jpDTz.js";import{c as G}from"./cil-options-sHCm5Gxk.js";import"./CCloseButton-D2buDaAI.js";import"./cil-user-Ddrdy7PS.js";const S=({modalVisible:g,setModalVisible:p,user:s,fetchUsers:b,roles:h,departments:v})=>{const[t,f]=m.useState({name:"",email:"",role:"",department:"",employee_type:"",employment_status:"",date_of_hire:"",gender:"",phone_number:"",address:""}),[o,C]=m.useState({});m.useEffect(()=>{s&&f({name:s.name||"",email:s.email||"",role:s.role_id||"",department:s.department?s.department.id:"",employee_type:s.employee_type||"",employment_status:s.employment_status||"",date_of_hire:s.date_of_hire||"",gender:s.gender||"",phone_number:s.phone_number||"",address:s.address||""})},[s]);const l=a=>{const{name:r,value:i}=a.target;f(D=>({...D,[r]:i}))},N=()=>{const a={};return t.name||(a.name="Name is required"),t.email||(a.email="Email is required"),t.role||(a.role="Role is required"),t.department||(a.department="Department is required"),t.date_of_hire||(a.date_of_hire="Date of hire is required"),C(a),Object.keys(a).length===0},_=async a=>{if(a.preventDefault(),!!N())try{await j.put(`/api/users/${s.id}`,t),b(),p(!1)}catch(r){console.error("Error updating user profile:",r)}};return e.jsxs(q,{visible:g,onClose:()=>p(!1),size:"lg",children:[e.jsx(T,{children:e.jsx(M,{children:"Edit Profile"})}),e.jsx(w,{children:e.jsxs(P,{onSubmit:_,children:[e.jsx(d,{htmlFor:"name",children:"Full Name"}),e.jsx(c,{id:"name",name:"name",value:t.name,onChange:l,invalid:!!o.name}),o.name&&e.jsx("div",{className:"text-danger",children:o.name}),e.jsx(d,{htmlFor:"email",children:"Email"}),e.jsx(c,{id:"email",name:"email",value:t.email,readOnly:!0,invalid:!!o.email}),o.email&&e.jsx("div",{className:"text-danger",children:o.email}),e.jsx(d,{htmlFor:"role",children:"Role"}),e.jsxs(F,{id:"role",name:"role",value:t.role,onChange:l,invalid:!!o.role,children:[e.jsx("option",{value:"",children:"Select Role"}),h.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]}),o.role&&e.jsx("div",{className:"text-danger",children:o.role}),e.jsx(d,{htmlFor:"department",children:"Department"}),e.jsxs(F,{id:"department",name:"department",value:t.department,onChange:l,invalid:!!o.department,children:[e.jsx("option",{value:"",children:"Select Department"}),v.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]}),o.department&&e.jsx("div",{className:"text-danger",children:o.department}),e.jsx(d,{htmlFor:"employee_type",children:"Employee Type"}),e.jsx(c,{id:"employee_type",name:"employee_type",value:t.employee_type,onChange:l}),e.jsx(d,{htmlFor:"employment_status",children:"Employment Status"}),e.jsx(c,{id:"employment_status",name:"employment_status",value:t.employment_status,onChange:l}),e.jsx(d,{htmlFor:"date_of_hire",children:"Date of Hire"}),e.jsx(c,{id:"date_of_hire",name:"date_of_hire",type:"date",value:t.date_of_hire,onChange:l,invalid:!!o.date_of_hire}),o.date_of_hire&&e.jsx("div",{className:"text-danger",children:o.date_of_hire}),e.jsx(d,{htmlFor:"gender",children:"Gender"}),e.jsx(c,{id:"gender",name:"gender",value:t.gender,onChange:l}),e.jsx(d,{htmlFor:"phone_number",children:"Phone Number"}),e.jsx(c,{id:"phone_number",name:"phone_number",value:t.phone_number,onChange:l}),e.jsx(d,{htmlFor:"address",children:"Address"}),e.jsx(c,{id:"address",name:"address",value:t.address,onChange:l})]})}),e.jsxs(U,{children:[e.jsx(y,{color:"secondary",onClick:()=>p(!1),children:"Close"}),e.jsx(y,{color:"primary",onClick:_,children:"Save Changes"})]})]})};S.propTypes={modalVisible:n.bool.isRequired,setModalVisible:n.func.isRequired,user:n.shape({id:n.number.isRequired,name:n.string,email:n.string,role_id:n.number,department:n.shape({id:n.number,name:n.string}),employee_type:n.string,employment_status:n.string,date_of_hire:n.string,gender:n.string,phone_number:n.string,address:n.string}).isRequired,fetchUsers:n.func.isRequired,roles:n.array.isRequired,departments:n.array.isRequired};const ie=()=>{const[g,p]=m.useState([]),[s,b]=m.useState([]),[h,v]=m.useState([]),[t,f]=m.useState(null),[o,C]=m.useState(!1);m.useEffect(()=>{N(),_()},[]),m.useEffect(()=>{s.length>0&&h.length>0&&l()},[s,h]);const l=async()=>{try{const r=await j.get("/api/users");p(r.data.data)}catch(r){console.error("Error fetching users:",r)}},N=async()=>{try{const r=await j.get("/api/roles");b(r.data)}catch(r){console.error("Error fetching roles:",r)}},_=async()=>{try{const r=await j.get("/api/departments");v(r.data)}catch(r){console.error("Error fetching departments:",r)}},a=async r=>{try{const i=await j.get(`/api/users/${r}`);f(i.data.data),C(!0)}catch(i){console.error("Error fetching user profile:",i)}};return e.jsxs(A,{children:[e.jsx(H,{xs:12,children:e.jsxs(k,{className:"mb-4",children:[e.jsxs(O,{className:"d-flex justify-content-between align-items-center",children:[e.jsx("strong",{children:"Access Control"}),e.jsxs(y,{color:"primary",children:[e.jsx(E,{icon:z,className:"me-2"}),"Add User"]})]}),e.jsx(B,{children:e.jsxs(I,{align:"middle",className:"mb-0 border",hover:!0,responsive:!0,children:[e.jsx(V,{children:e.jsxs(R,{children:[e.jsx(x,{children:"Name"}),e.jsx(x,{children:"Email"}),e.jsx(x,{className:"text-center",children:"Role"}),e.jsx(x,{className:"text-center",children:"Department"}),e.jsx(x,{className:"text-center",children:"Actions"})]})}),e.jsx($,{children:g.map(r=>e.jsxs(R,{children:[e.jsx(u,{children:r.name}),e.jsx(u,{children:r.email}),e.jsx(u,{className:"text-center",children:s.filter(i=>i.id===r.role_id).map(i=>i.name).join(", ")||"No Role"}),e.jsx(u,{className:"text-center",children:h.filter(i=>i.id===r.department_id).map(i=>i.name).join(", ")||"No Department"}),e.jsx(u,{className:"text-center",children:e.jsxs(y,{color:"secondary",size:"sm",onClick:()=>a(r.id),children:[e.jsx(E,{icon:G,className:"me-1"}),"More"]})})]},r.id))})]})})]})}),t&&e.jsx(S,{modalVisible:o,setModalVisible:C,user:t,fetchUsers:l,roles:s,departments:h})]})};export{ie as default};
