import{a as m,k as E,j as e,L as U}from"./index-D0ykVIBh.js";import{b as B,c as y,a as f}from"./index.esm-CEZIJNA6.js";import{a as w}from"./index-t--hEgTQ.js";import{C as S,a as g}from"./CRow-C7kEkgmS.js";import{C as F}from"./CCardGroup-CfH_an5G.js";import{C as N,a as I}from"./CCardBody-Bvtd8o25.js";import{C as D}from"./CForm-Vi-ufwid.js";import{C as k,a as L}from"./CInputGroupText-BWZEON4G.js";import{c as O}from"./cil-user-Ddrdy7PS.js";import{C as b}from"./CFormInput-BEWTXsMD.js";import{c as A}from"./cil-lock-locked-DmxpJbVL.js";/*! js-cookie v3.0.5 | MIT */function u(t){for(var c=1;c<arguments.length;c++){var l=arguments[c];for(var d in l)t[d]=l[d]}return t}var G={read:function(t){return t[0]==='"'&&(t=t.slice(1,-1)),t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(t){return encodeURIComponent(t).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function C(t,c){function l(s,a,r){if(!(typeof document>"u")){r=u({},c,r),typeof r.expires=="number"&&(r.expires=new Date(Date.now()+r.expires*864e5)),r.expires&&(r.expires=r.expires.toUTCString()),s=encodeURIComponent(s).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var n="";for(var o in r)r[o]&&(n+="; "+o,r[o]!==!0&&(n+="="+r[o].split(";")[0]));return document.cookie=s+"="+t.write(a,s)+n}}function d(s){if(!(typeof document>"u"||arguments.length&&!s)){for(var a=document.cookie?document.cookie.split("; "):[],r={},n=0;n<a.length;n++){var o=a[n].split("="),h=o.slice(1).join("=");try{var i=decodeURIComponent(o[0]);if(r[i]=t.read(h,i),s===i)break}catch{}}return s?r[s]:r}}return Object.create({set:l,get:d,remove:function(s,a){l(s,"",u({},a,{expires:-1}))},withAttributes:function(s){return C(this.converter,u({},this.attributes,s))},withConverter:function(s){return C(u({},this.converter,s),this.attributes)}},{attributes:{value:Object.freeze(c)},converter:{value:Object.freeze(t)}})}var q=C(G,{path:"/"});const X=()=>{const[t,c]=m.useState(""),[l,d]=m.useState(""),[s,a]=m.useState(""),[r,n]=m.useState(!1),o=E();m.useEffect(()=>{(async()=>{try{(await w.post("http://localhost:8000/api/auth/verify-session",{},{withCredentials:!0})).data.user&&o("/dashboard")}catch{console.log("Session invalid or expired")}})()},[o]);const h=async i=>{var p,j;i.preventDefault(),a(""),n(!0);try{const x=await w.post("http://localhost:8000/api/auth/login",{email:t,password:l},{withCredentials:!0}),{user:v,session_id:R}=x.data;q.set("session_id",R,{expires:1,secure:!0,sameSite:"Strict"}),localStorage.setItem("user",JSON.stringify(v)),v.role==="admin"?o("/ui/LearningManagement/index"):o("/dashboard")}catch(x){n(!1),a(((j=(p=x.response)==null?void 0:p.data)==null?void 0:j.message)||"Login failed!")}};return e.jsx("div",{className:"bg-body-tertiary min-vh-100 d-flex flex-row align-items-center",children:e.jsx(B,{children:e.jsx(S,{className:"justify-content-center",children:e.jsx(g,{md:8,children:e.jsxs(F,{children:[e.jsx(N,{className:"p-4",children:e.jsx(I,{children:e.jsxs(D,{onSubmit:h,children:[e.jsx("h1",{children:"Login"}),e.jsx("p",{className:"text-body-secondary",children:"Sign in to your account"}),s&&e.jsx("div",{className:"text-danger",children:s}),e.jsxs(k,{className:"mb-3",children:[e.jsx(L,{children:e.jsx(y,{icon:O})}),e.jsx(b,{placeholder:"Email",autoComplete:"email",value:t,onChange:i=>c(i.target.value),required:!0})]}),e.jsxs(k,{className:"mb-4",children:[e.jsx(L,{children:e.jsx(y,{icon:A})}),e.jsx(b,{type:"password",placeholder:"Password",autoComplete:"current-password",value:l,onChange:i=>d(i.target.value),required:!0})]}),e.jsxs(S,{children:[e.jsx(g,{xs:6,children:e.jsx(f,{color:"primary",className:"px-4",type:"submit",disabled:r,children:r?"Logging in...":"Login"})}),e.jsx(g,{xs:6,className:"text-right",children:e.jsx(f,{color:"link",className:"px-0",children:"Forgot password?"})})]})]})})}),e.jsx(N,{className:"text-white bg-primary py-5",style:{width:"44%"},children:e.jsx(I,{className:"text-center",children:e.jsxs("div",{children:[e.jsx("h2",{children:"Sign up"}),e.jsx("p",{children:"Create an account to get started"}),e.jsx(U,{to:"/register",children:e.jsx(f,{color:"primary",className:"mt-3",active:!0,tabIndex:-1,children:"Register Now!"})})]})})})]})})})})})};export{X as default};
