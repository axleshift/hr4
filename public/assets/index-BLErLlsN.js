import{r as i,j as e,h as f,P as a}from"./index-DyqsgZoH.js";import{c as l,a as y,d as N}from"./index.esm-Cc7b-c-j.js";import{a as w,b as A,c as U,d as q}from"./DefaultLayout-B8Tsm8H-.js";import{C as M}from"./CModalTitle-m3WA56ID.js";import{C as P}from"./CForm-B2ZUt_ya.js";import{C as d}from"./CFormInput-DkyGp8r7.js";import{C as R}from"./CFormSelect-8MAr8Tnh.js";import{C as H,a as B}from"./CRow-CPpxyK3y.js";import{C as k,a as z}from"./CCardBody-D3KRRCun.js";import{C as I}from"./CCardHeader-pd8gzpe4.js";import{c as O}from"./cil-user-plus-9sfVD_63.js";import{C as V,a as $,b as S,c as u,d as G,e as j}from"./CTable-lkwJmANZ.js";import{c as L}from"./cil-options-sHCm5Gxk.js";import"./CCloseButton-jUxD4eQX.js";import"./cil-user-Ddrdy7PS.js";const D=({modalVisible:g,setModalVisible:c,user:r,fetchUsers:_,roles:h,departments:b})=>{const[t,C]=i.useState({name:"",email:"",role:"",department:"",employee_type:"",employment_status:"",date_of_hire:"",gender:"",phone_number:"",address:""});i.useEffect(()=>{r&&C({name:r.name||"",email:r.email||"",role:r.role_id||"",department:r.department?r.department.id:"",employee_type:r.employee_type||"",employment_status:r.employment_status||"",date_of_hire:r.date_of_hire||"",gender:r.gender||"",phone_number:r.phone_number||"",address:r.address||""})},[r]);const o=n=>{const{name:x,value:v}=n.target;C(E=>({...E,[x]:v}))},p=async n=>{n.preventDefault();try{await f.put(`/api/users/${r.id}`,t),_(),c(!1)}catch(x){console.error("Error updating user profile:",x)}};return e.jsxs(w,{visible:g,onClose:()=>c(!1),size:"lg",children:[e.jsx(A,{children:e.jsx(M,{children:"Edit Profile"})}),e.jsx(U,{children:e.jsxs(P,{onSubmit:p,children:[e.jsx(l,{htmlFor:"name",children:"Full Name"}),e.jsx(d,{id:"name",name:"name",value:t.name,onChange:o}),e.jsx(l,{htmlFor:"email",children:"Email"}),e.jsx(d,{id:"email",name:"email",value:t.email,readOnly:!0}),e.jsx(l,{htmlFor:"role",children:"Role"}),e.jsxs(R,{id:"role",name:"role",value:t.role,onChange:o,children:[e.jsx("option",{value:"",children:"Select Role"}),h.map(n=>e.jsx("option",{value:n.id,children:n.name},n.id))]}),e.jsx(l,{htmlFor:"department",children:"Department"}),e.jsxs(R,{id:"department",name:"department",value:t.department,onChange:o,children:[e.jsx("option",{value:"",children:"Select Department"}),b.map(n=>e.jsx("option",{value:n.id,children:n.name},n.id))]}),e.jsx(l,{htmlFor:"employee_type",children:"Employee Type"}),e.jsx(d,{id:"employee_type",name:"employee_type",value:t.employee_type,onChange:o}),e.jsx(l,{htmlFor:"employment_status",children:"Employment Status"}),e.jsx(d,{id:"employment_status",name:"employment_status",value:t.employment_status,onChange:o}),e.jsx(l,{htmlFor:"date_of_hire",children:"Date of Hire"}),e.jsx(d,{id:"date_of_hire",name:"date_of_hire",type:"date",value:t.date_of_hire,onChange:o}),e.jsx(l,{htmlFor:"gender",children:"Gender"}),e.jsx(d,{id:"gender",name:"gender",value:t.gender,onChange:o}),e.jsx(l,{htmlFor:"phone_number",children:"Phone Number"}),e.jsx(d,{id:"phone_number",name:"phone_number",value:t.phone_number,onChange:o}),e.jsx(l,{htmlFor:"address",children:"Address"}),e.jsx(d,{id:"address",name:"address",value:t.address,onChange:o})]})}),e.jsxs(q,{children:[e.jsx(y,{color:"secondary",onClick:()=>c(!1),children:"Close"}),e.jsx(y,{color:"primary",onClick:p,children:"Save Changes"})]})]})};D.propTypes={modalVisible:a.bool.isRequired,setModalVisible:a.func.isRequired,user:a.shape({id:a.number.isRequired,name:a.string,email:a.string,role_id:a.number,department:a.shape({id:a.number,name:a.string}),employee_type:a.string,employment_status:a.string,date_of_hire:a.string,gender:a.string,phone_number:a.string,address:a.string}).isRequired,fetchUsers:a.func.isRequired,roles:a.array.isRequired,departments:a.array.isRequired};const ie=()=>{const[g,c]=i.useState([]),[r,_]=i.useState([]),[h,b]=i.useState([]),[t,C]=i.useState(null),[o,p]=i.useState(!1);i.useEffect(()=>{x(),v()},[]),i.useEffect(()=>{r.length>0&&h.length>0&&n()},[r,h]);const n=async()=>{try{const s=await f.get("/api/users");c(s.data.data)}catch(s){console.error("Error fetching users:",s)}},x=async()=>{try{const s=await f.get("/api/roles");_(s.data)}catch(s){console.error("Error fetching roles:",s)}},v=async()=>{try{const s=await f.get("/api/departments");b(s.data)}catch(s){console.error("Error fetching departments:",s)}},E=async s=>{try{const m=await f.get(`/api/users/${s}`);C(m.data.data),p(!0)}catch(m){console.error("Error fetching user profile:",m)}};return e.jsxs(H,{children:[e.jsx(B,{xs:12,children:e.jsxs(k,{className:"mb-4",children:[e.jsxs(I,{className:"d-flex justify-content-between align-items-center",children:[e.jsx("strong",{children:"Access Control"}),e.jsxs(y,{color:"primary",children:[e.jsx(N,{icon:O,className:"me-2"}),"Add User"]})]}),e.jsx(z,{children:e.jsxs(V,{align:"middle",className:"mb-0 border",hover:!0,responsive:!0,children:[e.jsx($,{children:e.jsxs(S,{children:[e.jsx(u,{children:"Name"}),e.jsx(u,{children:"Email"}),e.jsx(u,{className:"text-center",children:"Role"}),e.jsx(u,{className:"text-center",children:"Department"}),e.jsx(u,{className:"text-center",children:"Actions"})]})}),e.jsx(G,{children:g.map(s=>{var m,F;return e.jsxs(S,{children:[e.jsx(j,{children:s.name}),e.jsx(j,{children:s.email}),e.jsx(j,{className:"text-center",children:r&&Array.isArray(r)&&((m=r.find(T=>T.id===s.role_id))==null?void 0:m.name)||"N/A"}),e.jsx(j,{className:"text-center",children:((F=s.department)==null?void 0:F.name)||"No Department"}),e.jsx(j,{className:"text-center",children:e.jsxs(y,{color:"secondary",size:"sm",onClick:()=>E(s.id),children:[e.jsx(N,{icon:L,className:"me-1"}),"More"]})})]},s.id)})})]})})]})}),t&&e.jsx(D,{modalVisible:o,setModalVisible:p,user:t,fetchUsers:n,roles:r,departments:h})]})};export{ie as default};
