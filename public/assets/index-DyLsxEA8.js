import{r as c,_ as q,R as j,a as w,c as D,P as o,j as e,q as _}from"./index-gnwgXD5w.js";import{a as B,b as L,c as z,d as M,e as W}from"./DefaultLayout-XAv-_MqK.js";import{C as ae}from"./cil-user-C9NKZ1F0.js";import{C as P,a as S}from"./CRow-Cy2Uixvs.js";import{c as H,d as U,a as E}from"./index.esm-DU_fYyWD.js";import{C as ne}from"./CFormTextarea-D_hmtxql.js";import{C as he,a as ve}from"./CCardBody-ChdJuS3I.js";import{C as Ce}from"./CCardHeader-D7lQTzzM.js";import{_ as ge,f as xe,a as je,T as be,u as Ne}from"./CCloseButton-C4XNciMs.js";import{C as ye,a as Ee,b as te,c as O,d as we,e as V}from"./CTable-D1J1oJ8G.js";var le=c.createContext({}),Q=c.forwardRef(function(r,n){var m=r.children,s=r.activeItemKey,l=r.alwaysOpen,d=l===void 0?!1:l,u=r.className,i=r.flush,t=q(r,["children","activeItemKey","alwaysOpen","className","flush"]),a=c.useState(s),f=a[0],h=a[1];return j.createElement("div",w({className:D("accordion",{"accordion-flush":i},u)},t,{ref:n}),j.createElement(le.Provider,{value:{_activeItemKey:f,alwaysOpen:d,setActiveKey:h}},m))});Q.propTypes={alwaysOpen:o.bool,activeItemKey:o.oneOfType([o.number,o.string]),children:o.node,className:o.string,flush:o.bool};Q.displayName="CAccordion";var X=c.createContext({}),Y=c.forwardRef(function(r,n){var m=r.children,s=r.className,l=r.id,d=r.itemKey,u=q(r,["children","className","id","itemKey"]),i=l??c.useId(),t=c.useRef(d??i),a=c.useContext(le),f=a._activeItemKey,h=a.alwaysOpen,C=a.setActiveKey,g=c.useState(f===t.current),N=g[0],y=g[1];return c.useEffect(function(){!h&&N&&C(t.current)},[N]),c.useEffect(function(){y(f===t.current)},[f]),j.createElement("div",w({className:D("accordion-item",s)},u,{ref:n}),j.createElement(X.Provider,{value:{id:i,setVisible:y,visible:N}},m))});Y.propTypes={children:o.node,className:o.string,itemKey:o.oneOfType([o.number,o.string])};Y.displayName="CAccordionItem";function J(){return J=Object.assign?Object.assign.bind():function(r){for(var n=1;n<arguments.length;n++){var m=arguments[n];for(var s in m)({}).hasOwnProperty.call(m,s)&&(r[s]=m[s])}return r},J.apply(null,arguments)}function Re(r,n){return r.classList?!!n&&r.classList.contains(n):(" "+(r.className.baseVal||r.className)+" ").indexOf(" "+n+" ")!==-1}function Te(r,n){r.classList?r.classList.add(n):Re(r,n)||(typeof r.className=="string"?r.className=r.className+" "+n:r.setAttribute("class",(r.className&&r.className.baseVal||"")+" "+n))}function oe(r,n){return r.replace(new RegExp("(^|\\s)"+n+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function Ae(r,n){r.classList?r.classList.remove(n):typeof r.className=="string"?r.className=oe(r.className,n):r.setAttribute("class",oe(r.className&&r.className.baseVal||"",n))}var Pe=function(n,m){return n&&m&&m.split(" ").forEach(function(s){return Te(n,s)})},G=function(n,m){return n&&m&&m.split(" ").forEach(function(s){return Ae(n,s)})},Z=function(r){ge(n,r);function n(){for(var s,l=arguments.length,d=new Array(l),u=0;u<l;u++)d[u]=arguments[u];return s=r.call.apply(r,[this].concat(d))||this,s.appliedClasses={appear:{},enter:{},exit:{}},s.onEnter=function(i,t){var a=s.resolveArguments(i,t),f=a[0],h=a[1];s.removeClasses(f,"exit"),s.addClass(f,h?"appear":"enter","base"),s.props.onEnter&&s.props.onEnter(i,t)},s.onEntering=function(i,t){var a=s.resolveArguments(i,t),f=a[0],h=a[1],C=h?"appear":"enter";s.addClass(f,C,"active"),s.props.onEntering&&s.props.onEntering(i,t)},s.onEntered=function(i,t){var a=s.resolveArguments(i,t),f=a[0],h=a[1],C=h?"appear":"enter";s.removeClasses(f,C),s.addClass(f,C,"done"),s.props.onEntered&&s.props.onEntered(i,t)},s.onExit=function(i){var t=s.resolveArguments(i),a=t[0];s.removeClasses(a,"appear"),s.removeClasses(a,"enter"),s.addClass(a,"exit","base"),s.props.onExit&&s.props.onExit(i)},s.onExiting=function(i){var t=s.resolveArguments(i),a=t[0];s.addClass(a,"exit","active"),s.props.onExiting&&s.props.onExiting(i)},s.onExited=function(i){var t=s.resolveArguments(i),a=t[0];s.removeClasses(a,"exit"),s.addClass(a,"exit","done"),s.props.onExited&&s.props.onExited(i)},s.resolveArguments=function(i,t){return s.props.nodeRef?[s.props.nodeRef.current,i]:[i,t]},s.getClassNames=function(i){var t=s.props.classNames,a=typeof t=="string",f=a&&t?t+"-":"",h=a?""+f+i:t[i],C=a?h+"-active":t[i+"Active"],g=a?h+"-done":t[i+"Done"];return{baseClassName:h,activeClassName:C,doneClassName:g}},s}var m=n.prototype;return m.addClass=function(l,d,u){var i=this.getClassNames(d)[u+"ClassName"],t=this.getClassNames("enter"),a=t.doneClassName;d==="appear"&&u==="done"&&a&&(i+=" "+a),u==="active"&&l&&xe(l),i&&(this.appliedClasses[d][u]=i,Pe(l,i))},m.removeClasses=function(l,d){var u=this.appliedClasses[d],i=u.base,t=u.active,a=u.done;this.appliedClasses[d]={},i&&G(l,i),t&&G(l,t),a&&G(l,a)},m.render=function(){var l=this.props;l.classNames;var d=je(l,["classNames"]);return j.createElement(be,J({},d,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},n}(j.Component);Z.defaultProps={classNames:""};Z.propTypes={};var ee=c.forwardRef(function(r,n){var m=r.children,s=r.className,l=r.horizontal,d=r.onHide,u=r.onShow,i=r.visible,t=q(r,["children","className","horizontal","onHide","onShow","visible"]),a=c.useRef(null),f=Ne(n,a),h=c.useState(),C=h[0],g=h[1],N=c.useState(),y=N[0],b=N[1],R=function(){if(u&&u(),l){a.current&&b(a.current.scrollWidth);return}a.current&&g(a.current.scrollHeight)},F=function(){if(l){b(0);return}g(0)},T=function(){if(l){a.current&&b(a.current.scrollWidth);return}a.current&&g(a.current.scrollHeight)},x=function(){if(d&&d(),l){b(0);return}g(0)},K=function(){if(l){b(0);return}g(0)};return j.createElement(Z,{in:i,nodeRef:a,onEntering:R,onEntered:F,onExit:T,onExiting:x,onExited:K,timeout:350},function(A){var I=C===0?null:{height:C},k=y===0?null:{width:y};return j.createElement("div",w({className:D(s,{"collapse-horizontal":l,collapsing:A==="entering"||A==="exiting","collapse show":A==="entered",collapse:A==="exited"}),style:w(w({},I),k)},t,{ref:f}),m)})});ee.propTypes={children:o.node,className:o.string,horizontal:o.bool,onHide:o.func,onShow:o.func,visible:o.bool};ee.displayName="CCollapse";var se=c.forwardRef(function(r,n){var m=r.children,s=r.className,l=q(r,["children","className"]),d=c.useContext(X),u=d.id,i=d.visible;return j.createElement(ee,{className:"accordion-collapse",id:u,visible:i},j.createElement("div",w({className:D("accordion-body",s)},l,{ref:n}),m))});se.propTypes={children:o.node,className:o.string};se.displayName="CAccordionBody";var re=c.forwardRef(function(r,n){var m=r.children,s=r.className,l=q(r,["children","className"]),d=c.useContext(X),u=d.id,i=d.visible,t=d.setVisible;return j.createElement("button",w({type:"button",className:D("accordion-button",{collapsed:!i},s),"aria-controls":u,"aria-expanded":i,onClick:function(){return t(!i)}},l,{ref:n}),m)});re.propTypes={children:o.node,className:o.string};re.displayName="CAccordionButton";var ie=c.forwardRef(function(r,n){var m=r.children,s=r.className,l=q(r,["children","className"]);return j.createElement("div",w({className:D("accordion-header",s)},l,{ref:n}),j.createElement(re,null,m))});ie.propTypes={children:o.node,className:o.string};ie.displayName="CAccordionHeader";const ce=({visibleProgram:r,setVisibleProgram:n,programTitle:m,setProgramTitle:s,programDescription:l,setProgramDescription:d,handleSaveProgram:u,visibleCourse:i,setVisibleCourse:t,courseTitle:a,setCourseTitle:f,courseDescription:h,setCourseDescription:C,setCourseFile:g,handleSaveCourse:N,modalVisible:y,setModalVisible:b,base64Doc:R,mimeType:F,fileName:T})=>e.jsxs(e.Fragment,{children:[e.jsxs(B,{size:"lg",visible:r,onClose:()=>n(!1),children:[e.jsx(L,{children:e.jsx(z,{children:"Add Program"})}),e.jsx(M,{children:e.jsxs(ae,{children:[e.jsx(P,{className:"mb-3",children:e.jsxs(S,{md:12,children:[e.jsx(H,{children:"Program Title"}),e.jsx(U,{value:m,onChange:x=>s(x.target.value)})]})}),e.jsx(P,{className:"mb-3",children:e.jsxs(S,{md:12,children:[e.jsx(H,{children:"Program Description"}),e.jsx(ne,{value:l,onChange:x=>d(x.target.value)})]})})]})}),e.jsxs(W,{children:[e.jsx(E,{color:"secondary",onClick:()=>n(!1),children:"Close"}),e.jsx(E,{color:"primary",onClick:u,children:"Save Program"})]})]}),e.jsxs(B,{size:"lg",visible:i,onClose:()=>t(!1),children:[e.jsx(L,{children:e.jsx(z,{children:"Add Course"})}),e.jsx(M,{children:e.jsxs(ae,{children:[e.jsx(P,{className:"mb-3",children:e.jsxs(S,{md:12,children:[e.jsx(H,{children:"Course Title"}),e.jsx(U,{value:a,onChange:x=>f(x.target.value)})]})}),e.jsx(P,{className:"mb-3",children:e.jsxs(S,{md:12,children:[e.jsx(H,{children:"Course Description"}),e.jsx(ne,{value:h,onChange:x=>C(x.target.value)})]})}),e.jsx(P,{className:"mb-3",children:e.jsxs(S,{md:12,children:[e.jsx(H,{children:"Upload File"}),e.jsx(U,{type:"file",onChange:x=>g(x.target.files[0])})]})})]})}),e.jsxs(W,{children:[e.jsx(E,{color:"secondary",onClick:()=>t(!1),children:"Close"}),e.jsx(E,{color:"primary",onClick:N,children:"Save Course"})]})]}),e.jsxs(B,{visible:y,onClose:()=>b(!1),size:"xl",fullscreen:!0,children:[e.jsx(L,{children:e.jsx(z,{children:"Document Preview"})}),e.jsx(M,{style:{padding:0},children:R?F==="application/pdf"?e.jsx("iframe",{src:`${R}`,style:{width:"100%",height:"90vh",border:"none"}}):e.jsx("iframe",{src:`https://view.officeapps.live.com/op/embed.aspx?src=${R}`,style:{width:"100%",height:"90vh",border:"none"}}):e.jsx("p",{children:"No preview available."})}),e.jsx(W,{children:e.jsx(E,{color:"secondary",onClick:()=>b(!1),children:"Close"})})]})]});ce.propTypes={visibleProgram:o.bool.isRequired,setVisibleProgram:o.func.isRequired,programTitle:o.string.isRequired,setProgramTitle:o.func.isRequired,programDescription:o.string.isRequired,setProgramDescription:o.func.isRequired,handleSaveProgram:o.func.isRequired,visibleCourse:o.bool.isRequired,setVisibleCourse:o.func.isRequired,courseTitle:o.string.isRequired,setCourseTitle:o.func.isRequired,courseDescription:o.string.isRequired,setCourseDescription:o.func.isRequired,setCourseFile:o.func.isRequired,handleSaveCourse:o.func.isRequired,modalVisible:o.bool.isRequired,setModalVisible:o.func.isRequired,base64Doc:o.string.isRequired,mimeType:o.string.isRequired,fileName:o.string.isRequired};const Ve=()=>{const[r,n]=c.useState([]),[m,s]=c.useState([]),[l,d]=c.useState(""),[u,i]=c.useState(""),[t,a]=c.useState(""),[f,h]=c.useState(""),[C,g]=c.useState(null),[N,y]=c.useState(null),[b,R]=c.useState(null),[F,T]=c.useState(!1),[x,K]=c.useState(!1),[A,I]=c.useState(!1);c.useEffect(()=>{(async()=>{try{const p=await _.get("/api/programs");n(p.data.data)}catch(p){console.error("Error fetching programs:",p)}})()},[]);const k=async v=>{try{const p=await _.get(`/api/courses?program_id=${v}`);s(p.data.data)}catch(p){console.error("Error fetching courses:",p)}},de=async()=>{if(!l||!u){alert("Please provide both title and description for the program.");return}try{const v=await _.post("/api/programs",{title:l,description:u});n(p=>[...p,v.data.data]),d(""),i(""),T(!1)}catch(v){console.error("Error adding program:",v),alert("Failed to add program.")}},ue=async v=>{if(v.preventDefault(),!t||!f){alert("Please provide both title and description for the course.");return}const p=new FormData;p.append("title",t),p.append("description",f),p.append("program_id",N),C&&p.append("file",C);try{const $=await _.post("/api/courses",p,{headers:{"Content-Type":"multipart/form-data"}});s(fe=>[...fe,$.data]),K(!1),a(""),h(""),g(null)}catch($){console.error("Error saving course:",$),alert("Failed to save course.")}},pe=async v=>{try{await _.delete(`/api/courses/${v}`),s(p=>p.filter($=>$.id!==v))}catch(p){console.error("Error deleting course:",p),alert("Failed to delete course.")}},me=v=>{R(v),I(!0)};return e.jsxs(P,{children:[e.jsx(S,{xs:12,children:e.jsxs(he,{className:"mb-4",children:[e.jsxs(Ce,{children:[e.jsx("strong",{children:"List of Programs"}),e.jsx("div",{className:"d-grid gap-2 d-md-flex justify-content-md-end",children:e.jsx(E,{color:"primary",onClick:()=>T(!0),children:"Add Program"})})]}),e.jsx(ve,{children:e.jsx(Q,{alwaysOpen:!0,children:r.map(v=>e.jsxs(Y,{children:[e.jsx(ie,{onClick:()=>{k(v.id)},children:v.title}),e.jsxs(se,{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Description:"})," ",v.description]}),e.jsx(E,{color:"primary",onClick:()=>{y(v.id),K(!0)},children:"Add Course"}),e.jsxs(ye,{striped:!0,className:"mt-3",children:[e.jsx(Ee,{children:e.jsxs(te,{children:[e.jsx(O,{children:"Course Title"}),e.jsx(O,{children:"Description"}),e.jsx(O,{children:"File"}),e.jsx(O,{children:"Actions"})]})}),e.jsx(we,{children:m.filter(p=>p.program_id===v.id).map(p=>e.jsxs(te,{children:[e.jsx(V,{children:p.title}),e.jsx(V,{children:p.description}),e.jsx(V,{children:p.file_path?e.jsx("a",{href:p.file_path,target:"_blank",rel:"noopener noreferrer",children:p.file_name||"Download"}):e.jsx("span",{children:"No File"})}),e.jsxs(V,{children:[e.jsx(E,{color:"info",onClick:()=>me(p.file_path),children:"Preview"}),e.jsx(E,{color:"danger",onClick:()=>pe(p.id),children:"Delete"})]})]},p.id))})]})]})]},v.id))})})]})}),e.jsx(ce,{visibleProgram:F,setVisibleProgram:T,programTitle:l,setProgramTitle:d,programDescription:u,setProgramDescription:i,handleSaveProgram:de,visibleCourse:x,setVisibleCourse:K,courseTitle:t,setCourseTitle:a,courseDescription:f,setCourseDescription:h,setCourseFile:g,handleSaveCourse:ue,modalVisible:A,setModalVisible:I,base64Doc:b,mimeType:b?"application/pdf":"",fileName:b})]})};export{Ve as default};
