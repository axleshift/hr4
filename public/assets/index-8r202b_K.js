import{r as o,j as e,P as i,q as c}from"./index-D8v5a4WY.js";import{a as k,b as E,c as J,d as M,e as A}from"./DefaultLayout-CGsPu-Y1.js";import{C as K}from"./cil-user-8dJGLO2g.js";import{C as d,a as h}from"./CRow-DgiK8Q1q.js";import{c as f,d as z,a as t}from"./index.esm-BP2aQwF0.js";import{C as Q}from"./CFormTextarea-Cf4wvK4F.js";import{C as ie,a as oe}from"./CCardBody-DDeIMS0X.js";import{C as ae}from"./CCardHeader-D0jkfmei.js";import{C as te,a as le,b as ne,c as ce}from"./CAccordionHeader-BEDNLEG5.js";import{C as de,a as he,b as X,c as F,d as pe,e as N}from"./CTable-Chm37jKH.js";import"./CCloseButton-C4qnBP5P.js";const Y=({visibleProgram:V,setVisibleProgram:p,programTitle:_,setProgramTitle:m,programDescription:u,setProgramDescription:g,handleSaveProgram:x,visibleCourse:v,setVisibleCourse:n,courseTitle:b,setCourseTitle:j,courseDescription:y,setCourseDescription:P,setCourseFile:w,handleSaveCourse:$,modalVisible:B,setModalVisible:C,base64Doc:T,mimeType:H,fileName:I})=>{const[L,W]=o.useState(!1),[O,D]=o.useState(null),[U,S]=o.useState(""),[G,R]=o.useState("");return e.jsxs(e.Fragment,{children:[e.jsxs(k,{size:"lg",visible:V,onClose:()=>p(!1),children:[e.jsx(E,{children:e.jsx(J,{children:"Add Program"})}),e.jsx(M,{children:e.jsxs(K,{children:[e.jsx(d,{className:"mb-3",children:e.jsxs(h,{md:12,children:[e.jsx(f,{children:"Program Title"}),e.jsx(z,{value:_,onChange:a=>m(a.target.value)})]})}),e.jsx(d,{className:"mb-3",children:e.jsxs(h,{md:12,children:[e.jsx(f,{children:"Program Description"}),e.jsx(Q,{value:u,onChange:a=>g(a.target.value)})]})})]})}),e.jsxs(A,{children:[e.jsx(t,{color:"secondary",onClick:()=>p(!1),children:"Close"}),e.jsx(t,{color:"primary",onClick:x,children:"Save Program"})]})]}),e.jsxs(k,{size:"lg",visible:v,onClose:()=>n(!1),children:[e.jsx(E,{children:e.jsx(J,{children:"Add Course"})}),e.jsx(M,{children:e.jsxs(K,{children:[e.jsx(d,{className:"mb-3",children:e.jsxs(h,{md:12,children:[e.jsx(f,{children:"Course Title"}),e.jsx(z,{value:b,onChange:a=>j(a.target.value)})]})}),e.jsx(d,{className:"mb-3",children:e.jsxs(h,{md:12,children:[e.jsx(f,{children:"Course Description"}),e.jsx(Q,{value:y,onChange:a=>P(a.target.value)})]})}),e.jsx(d,{className:"mb-3",children:e.jsxs(h,{md:12,children:[e.jsx(f,{children:"Upload File"}),e.jsx(z,{type:"file",onChange:a=>w(a.target.files[0])})]})})]})}),e.jsxs(A,{children:[e.jsx(t,{color:"secondary",onClick:()=>n(!1),children:"Close"}),e.jsx(t,{color:"primary",onClick:$,children:"Save Course"})]})]}),e.jsxs(k,{visible:B,onClose:()=>C(!1),children:[e.jsx(E,{children:"Course Document Preview"}),e.jsx(M,{children:T?H==="application/pdf"?e.jsx("iframe",{src:`${T}`,style:{width:"100%",height:"500px",border:"none"}}):e.jsx("iframe",{src:`https://view.officeapps.live.com/op/embed.aspx?src=https://hr4.axleshift.com/uploads/${I}`,style:{width:"100%",height:"500px",border:"none"}}):e.jsx("p",{children:"No preview available."})}),e.jsx(A,{children:e.jsx(t,{color:"secondary",onClick:()=>C(!1),children:"Close"})})]})]})};Y.propTypes={visibleProgram:i.bool.isRequired,setVisibleProgram:i.func.isRequired,programTitle:i.string.isRequired,setProgramTitle:i.func.isRequired,programDescription:i.string.isRequired,setProgramDescription:i.func.isRequired,handleSaveProgram:i.func.isRequired,visibleCourse:i.bool.isRequired,setVisibleCourse:i.func.isRequired,courseTitle:i.string.isRequired,setCourseTitle:i.func.isRequired,courseDescription:i.string.isRequired,setCourseDescription:i.func.isRequired,setCourseFile:i.func.isRequired,handleSaveCourse:i.func.isRequired,modalVisible:i.bool.isRequired,setModalVisible:i.func.isRequired,base64Doc:i.string.isRequired,mimeType:i.string.isRequired,fileName:i.string.isRequired};const we=()=>{const[V,p]=o.useState([]),[_,m]=o.useState([]),[u,g]=o.useState(""),[x,v]=o.useState(""),[n,b]=o.useState(""),[j,y]=o.useState(""),[P,w]=o.useState(null),[$,B]=o.useState(null),[C,T]=o.useState(""),[H,I]=o.useState(""),[L,W]=o.useState(""),[O,D]=o.useState(!1),[U,S]=o.useState(!1),[G,R]=o.useState(!1);o.useEffect(()=>{(async()=>{try{const s=await c.get("/api/programs");p(s.data.data)}catch(s){console.error("Error fetching programs:",s)}})()},[]);const a=async r=>{try{const s=await c.get(`/api/courses?program_id=${r}`);m(s.data.data)}catch(s){console.error("Error fetching courses:",s)}},Z=async r=>{try{const s=await c.get(`/api/courses/${r}/preview`);T(s.data.base64),I(s.data.mime_type),W(s.data.file_name),D(!0)}catch(s){console.error("Error fetching course document preview:",s),alert("Error fetching preview")}},ee=async()=>{if(!u||!x){alert("Please provide both title and description for the program.");return}try{const r=await c.post("/api/programs",{title:u,description:x});p(s=>[...s,r.data.data]),g(""),v(""),S(!1)}catch(r){console.error("Error adding program:",r),alert("Failed to add program.")}},se=async r=>{if(r.preventDefault(),!n||!j){alert("Please provide both title and description for the course.");return}const s=new FormData;s.append("title",n),s.append("description",j),s.append("program_id",$),P&&s.append("file",P);try{const l=await c.post("/api/courses",s,{headers:{"Content-Type":"multipart/form-data"}});m(q=>[...q,l.data]),R(!1),b(""),y(""),w(null)}catch(l){console.error("Error saving course:",l),alert("Failed to save course.")}},re=async r=>{try{await c.delete(`/api/courses/${r}`),m(s=>s.filter(l=>l.id!==r))}catch(s){console.error("Error deleting course:",s),alert("Failed to delete course.")}};return e.jsxs(d,{children:[e.jsx(h,{xs:12,children:e.jsxs(ie,{className:"mb-4",children:[e.jsxs(ae,{children:[e.jsx("strong",{children:"List of Programs"}),e.jsx("div",{className:"d-grid gap-2 d-md-flex justify-content-md-end",children:e.jsx(t,{color:"primary",onClick:()=>S(!0),children:"Add Program"})})]}),e.jsx(oe,{children:e.jsx(te,{alwaysOpen:!0,children:V.map(r=>e.jsxs(le,{children:[e.jsx(ne,{onClick:()=>a(r.id),children:r.title}),e.jsxs(ce,{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Description:"})," ",r.description]}),e.jsx(t,{color:"primary",onClick:()=>{B(r.id),R(!0)},children:"Add Course"}),e.jsxs(de,{striped:!0,className:"mt-3",children:[e.jsx(he,{children:e.jsxs(X,{children:[e.jsx(F,{children:"Course Title"}),e.jsx(F,{children:"Description"}),e.jsx(F,{children:"File"}),e.jsx(F,{children:"Actions"})]})}),e.jsx(pe,{children:_.filter(s=>s.program_id===r.id).map(s=>{var l,q;return e.jsxs(X,{children:[e.jsx(N,{children:s.title}),e.jsx(N,{children:s.description}),e.jsx(N,{children:(((l=s.file_name)==null?void 0:l.endsWith(".docx"))||((q=s.file_name)==null?void 0:q.endsWith(".pdf")))&&e.jsx(t,{color:"info",onClick:()=>Z(s.id),children:"View"})}),e.jsx(N,{children:e.jsx(t,{color:"danger",onClick:()=>re(s.id),children:"Delete"})})]},s.id)})})]})]})]},r.id))})})]})}),e.jsxs(k,{visible:O,onClose:()=>D(!1),children:[e.jsx(E,{children:"Document Preview"}),e.jsx(M,{children:C?H==="application/pdf"?e.jsx("iframe",{src:`${C}`,style:{width:"100%",height:"500px",border:"none"}}):e.jsx("iframe",{src:`https://view.officeapps.live.com/op/embed.aspx?src=https://hr4.axleshift.com/uploads/${L}`,style:{width:"100%",height:"500px",border:"none"}}):e.jsx("p",{children:"No preview available."})}),e.jsx(A,{children:e.jsx(t,{color:"secondary",onClick:()=>D(!1),children:"Close"})})]}),e.jsx(Y,{visibleProgram:U,setVisibleProgram:S,programTitle:u,setProgramTitle:g,programDescription:x,setProgramDescription:v,handleSaveProgram:ee,visibleCourse:G,setVisibleCourse:R,courseTitle:n,setCourseTitle:b,courseDescription:j,setCourseDescription:y,setCourseFile:w,handleSaveCourse:se})]})};export{we as default};
