import{r as t,_ as k,R as v,a as w,c as L,P as n,b as _,m as P,k as q,j as e,C as A,i as B,h as D}from"./index-Bh-5LcrH.js";import{b as F,e as y,d as S,a as G}from"./index.esm-BxPQSjkw.js";import{C as E,a as N}from"./CRow-Cy4553vC.js";import{C as O}from"./CCardGroup-BBVU8QwW.js";import{C as z,a as H}from"./CCardBody-CPitq4zx.js";import{C as U,c as X}from"./cil-user-C9E1AmMv.js";import{u as M,T as V,C as W}from"./CCloseButton-B7RvU8mf.js";import{C as R,a as I}from"./CInputGroupText-BMxJpLAr.js";import{c as $}from"./cil-lock-locked-DmxpJbVL.js";var j=t.forwardRef(function(s,C){var f=s.children,g=s.className,l=s.color,c=l===void 0?"primary":l,a=s.dismissible,h=s.variant,d=s.visible,m=d===void 0?!0:d,b=s.onClose,r=k(s,["children","className","color","dismissible","variant","visible","onClose"]),u=t.useRef(null),x=M(C,u),o=t.useState(m),p=o[0],i=o[1];return t.useEffect(function(){i(m)},[m]),v.createElement(V,{in:p,mountOnEnter:!0,nodeRef:u,onExit:b,timeout:150,unmountOnExit:!0},function(T){return v.createElement("div",w({className:L("alert",h==="solid"?"bg-".concat(c," text-white"):"alert-".concat(c),{"alert-dismissible fade":a,show:T==="entered"},g),role:"alert"},r,{ref:x}),f,a&&v.createElement(W,{onClick:function(){return i(!1)}}))})});j.propTypes={children:n.node,className:n.string,color:_.isRequired,dismissible:n.bool,onClose:n.func,variant:n.string,visible:n.bool};j.displayName="CAlert";t.createContext(null);const re=()=>{const[s,C]=t.useState(""),[f,g]=t.useState(""),[l,c]=t.useState(!1),[a,h]=t.useState({visible:!1,type:"",message:""}),d=P(),m=q(),b=async r=>{var u,x;r.preventDefault(),c(!0);try{const o=await B.post("https://backend-admin.axleshift.com/integ/external-login/HR",{email:s,password:f},{headers:{Authorization:"Bearer admin1229102","Content-Type":"application/json","X-Requested-With":"XMLHttpRequest",Accept:"application/json"}}),{token:p,user:i}=o.data;d({type:"SET_USER",payload:i}),d({type:"SET_SESSION_ID",payload:p}),D.set("external_token",p,{expires:30,secure:!0,sameSite:"Strict"}),sessionStorage.setItem("external_token",p),sessionStorage.setItem("role",i.role),sessionStorage.setItem("user_id",i.id),sessionStorage.setItem("name",i.name),sessionStorage.setItem("email",i.email),m("/dashboard")}catch(o){h({visible:!0,type:"danger",message:((x=(u=o.response)==null?void 0:u.data)==null?void 0:x.message)||"Login failed. Please try again."})}finally{c(!1)}};return t.useEffect(()=>{if(a.visible){const r=setTimeout(()=>h({...a,visible:!1}),3e3);return()=>clearTimeout(r)}},[a]),e.jsx("div",{className:"bg-body-tertiary min-vh-100 d-flex flex-row align-items-center",children:e.jsx(F,{children:e.jsx(E,{className:"justify-content-center",children:e.jsx(N,{md:8,children:e.jsx(O,{children:e.jsx(z,{className:"p-4",children:e.jsx(H,{children:e.jsxs(U,{onSubmit:b,children:[e.jsx("h1",{children:"Login"}),e.jsx("p",{className:"text-body-secondary",children:"Sign in to your account"}),a.visible&&e.jsx(j,{color:a.type,children:a.message}),e.jsxs(R,{className:"mb-3",children:[e.jsx(I,{children:e.jsx(y,{icon:X})}),e.jsx(S,{type:"email",placeholder:"Email",value:s,onChange:r=>C(r.target.value),required:!0})]}),e.jsxs(R,{className:"mb-3",children:[e.jsx(I,{children:e.jsx(y,{icon:$})}),e.jsx(S,{type:"password",placeholder:"Password",value:f,onChange:r=>g(r.target.value),required:!0})]}),e.jsx(E,{children:e.jsx(N,{xs:6,children:e.jsx(G,{type:"submit",color:"primary",disabled:l,children:l?e.jsx(A,{size:"sm"}):"Login"})})})]})})})})})})})})};export{re as default};
