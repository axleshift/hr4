import{r as l,w as N,i as h,j as s}from"./index-Cg3YCqv-.js";import{C as E,a as p}from"./CRow-DkSO5dJR.js";import{C as R,a as A}from"./CCardBody-DpHCF6P5.js";import{C as L}from"./CCardHeader-D66J4zjU.js";import{d as U,a as u}from"./index.esm-fvB-fXbU.js";import{C as w}from"./CFormSelect-B6UuWjBi.js";import{C as O,a as z,b as x,c as r,d as Y,e as a}from"./CTable-CG8I_KWJ.js";import{a as q,b as G,c as J,d as K,e as Q,f as j}from"./DefaultLayout-Bkt4zFiM.js";import"./CCloseButton-UQPbDVaW.js";import"./cil-user-0akUBu9p.js";const oe=()=>{const[S,c]=l.useState([]),[v,f]=l.useState([]),[g,b]=l.useState(""),[d,T]=l.useState("all"),[H,i]=l.useState(!1),[n,I]=l.useState(null),[m,C]=l.useState("pending");l.useEffect(()=>{B(),M()},[]);const B=async()=>{try{const e=await N.get("https://backend-hr1.axleshift.com/api/employees"),t=e.data.data||e.data;F(t),c(t)}catch(e){console.error("Error fetching external employees:",e);try{const t=await h.get("/api/employee");c(t.data.data)}catch(t){console.error("Error fetching local employees:",t)}}},M=async()=>{try{const e=await N.get("https://backend-hr1.axleshift.com/api/newhires");f(e.data.data||e.data)}catch(e){console.error("Error fetching new hires:",e)}},F=async e=>{try{for(const t of e){const o={employeeId:t.employeeId,lastName:t.lastName,firstName:t.firstName,middleName:t.middleName,position:t.position,department:t.department,dateHired:t.dateHired,email:t.email};await h.post("/api/employee",o)}console.log("Employees saved successfully")}catch(t){console.error("Error saving employees:",t)}},$=e=>{const t=e.middleName?` ${e.middleName}`:"";return`${e.firstName}${t} ${e.lastName}`},D=e=>{switch(e){case"completed":return s.jsx(j,{color:"success",children:"Completed"});case"in progress":return s.jsx(j,{color:"warning",children:"In Progress"});case"pending":default:return s.jsx(j,{color:"secondary",children:"Pending"})}},k=e=>{I(e),C(e.status||"pending"),i(!0)},P=async()=>{if(n)try{await h.put(`/api/employee-training-status/${n.employeeId}`,{status:m,name:`${n.firstName} ${n.middleName??""} ${n.lastName}`});const e=t=>t.map(o=>o.id===n.id?{...o,status:m}:o);c(t=>e(t)),f(t=>e(t)),i(!1)}catch(e){console.error("Error updating status:",e)}},y=[...S.map(e=>({...e,source:"regular"})),...v.map(e=>({...e,source:"new"}))].filter(e=>d==="new"?e.source==="new":d==="regular"?e.source==="regular":!0).filter(e=>[e.employeeId,e.firstName,e.middleName,e.lastName,e.position,e.department,e.email,e.dateHired].filter(Boolean).some(t=>t.toLowerCase().includes(g.toLowerCase())));return s.jsxs(s.Fragment,{children:[s.jsx(E,{children:s.jsx(p,{xs:12,children:s.jsxs(R,{className:"mb-4",children:[s.jsx(L,{className:"d-flex justify-content-between align-items-center",children:s.jsx("strong",{children:"Employee Management"})}),s.jsxs(A,{children:[s.jsxs(E,{className:"mb-3",children:[s.jsx(p,{md:6,children:s.jsx(U,{placeholder:"Search by ID, name, position, department, etc...",value:g,onChange:e=>b(e.target.value)})}),s.jsx(p,{md:3,children:s.jsxs(w,{value:d,onChange:e=>T(e.target.value),children:[s.jsx("option",{value:"all",children:"All Employees"}),s.jsx("option",{value:"new",children:"New Hires Only"}),s.jsx("option",{value:"regular",children:"Regular Employees Only"})]})})]}),s.jsx("div",{style:{maxHeight:"500px",overflowY:"auto"},children:s.jsxs(O,{align:"middle",className:"mb-0 border",hover:!0,responsive:!0,children:[s.jsx(z,{children:s.jsxs(x,{children:[s.jsx(r,{children:"#"})," ",s.jsx(r,{children:"Employee ID"}),s.jsx(r,{children:"Name"}),s.jsx(r,{children:"Position"}),s.jsx(r,{children:"Department"}),s.jsx(r,{children:"Date Hired"}),s.jsx(r,{children:"Email"}),s.jsx(r,{className:"text-center",children:"Status"}),s.jsx(r,{className:"text-center",children:"Action"})]})}),s.jsx(Y,{children:y.length>0?y.map((e,t)=>s.jsxs(x,{children:[s.jsx(a,{children:t+1})," ",s.jsx(a,{children:e.employeeId}),s.jsx(a,{children:$(e)}),s.jsx(a,{children:e.position}),s.jsx(a,{children:e.department}),s.jsx(a,{children:e.dateHired}),s.jsx(a,{children:e.email}),s.jsx(a,{className:"text-center",children:D(e.status)}),s.jsx(a,{className:"text-center",children:s.jsx(u,{color:"primary",size:"sm",onClick:()=>k(e),children:"Edit Status"})})]},e.id)):s.jsx(x,{children:s.jsxs(a,{colSpan:9,className:"text-center",children:[" ","No employees found."]})})})]})})]})]})})}),s.jsxs(q,{visible:H,onClose:()=>i(!1),children:[s.jsx(G,{closeButton:!0,children:s.jsx(J,{children:"Edit Training Status"})}),s.jsx(K,{children:s.jsxs(w,{label:"Training Status",value:m,onChange:e=>C(e.target.value),children:[s.jsx("option",{value:"pending",children:"Pending"}),s.jsx("option",{value:"in progress",children:"In Progress"}),s.jsx("option",{value:"completed",children:"Completed"})]})}),s.jsxs(Q,{children:[s.jsx(u,{color:"secondary",onClick:()=>i(!1),children:"Cancel"}),s.jsx(u,{color:"primary",onClick:P,children:"Save"})]})]})]})};export{oe as default};
