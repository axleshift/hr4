import{r as m,j as e,h as f,P as a}from"./index-Cvl6L-Sk.js";import{c as l,a as y,d as v}from"./index.esm-Cb8w8Uyl.js";import{a as S,b as T,c as D,d as U}from"./DefaultLayout-Cyrm1aYL.js";import{C as q}from"./CModalTitle-9uZsEHwh.js";import{C as w}from"./CForm--YuX5jNz.js";import{C as d}from"./CFormInput-BJ8qDpXP.js";import{C as F}from"./CFormSelect-Dkj9eb3A.js";import{C as A,a as M}from"./CRow-DEmrbcU5.js";import{C as P,a as H}from"./CCardBody-BYdA2OAC.js";import{C as B}from"./CCardHeader-DBioM7HA.js";import{c as k}from"./cil-user-plus-9sfVD_63.js";import{C as z,a as I,b as E,c as p,d as O,e as x}from"./CTable-BA_RGFjV.js";import{c as V}from"./cil-options-sHCm5Gxk.js";import"./CCloseButton-HcYs-KeF.js";import"./cil-user-Ddrdy7PS.js";const N=({modalVisible:_,setModalVisible:c,user:s,fetchUsers:g,roles:u,departments:b})=>{const[t,h]=m.useState({name:"",email:"",role:"",department:"",employee_type:"",employment_status:"",date_of_hire:"",gender:"",phone_number:"",address:""});m.useEffect(()=>{s&&h({name:s.name||"",email:s.email||"",role:s.role_id||"",department:s.department?s.department.id:"",employee_type:s.employee_type||"",employment_status:s.employment_status||"",date_of_hire:s.date_of_hire||"",gender:s.gender||"",phone_number:s.phone_number||"",address:s.address||""})},[s]);const o=n=>{const{name:r,value:i}=n.target;h(C=>({...C,[r]:i}))},j=async n=>{n.preventDefault();try{await f.put(`/api/users/${s.id}`,t),g(),c(!1)}catch(r){console.error("Error updating user profile:",r)}};return e.jsxs(S,{visible:_,onClose:()=>c(!1),size:"lg",children:[e.jsx(T,{children:e.jsx(q,{children:"Edit Profile"})}),e.jsx(D,{children:e.jsxs(w,{onSubmit:j,children:[e.jsx(l,{htmlFor:"name",children:"Full Name"}),e.jsx(d,{id:"name",name:"name",value:t.name,onChange:o}),e.jsx(l,{htmlFor:"email",children:"Email"}),e.jsx(d,{id:"email",name:"email",value:t.email,readOnly:!0}),e.jsx(l,{htmlFor:"role",children:"Role"}),e.jsxs(F,{id:"role",name:"role",value:t.role,onChange:o,children:[e.jsx("option",{value:"",children:"Select Role"}),u.map(n=>e.jsx("option",{value:n.id,children:n.name},n.id))]}),e.jsx(l,{htmlFor:"department",children:"Department"}),e.jsxs(F,{id:"department",name:"department",value:t.department,onChange:o,children:[e.jsx("option",{value:"",children:"Select Department"}),b.map(n=>e.jsx("option",{value:n.id,children:n.name},n.id))]}),e.jsx(l,{htmlFor:"employee_type",children:"Employee Type"}),e.jsx(d,{id:"employee_type",name:"employee_type",value:t.employee_type,onChange:o}),e.jsx(l,{htmlFor:"employment_status",children:"Employment Status"}),e.jsx(d,{id:"employment_status",name:"employment_status",value:t.employment_status,onChange:o}),e.jsx(l,{htmlFor:"date_of_hire",children:"Date of Hire"}),e.jsx(d,{id:"date_of_hire",name:"date_of_hire",type:"date",value:t.date_of_hire,onChange:o}),e.jsx(l,{htmlFor:"gender",children:"Gender"}),e.jsx(d,{id:"gender",name:"gender",value:t.gender,onChange:o}),e.jsx(l,{htmlFor:"phone_number",children:"Phone Number"}),e.jsx(d,{id:"phone_number",name:"phone_number",value:t.phone_number,onChange:o}),e.jsx(l,{htmlFor:"address",children:"Address"}),e.jsx(d,{id:"address",name:"address",value:t.address,onChange:o})]})}),e.jsxs(U,{children:[e.jsx(y,{color:"secondary",onClick:()=>c(!1),children:"Close"}),e.jsx(y,{color:"primary",onClick:j,children:"Save Changes"})]})]})};N.propTypes={modalVisible:a.bool.isRequired,setModalVisible:a.func.isRequired,user:a.shape({id:a.number.isRequired,name:a.string,email:a.string,role_id:a.number,department:a.shape({id:a.number,name:a.string}),employee_type:a.string,employment_status:a.string,date_of_hire:a.string,gender:a.string,phone_number:a.string,address:a.string}).isRequired,fetchUsers:a.func.isRequired,roles:a.array.isRequired,departments:a.array.isRequired};const ne=()=>{const[_,c]=m.useState([]),[s,g]=m.useState([]),[u,b]=m.useState(null),[t,h]=m.useState(!1);m.useEffect(()=>{j()},[]),m.useEffect(()=>{s.length>0&&o()},[s]);const o=async()=>{try{const r=await f.get("/api/users");c(r.data.data)}catch(r){console.error("Error fetching users:",r)}},j=async()=>{try{const r=await f.get("/api/roles");g(r.data)}catch(r){console.error("Error fetching roles:",r)}},n=async r=>{try{const i=await f.get(`/api/users/${r}`);b(i.data.data),h(!0)}catch(i){console.error("Error fetching user profile:",i)}};return e.jsxs(A,{children:[e.jsx(M,{xs:12,children:e.jsxs(P,{className:"mb-4",children:[e.jsxs(B,{className:"d-flex justify-content-between align-items-center",children:[e.jsx("strong",{children:"Access Control"}),e.jsxs(y,{color:"primary",children:[e.jsx(v,{icon:k,className:"me-2"}),"Add User"]})]}),e.jsx(H,{children:e.jsxs(z,{align:"middle",className:"mb-0 border",hover:!0,responsive:!0,children:[e.jsx(I,{children:e.jsxs(E,{children:[e.jsx(p,{children:"Name"}),e.jsx(p,{children:"Email"}),e.jsx(p,{className:"text-center",children:"Role"}),e.jsx(p,{className:"text-center",children:"Department"}),e.jsx(p,{className:"text-center",children:"Actions"})]})}),e.jsx(O,{children:_.map(r=>{var i,C;return e.jsxs(E,{children:[e.jsx(x,{children:r.name}),e.jsx(x,{children:r.email}),e.jsx(x,{className:"text-center",children:((i=s.find(R=>R.id===r.role_id))==null?void 0:i.name)||"N/A"}),e.jsx(x,{className:"text-center",children:((C=r.department)==null?void 0:C.name)||"No Department"}),e.jsx(x,{className:"text-center",children:e.jsxs(y,{color:"secondary",size:"sm",onClick:()=>n(r.id),children:[e.jsx(v,{icon:V,className:"me-1"}),"More"]})})]},r.id)})})]})})]})}),u&&e.jsx(N,{modalVisible:t,setModalVisible:h,user:u,fetchUsers:o,roles:s})]})};export{ne as default};
