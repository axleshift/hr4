import{r as p,j as e,q as F,P as s}from"./index-Bh88rFDL.js";import{c,d as i,a as S,e as R}from"./index.esm-DRuiXNQ-.js";import{a as D,b as q,c as A,d as B,e as H}from"./DefaultLayout-BlHTKyn-.js";import{C as P}from"./cil-user-UShTQDOr.js";import{C as V,a as I}from"./CRow-jO2NlhCr.js";import{C as O,a as $}from"./CCardBody-M0MFjdp8.js";import{C as z}from"./CCardHeader-DEHTIKUM.js";import{C as G,a as J,b as U,c as j,d as K,e as x}from"./CTable-D6qvxrv6.js";import{c as Q}from"./cil-options-sHCm5Gxk.js";import"./CCloseButton-BjA9ruey.js";const M=({modalVisible:_,setModalVisible:N,user:t,fetchUsers:L})=>{const n=m=>m||"NULL",[a,d]=p.useState({name:"NULL",email:"NULL",role:"NULL",department:"NULL",employee_type:"NULL",employment_status:"NULL",date_of_hire:"NULL",gender:"NULL",phone_number:"NULL",address:"NULL"});p.useEffect(()=>{t&&d({name:n(t.name),email:n(t.email),role:n(t.role),department:n(t.department),employee_type:n(t.employee_type),employment_status:n(t.employment_status),date_of_hire:n(t.date_of_hire),gender:n(t.gender),phone_number:n(t.phone_number),address:n(t.address)})},[t]);const o=m=>{const{name:f,value:y}=m.target;d(C=>({...C,[f]:y||"NULL"}))},u=()=>{N(!1)},g=async m=>{m.preventDefault();try{await F.put(`/api/users/${t.id}`,a),L(),u()}catch(f){console.error("Error updating user profile:",f)}};return e.jsxs(D,{visible:_,onClose:u,children:[e.jsx(q,{children:e.jsx(A,{children:"Edit Profile"})}),e.jsx(B,{children:e.jsxs(P,{onSubmit:g,children:[e.jsx(c,{htmlFor:"name",children:"Full Name"}),e.jsx(i,{id:"name",name:"name",value:a.name,onChange:o}),e.jsx(c,{htmlFor:"email",children:"Email"}),e.jsx(i,{id:"email",name:"email",value:a.email,readOnly:!0}),e.jsx(c,{htmlFor:"role",children:"Role"}),e.jsx(i,{id:"role",name:"role",value:a.role,onChange:o}),e.jsx(c,{htmlFor:"department",children:"Department"}),e.jsx(i,{id:"department",name:"department",value:a.department,onChange:o}),e.jsx(c,{htmlFor:"employee_type",children:"Employee Type"}),e.jsx(i,{id:"employee_type",name:"employee_type",value:a.employee_type,onChange:o}),e.jsx(c,{htmlFor:"employment_status",children:"Employment Status"}),e.jsx(i,{id:"employment_status",name:"employment_status",value:a.employment_status,onChange:o}),e.jsx(c,{htmlFor:"date_of_hire",children:"Date of Hire"}),e.jsx(i,{id:"date_of_hire",name:"date_of_hire",type:"date",value:a.date_of_hire,onChange:o}),e.jsx(c,{htmlFor:"gender",children:"Gender"}),e.jsx(i,{id:"gender",name:"gender",value:a.gender,onChange:o}),e.jsx(c,{htmlFor:"phone_number",children:"Phone Number"}),e.jsx(i,{id:"phone_number",name:"phone_number",value:a.phone_number,onChange:o}),e.jsx(c,{htmlFor:"address",children:"Address"}),e.jsx(i,{id:"address",name:"address",value:a.address,onChange:o})]})}),e.jsxs(H,{children:[e.jsx(S,{color:"secondary",onClick:u,children:"Close"}),e.jsx(S,{color:"primary",onClick:g,children:"Save Changes"})]})]})};M.propTypes={modalVisible:s.bool.isRequired,setModalVisible:s.func.isRequired,user:s.shape({id:s.number.isRequired,name:s.string,email:s.string,role:s.string,department:s.string,employee_type:s.string,employment_status:s.string,date_of_hire:s.string,gender:s.string,phone_number:s.string,address:s.string}).isRequired,fetchUsers:s.func.isRequired};const le=()=>{const[_,N]=p.useState([]),[t,L]=p.useState(null),[n,a]=p.useState(!1),[d,o]=p.useState({key:null,direction:"asc"}),[u,g]=p.useState("");p.useEffect(()=>{m()},[]);const m=async()=>{try{const r=await F.get("/api/users");N(r.data.data)}catch(r){console.error("Error fetching users:",r)}},f=async r=>{try{const l=await F.get(`/api/users/${r}`);L(l.data.data),a(!0)}catch(l){console.error("Error fetching user profile:",l)}},y=r=>{o(l=>l.key===r?{key:r,direction:l.direction==="asc"?"desc":"asc"}:{key:r,direction:"asc"})},C=r=>d.key!==r?"":d.direction==="asc"?" ↑":" ↓",v=[..._.filter(r=>{var l;return[r.name,r.email,r.role,(l=r.department)==null?void 0:l.name].some(h=>h==null?void 0:h.toLowerCase().includes(u.toLowerCase()))})].sort((r,l)=>{var h,E,b,T;if(d.key){const k=((E=(h=r[d.key])==null?void 0:h.toLowerCase)==null?void 0:E.call(h))??"",w=((T=(b=l[d.key])==null?void 0:b.toLowerCase)==null?void 0:T.call(b))??"";if(k<w)return d.direction==="asc"?-1:1;if(k>w)return d.direction==="asc"?1:-1}return 0});return e.jsxs(V,{children:[e.jsx(I,{xs:12,children:e.jsxs(O,{className:"mb-4",children:[e.jsx(z,{className:"d-flex justify-content-between align-items-center",children:e.jsx("strong",{children:"Access Control"})}),e.jsxs($,{children:[e.jsx(i,{type:"text",placeholder:"Search by name, email, role, or department...",className:"mb-3",value:u,onChange:r=>g(r.target.value)}),e.jsxs(G,{align:"middle",className:"mb-0 border",hover:!0,responsive:!0,children:[e.jsx(J,{children:e.jsxs(U,{children:[e.jsx(j,{children:"#"}),e.jsxs(j,{className:"bg-body-tertiary",onClick:()=>y("name"),style:{cursor:"pointer"},children:["Name",C("name")]}),e.jsxs(j,{className:"bg-body-tertiary",onClick:()=>y("email"),style:{cursor:"pointer"},children:["Email",C("email")]}),e.jsxs(j,{className:"bg-body-tertiary text-center",onClick:()=>y("role"),style:{cursor:"pointer"},children:["Role",C("role")]}),e.jsxs(j,{className:"bg-body-tertiary text-center",onClick:()=>y("department.name"),style:{cursor:"pointer"},children:["Department",C("department.name")]}),e.jsx(j,{className:"bg-body-tertiary text-center",children:"More"})]})}),e.jsx(K,{children:v.length>0?v.map(r=>e.jsxs(U,{children:[e.jsx(x,{children:r.id}),e.jsx(x,{children:r.name}),e.jsx(x,{children:r.email}),e.jsx(x,{className:"text-center",children:r.role}),e.jsx(x,{className:"text-center",children:r.departm1ent?r.department.name:"N/A"}),e.jsx(x,{className:"text-center",children:e.jsxs(S,{color:"secondary",size:"sm",onClick:()=>f(r.id),children:[e.jsx(R,{icon:Q})," More"]})})]},r.id)):e.jsx(U,{children:e.jsx(x,{colSpan:6,className:"text-center",children:"No users found."})})})]})]})]})}),t&&e.jsx(M,{modalVisible:n,setModalVisible:a,user:t,fetchUsers:m})]})};export{le as default};
