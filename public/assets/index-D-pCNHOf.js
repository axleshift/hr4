import{r as n,w as y,j as e,i as D}from"./index-DmNjZPYx.js";import{C as N,a as h}from"./CRow-D32PbMVd.js";import{C as P,a as R}from"./CCardBody-Imhn15jv.js";import{C as L}from"./CCardHeader-C-K6c_rl.js";import{d as U,a as m}from"./index.esm-DPybPsmx.js";import{C as w}from"./CFormSelect-DK1arbni.js";import{C as A,a as O,b as u,c as r,d as z,e as a}from"./CTable-CpE6BzuY.js";import{a as Y,b as q,c as G,d as J,e as K,f as x}from"./DefaultLayout-DhEWNU-2.js";import"./CCloseButton-CG75PqP-.js";import"./cil-user-B012K8FN.js";const le=()=>{const[E,p]=n.useState([]),[S,j]=n.useState([]),[g,b]=n.useState(""),[o,v]=n.useState("all"),[T,i]=n.useState(!1),[l,H]=n.useState(null),[c,C]=n.useState("pending");n.useEffect(()=>{B(),I()},[]);const B=async()=>{try{const s=await y.get("https://backend-hr1.axleshift.com/api/employees"),t=s.data.data||s.data;p(t)}catch(s){console.error("Error fetching external employees:",s)}},I=async()=>{try{const s=await y.get("https://backend-hr1.axleshift.com/api/newhires");j(s.data.data||s.data)}catch(s){console.error("Error fetching new hires:",s)}},M=s=>{const t=s.middleName?` ${s.middleName}`:"";return`${s.firstName}${t} ${s.lastName}`},F=s=>{switch(s){case"completed":return e.jsx(x,{color:"success",children:"Completed"});case"in progress":return e.jsx(x,{color:"warning",children:"In Progress"});case"pending":default:return e.jsx(x,{color:"secondary",children:"Pending"})}},$=s=>{H(s),C(s.status||"pending"),i(!0)},k=async()=>{if(l)try{await D.put(`/api/employee-training-status/${l.employeeId}`,{status:c,name:`${l.firstName} ${l.middleName??""} ${l.lastName}`});const s=t=>t.map(d=>d.id===l.id?{...d,status:c}:d);p(t=>s(t)),j(t=>s(t)),i(!1)}catch(s){console.error("Error updating status:",s)}},f=[...E.map(s=>({...s,source:"regular"})),...S.map(s=>({...s,source:"new"}))].filter(s=>o==="new"?s.source==="new":o==="regular"?s.source==="regular":!0).filter(s=>[s.employeeId,s.firstName,s.middleName,s.lastName,s.position,s.department,s.email,s.dateHired].filter(Boolean).some(t=>t.toLowerCase().includes(g.toLowerCase())));return e.jsxs(e.Fragment,{children:[e.jsx(N,{children:e.jsx(h,{xs:12,children:e.jsxs(P,{className:"mb-4",children:[e.jsx(L,{className:"d-flex justify-content-between align-items-center",children:e.jsx("strong",{children:"Employee Management"})}),e.jsxs(R,{children:[e.jsxs(N,{className:"mb-3",children:[e.jsx(h,{md:6,children:e.jsx(U,{placeholder:"Search by ID, name, position, department, etc...",value:g,onChange:s=>b(s.target.value)})}),e.jsx(h,{md:3,children:e.jsxs(w,{value:o,onChange:s=>v(s.target.value),children:[e.jsx("option",{value:"all",children:"All Employees"}),e.jsx("option",{value:"new",children:"New Hires Only"}),e.jsx("option",{value:"regular",children:"Regular Employees Only"})]})})]}),e.jsx("div",{style:{maxHeight:"500px",overflowY:"auto"},children:e.jsxs(A,{align:"middle",className:"mb-0 border",hover:!0,responsive:!0,children:[e.jsx(O,{children:e.jsxs(u,{children:[e.jsx(r,{children:"#"})," ",e.jsx(r,{children:"Employee ID"}),e.jsx(r,{children:"Name"}),e.jsx(r,{children:"Position"}),e.jsx(r,{children:"Department"}),e.jsx(r,{children:"Date Hired"}),e.jsx(r,{children:"Email"}),e.jsx(r,{className:"text-center",children:"Status"}),e.jsx(r,{className:"text-center",children:"Action"})]})}),e.jsx(z,{children:f.length>0?f.map((s,t)=>e.jsxs(u,{children:[e.jsx(a,{children:t+1})," ",e.jsx(a,{children:s.employeeId}),e.jsx(a,{children:M(s)}),e.jsx(a,{children:s.position}),e.jsx(a,{children:s.department}),e.jsx(a,{children:s.dateHired}),e.jsx(a,{children:s.email}),e.jsx(a,{className:"text-center",children:F(s.status)}),e.jsx(a,{className:"text-center",children:e.jsx(m,{color:"primary",size:"sm",onClick:()=>$(s),children:"Edit Status"})})]},s.id)):e.jsx(u,{children:e.jsxs(a,{colSpan:9,className:"text-center",children:[" ","No employees found."]})})})]})})]})]})})}),e.jsxs(Y,{visible:T,onClose:()=>i(!1),children:[e.jsx(q,{closeButton:!0,children:e.jsx(G,{children:"Edit Training Status"})}),e.jsx(J,{children:e.jsxs(w,{label:"Training Status",value:c,onChange:s=>C(s.target.value),children:[e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"in progress",children:"In Progress"}),e.jsx("option",{value:"completed",children:"Completed"})]})}),e.jsxs(K,{children:[e.jsx(m,{color:"secondary",onClick:()=>i(!1),children:"Cancel"}),e.jsx(m,{color:"primary",onClick:k,children:"Save"})]})]})]})};export{le as default};
