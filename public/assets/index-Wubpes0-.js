import{r,x as E,i as h,j as s}from"./index-UFS3oRg7.js";import{C as N,a as p}from"./CRow-BSrzcJut.js";import{C as $,a as A}from"./CCardBody-BGljlW3V.js";import{C as L}from"./CCardHeader-p8MgJvYW.js";import{d as U,a as u}from"./index.esm-CWHndQpR.js";import{C as w}from"./CFormSelect-B3ubXRJB.js";import{C as O,a as z,b as x,c as l,d as Y,e as a}from"./CTable-DLqr_LCo.js";import{a as q,b as G,c as J,d as K,e as Q,f as j}from"./DefaultLayout-BjRfA7ne.js";import"./CCloseButton-C7k228zc.js";import"./cil-user-lJA-Zaca.js";const oe=()=>{const[S,i]=r.useState([]),[v,f]=r.useState([]),[g,b]=r.useState(""),[c,T]=r.useState("all"),[H,o]=r.useState(!1),[d,B]=r.useState(null),[m,C]=r.useState("pending");r.useEffect(()=>{I(),M()},[]);const I=async()=>{try{const e=await E.get("https://backend-hr1.axleshift.com/api/employees"),t=e.data.data||e.data;F(t),i(t)}catch(e){console.error("Error fetching external employees:",e);try{const t=await h.get("/api/employee");i(t.data.data)}catch(t){console.error("Error fetching local employees:",t)}}},M=async()=>{try{const e=await E.get("https://backend-hr1.axleshift.com/api/newhires");f(e.data.data||e.data)}catch(e){console.error("Error fetching new hires:",e)}},F=async e=>{try{for(const t of e){const n={employeeId:t.employeeId,lastName:t.lastName,firstName:t.firstName,middleName:t.middleName,position:t.position,department:t.department,dateHired:t.dateHired,email:t.email};await h.post("/api/employee",n)}console.log("Employees saved successfully")}catch(t){console.error("Error saving employees:",t)}},D=e=>{const t=e.middleName?` ${e.middleName}`:"";return`${e.firstName}${t} ${e.lastName}`},k=e=>{switch(e){case"completed":return s.jsx(j,{color:"success",children:"Completed"});case"in progress":return s.jsx(j,{color:"warning",children:"In Progress"});case"pending":default:return s.jsx(j,{color:"secondary",children:"Pending"})}},P=e=>{B(e),C(e.status||"pending"),o(!0)},R=async()=>{if(d)try{await h.put(`/api/employee-training-status/${d.id}`,{status:m});const e=t=>t.map(n=>n.id===d.id?{...n,status:m}:n);i(t=>e(t)),f(t=>e(t)),o(!1)}catch(e){console.error("Error updating status:",e)}},y=[...S.map(e=>({...e,source:"regular"})),...v.map(e=>({...e,source:"new"}))].filter(e=>c==="new"?e.source==="new":c==="regular"?e.source==="regular":!0).filter(e=>[e.employeeId,e.firstName,e.middleName,e.lastName,e.position,e.department,e.email,e.dateHired].filter(Boolean).some(t=>t.toLowerCase().includes(g.toLowerCase())));return s.jsxs(s.Fragment,{children:[s.jsx(N,{children:s.jsx(p,{xs:12,children:s.jsxs($,{className:"mb-4",children:[s.jsx(L,{className:"d-flex justify-content-between align-items-center",children:s.jsx("strong",{children:"Employee Management"})}),s.jsxs(A,{children:[s.jsxs(N,{className:"mb-3",children:[s.jsx(p,{md:6,children:s.jsx(U,{placeholder:"Search by ID, name, position, department, etc...",value:g,onChange:e=>b(e.target.value)})}),s.jsx(p,{md:3,children:s.jsxs(w,{value:c,onChange:e=>T(e.target.value),children:[s.jsx("option",{value:"all",children:"All Employees"}),s.jsx("option",{value:"new",children:"New Hires Only"}),s.jsx("option",{value:"regular",children:"Regular Employees Only"})]})})]}),s.jsx("div",{style:{maxHeight:"500px",overflowY:"auto"},children:s.jsxs(O,{align:"middle",className:"mb-0 border",hover:!0,responsive:!0,children:[s.jsx(z,{children:s.jsxs(x,{children:[s.jsx(l,{children:"Employee ID"}),s.jsx(l,{children:"Name"}),s.jsx(l,{children:"Position"}),s.jsx(l,{children:"Department"}),s.jsx(l,{children:"Date Hired"}),s.jsx(l,{children:"Email"}),s.jsx(l,{className:"text-center",children:"Status"}),s.jsx(l,{className:"text-center",children:"Action"})]})}),s.jsx(Y,{children:y.length>0?y.map(e=>s.jsxs(x,{children:[s.jsx(a,{children:e.employeeId}),s.jsx(a,{children:D(e)}),s.jsx(a,{children:e.position}),s.jsx(a,{children:e.department}),s.jsx(a,{children:e.dateHired}),s.jsx(a,{children:e.email}),s.jsx(a,{className:"text-center",children:k(e.status)}),s.jsx(a,{className:"text-center",children:s.jsx(u,{color:"primary",size:"sm",onClick:()=>P(e),children:"Edit Status"})})]},e.id)):s.jsx(x,{children:s.jsx(a,{colSpan:8,className:"text-center",children:"No employees found."})})})]})})]})]})})}),s.jsxs(q,{visible:H,onClose:()=>o(!1),children:[s.jsx(G,{closeButton:!0,children:s.jsx(J,{children:"Edit Training Status"})}),s.jsx(K,{children:s.jsxs(w,{label:"Training Status",value:m,onChange:e=>C(e.target.value),children:[s.jsx("option",{value:"pending",children:"Pending"}),s.jsx("option",{value:"in progress",children:"In Progress"}),s.jsx("option",{value:"completed",children:"Completed"})]})}),s.jsxs(Q,{children:[s.jsx(u,{color:"secondary",onClick:()=>o(!1),children:"Cancel"}),s.jsx(u,{color:"primary",onClick:R,children:"Save"})]})]})]})};export{oe as default};
