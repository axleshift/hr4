import{r as m,j as e,h as f,P as s}from"./index-CVT1g4V-.js";import{c as l,a as C,d as N}from"./index.esm-CKNaS271.js";import{a as D,b as T,c as U,d as w}from"./DefaultLayout-CccSMrqa.js";import{C as M}from"./CModalTitle-Dm-oBTKp.js";import{C as P}from"./CForm-BsU5We1j.js";import{C as c}from"./CFormInput-nsGLBZ6P.js";import{C as E}from"./CFormSelect-B35oSIkF.js";import{C as A,a as H}from"./CRow-Bp51pGQ5.js";import{C as k,a as B}from"./CCardBody-m7QAVl8g.js";import{C as O}from"./CCardHeader-B3pFvbW1.js";import{c as z}from"./cil-user-plus-9sfVD_63.js";import{C as I,a as V,b as F,c as x,d as $,e as u}from"./CTable-D9x5KSnc.js";import{c as G}from"./cil-options-sHCm5Gxk.js";import"./CCloseButton-DCX_JhsZ.js";import"./cil-user-Ddrdy7PS.js";const R=({modalVisible:_,setModalVisible:h,user:a,fetchUsers:y,roles:j,departments:g})=>{const[t,p]=m.useState({name:"",email:"",role:"",department:"",employee_type:"",employment_status:"",date_of_hire:"",gender:"",phone_number:"",address:""}),[n,b]=m.useState({});m.useEffect(()=>{a&&p({name:a.name||"",email:a.email||"",role:a.role_id||"",department:a.department?a.department.id:"",employee_type:a.employee_type||"",employment_status:a.employment_status||"",date_of_hire:a.date_of_hire||"",gender:a.gender||"",phone_number:a.phone_number||"",address:a.address||""})},[a]);const o=r=>{const{name:v,value:S}=r.target;p(q=>({...q,[v]:S}))},i=()=>{const r={};return t.name||(r.name="Name is required"),t.email||(r.email="Email is required"),t.role||(r.role="Role is required"),t.department||(r.department="Department is required"),t.date_of_hire||(r.date_of_hire="Date of hire is required"),b(r),Object.keys(r).length===0},d=async r=>{if(r.preventDefault(),!!i())try{await f.put(`/api/users/${a.id}`,t),y(),h(!1)}catch(v){console.error("Error updating user profile:",v)}};return e.jsxs(D,{visible:_,onClose:()=>h(!1),size:"lg",children:[e.jsx(T,{children:e.jsx(M,{children:"Edit Profile"})}),e.jsx(U,{children:e.jsxs(P,{onSubmit:d,children:[e.jsx(l,{htmlFor:"name",children:"Full Name"}),e.jsx(c,{id:"name",name:"name",value:t.name,onChange:o,invalid:!!n.name}),n.name&&e.jsx("div",{className:"text-danger",children:n.name}),e.jsx(l,{htmlFor:"email",children:"Email"}),e.jsx(c,{id:"email",name:"email",value:t.email,readOnly:!0,invalid:!!n.email}),n.email&&e.jsx("div",{className:"text-danger",children:n.email}),e.jsx(l,{htmlFor:"role",children:"Role"}),e.jsxs(E,{id:"role",name:"role",value:t.role,onChange:o,invalid:!!n.role,children:[e.jsx("option",{value:"",children:"Select Role"}),j.map(r=>e.jsx("option",{value:r.id,children:r.name},r.id))]}),n.role&&e.jsx("div",{className:"text-danger",children:n.role}),e.jsx(l,{htmlFor:"department",children:"Department"}),e.jsxs(E,{id:"department",name:"department",value:t.department,onChange:o,invalid:!!n.department,children:[e.jsx("option",{value:"",children:"Select Department"}),g.map(r=>e.jsx("option",{value:r.id,children:r.name},r.id))]}),n.department&&e.jsx("div",{className:"text-danger",children:n.department}),e.jsx(l,{htmlFor:"employee_type",children:"Employee Type"}),e.jsx(c,{id:"employee_type",name:"employee_type",value:t.employee_type,onChange:o}),e.jsx(l,{htmlFor:"employment_status",children:"Employment Status"}),e.jsx(c,{id:"employment_status",name:"employment_status",value:t.employment_status,onChange:o}),e.jsx(l,{htmlFor:"date_of_hire",children:"Date of Hire"}),e.jsx(c,{id:"date_of_hire",name:"date_of_hire",type:"date",value:t.date_of_hire,onChange:o,invalid:!!n.date_of_hire}),n.date_of_hire&&e.jsx("div",{className:"text-danger",children:n.date_of_hire}),e.jsx(l,{htmlFor:"gender",children:"Gender"}),e.jsx(c,{id:"gender",name:"gender",value:t.gender,onChange:o}),e.jsx(l,{htmlFor:"phone_number",children:"Phone Number"}),e.jsx(c,{id:"phone_number",name:"phone_number",value:t.phone_number,onChange:o}),e.jsx(l,{htmlFor:"address",children:"Address"}),e.jsx(c,{id:"address",name:"address",value:t.address,onChange:o})]})}),e.jsxs(w,{children:[e.jsx(C,{color:"secondary",onClick:()=>h(!1),children:"Close"}),e.jsx(C,{color:"primary",onClick:d,children:"Save Changes"})]})]})};R.propTypes={modalVisible:s.bool.isRequired,setModalVisible:s.func.isRequired,user:s.shape({id:s.number.isRequired,name:s.string,email:s.string,role_id:s.number,department:s.shape({id:s.number,name:s.string}),employee_type:s.string,employment_status:s.string,date_of_hire:s.string,gender:s.string,phone_number:s.string,address:s.string}).isRequired,fetchUsers:s.func.isRequired,roles:s.array.isRequired,departments:s.array.isRequired};const oe=()=>{const[_,h]=m.useState([]),[a,y]=m.useState([]),[j,g]=m.useState(null),[t,p]=m.useState(!1);m.useEffect(()=>{b()},[]),m.useEffect(()=>{a.length>0&&n()},[a]);const n=async()=>{try{const i=await f.get("/api/users");h(i.data.data)}catch(i){console.error("Error fetching users:",i)}},b=async()=>{try{const i=await f.get("/api/roles");y(i.data)}catch(i){console.error("Error fetching roles:",i)}},o=async i=>{try{const d=await f.get(`/api/users/${i}`);g(d.data.data),p(!0)}catch(d){console.error("Error fetching user profile:",d)}};return e.jsxs(A,{children:[e.jsx(H,{xs:12,children:e.jsxs(k,{className:"mb-4",children:[e.jsxs(O,{className:"d-flex justify-content-between align-items-center",children:[e.jsx("strong",{children:"Access Control"}),e.jsxs(C,{color:"primary",children:[e.jsx(N,{icon:z,className:"me-2"}),"Add User"]})]}),e.jsx(B,{children:e.jsxs(I,{align:"middle",className:"mb-0 border",hover:!0,responsive:!0,children:[e.jsx(V,{children:e.jsxs(F,{children:[e.jsx(x,{children:"Name"}),e.jsx(x,{children:"Email"}),e.jsx(x,{className:"text-center",children:"Role"}),e.jsx(x,{className:"text-center",children:"Department"}),e.jsx(x,{className:"text-center",children:"Actions"})]})}),e.jsx($,{children:_.map(i=>{var d;return e.jsxs(F,{children:[e.jsx(u,{children:i.name}),e.jsx(u,{children:i.email}),e.jsx(u,{className:"text-center",children:((d=a.find(r=>r.id===i.role_id))==null?void 0:d.name)||"No Role"}),e.jsx(u,{className:"text-center",children:i.department||"No Department"}),e.jsx(u,{className:"text-center",children:e.jsxs(C,{color:"secondary",size:"sm",onClick:()=>o(i.id),children:[e.jsx(N,{icon:G,className:"me-1"}),"More"]})})]},i.id)})})]})})]})}),j&&e.jsx(R,{modalVisible:t,setModalVisible:p,user:j,fetchUsers:n,roles:a})]})};export{oe as default};
