import{r as l,_ as $,R as x,a as S,c as K,P as o,j as e,q as D}from"./index-Cv4vlkTs.js";import{a as M,b as z,c as le,d as W,e as U}from"./DefaultLayout-CRyhclbQ.js";import{C as ce}from"./cil-user-C4-qlInQ.js";import{C as F,a as q}from"./CRow-F-I8Jjes.js";import{c as _,d as X,a as w}from"./index.esm-CoaVDgYW.js";import{C as de}from"./CFormTextarea-C3VzUMdM.js";import{C as be,a as Ne}from"./CCardBody-BymDERkV.js";import{C as Ee}from"./CCardHeader-D2K49mkL.js";import{_ as we,f as Te,a as Se,T as Pe,u as Re}from"./CCloseButton-BgmDgKZM.js";import{C as Ae,a as De,b as ue,c as B,d as Fe,e as k}from"./CTable-ClxlyY2j.js";var me=l.createContext({}),Q=l.forwardRef(function(r,t){var m=r.children,s=r.activeItemKey,c=r.alwaysOpen,u=c===void 0?!1:c,p=r.className,i=r.flush,n=$(r,["children","activeItemKey","alwaysOpen","className","flush"]),a=l.useState(s),f=a[0],v=a[1];return x.createElement("div",S({className:K("accordion",{"accordion-flush":i},p)},n,{ref:t}),x.createElement(me.Provider,{value:{_activeItemKey:f,alwaysOpen:u,setActiveKey:v}},m))});Q.propTypes={alwaysOpen:o.bool,activeItemKey:o.oneOfType([o.number,o.string]),children:o.node,className:o.string,flush:o.bool};Q.displayName="CAccordion";var Y=l.createContext({}),Z=l.forwardRef(function(r,t){var m=r.children,s=r.className,c=r.id,u=r.itemKey,p=$(r,["children","className","id","itemKey"]),i=c??l.useId(),n=l.useRef(u??i),a=l.useContext(me),f=a._activeItemKey,v=a.alwaysOpen,C=a.setActiveKey,g=l.useState(f===n.current),y=g[0],N=g[1];return l.useEffect(function(){!v&&y&&C(n.current)},[y]),l.useEffect(function(){N(f===n.current)},[f]),x.createElement("div",S({className:K("accordion-item",s)},p,{ref:t}),x.createElement(Y.Provider,{value:{id:i,setVisible:N,visible:y}},m))});Z.propTypes={children:o.node,className:o.string,itemKey:o.oneOfType([o.number,o.string])};Z.displayName="CAccordionItem";function J(){return J=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var m=arguments[t];for(var s in m)({}).hasOwnProperty.call(m,s)&&(r[s]=m[s])}return r},J.apply(null,arguments)}function qe(r,t){return r.classList?!!t&&r.classList.contains(t):(" "+(r.className.baseVal||r.className)+" ").indexOf(" "+t+" ")!==-1}function $e(r,t){r.classList?r.classList.add(t):qe(r,t)||(typeof r.className=="string"?r.className=r.className+" "+t:r.setAttribute("class",(r.className&&r.className.baseVal||"")+" "+t))}function pe(r,t){return r.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function Ke(r,t){r.classList?r.classList.remove(t):typeof r.className=="string"?r.className=pe(r.className,t):r.setAttribute("class",pe(r.className&&r.className.baseVal||"",t))}var Oe=function(t,m){return t&&m&&m.split(" ").forEach(function(s){return $e(t,s)})},G=function(t,m){return t&&m&&m.split(" ").forEach(function(s){return Ke(t,s)})},ee=function(r){we(t,r);function t(){for(var s,c=arguments.length,u=new Array(c),p=0;p<c;p++)u[p]=arguments[p];return s=r.call.apply(r,[this].concat(u))||this,s.appliedClasses={appear:{},enter:{},exit:{}},s.onEnter=function(i,n){var a=s.resolveArguments(i,n),f=a[0],v=a[1];s.removeClasses(f,"exit"),s.addClass(f,v?"appear":"enter","base"),s.props.onEnter&&s.props.onEnter(i,n)},s.onEntering=function(i,n){var a=s.resolveArguments(i,n),f=a[0],v=a[1],C=v?"appear":"enter";s.addClass(f,C,"active"),s.props.onEntering&&s.props.onEntering(i,n)},s.onEntered=function(i,n){var a=s.resolveArguments(i,n),f=a[0],v=a[1],C=v?"appear":"enter";s.removeClasses(f,C),s.addClass(f,C,"done"),s.props.onEntered&&s.props.onEntered(i,n)},s.onExit=function(i){var n=s.resolveArguments(i),a=n[0];s.removeClasses(a,"appear"),s.removeClasses(a,"enter"),s.addClass(a,"exit","base"),s.props.onExit&&s.props.onExit(i)},s.onExiting=function(i){var n=s.resolveArguments(i),a=n[0];s.addClass(a,"exit","active"),s.props.onExiting&&s.props.onExiting(i)},s.onExited=function(i){var n=s.resolveArguments(i),a=n[0];s.removeClasses(a,"exit"),s.addClass(a,"exit","done"),s.props.onExited&&s.props.onExited(i)},s.resolveArguments=function(i,n){return s.props.nodeRef?[s.props.nodeRef.current,i]:[i,n]},s.getClassNames=function(i){var n=s.props.classNames,a=typeof n=="string",f=a&&n?n+"-":"",v=a?""+f+i:n[i],C=a?v+"-active":n[i+"Active"],g=a?v+"-done":n[i+"Done"];return{baseClassName:v,activeClassName:C,doneClassName:g}},s}var m=t.prototype;return m.addClass=function(c,u,p){var i=this.getClassNames(u)[p+"ClassName"],n=this.getClassNames("enter"),a=n.doneClassName;u==="appear"&&p==="done"&&a&&(i+=" "+a),p==="active"&&c&&Te(c),i&&(this.appliedClasses[u][p]=i,Oe(c,i))},m.removeClasses=function(c,u){var p=this.appliedClasses[u],i=p.base,n=p.active,a=p.done;this.appliedClasses[u]={},i&&G(c,i),n&&G(c,n),a&&G(c,a)},m.render=function(){var c=this.props;c.classNames;var u=Se(c,["classNames"]);return x.createElement(Pe,J({},u,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},t}(x.Component);ee.defaultProps={classNames:""};ee.propTypes={};var se=l.forwardRef(function(r,t){var m=r.children,s=r.className,c=r.horizontal,u=r.onHide,p=r.onShow,i=r.visible,n=$(r,["children","className","horizontal","onHide","onShow","visible"]),a=l.useRef(null),f=Re(t,a),v=l.useState(),C=v[0],g=v[1],y=l.useState(),N=y[0],b=y[1],L=function(){if(p&&p(),c){a.current&&b(a.current.scrollWidth);return}a.current&&g(a.current.scrollHeight)},R=function(){if(c){b(0);return}g(0)},E=function(){if(c){a.current&&b(a.current.scrollWidth);return}a.current&&g(a.current.scrollHeight)},H=function(){if(u&&u(),c){b(0);return}g(0)},A=function(){if(c){b(0);return}g(0)};return x.createElement(ee,{in:i,nodeRef:a,onEntering:L,onEntered:R,onExit:E,onExiting:H,onExited:A,timeout:350},function(P){var O=C===0?null:{height:C},I=N===0?null:{width:N};return x.createElement("div",S({className:K(s,{"collapse-horizontal":c,collapsing:P==="entering"||P==="exiting","collapse show":P==="entered",collapse:P==="exited"}),style:S(S({},O),I)},n,{ref:f}),m)})});se.propTypes={children:o.node,className:o.string,horizontal:o.bool,onHide:o.func,onShow:o.func,visible:o.bool};se.displayName="CCollapse";var re=l.forwardRef(function(r,t){var m=r.children,s=r.className,c=$(r,["children","className"]),u=l.useContext(Y),p=u.id,i=u.visible;return x.createElement(se,{className:"accordion-collapse",id:p,visible:i},x.createElement("div",S({className:K("accordion-body",s)},c,{ref:t}),m))});re.propTypes={children:o.node,className:o.string};re.displayName="CAccordionBody";var ie=l.forwardRef(function(r,t){var m=r.children,s=r.className,c=$(r,["children","className"]),u=l.useContext(Y),p=u.id,i=u.visible,n=u.setVisible;return x.createElement("button",S({type:"button",className:K("accordion-button",{collapsed:!i},s),"aria-controls":p,"aria-expanded":i,onClick:function(){return n(!i)}},c,{ref:t}),m)});ie.propTypes={children:o.node,className:o.string};ie.displayName="CAccordionButton";var ae=l.forwardRef(function(r,t){var m=r.children,s=r.className,c=$(r,["children","className"]);return x.createElement("div",S({className:K("accordion-header",s)},c,{ref:t}),x.createElement(ie,null,m))});ae.propTypes={children:o.node,className:o.string};ae.displayName="CAccordionHeader";const fe=({visibleProgram:r,setVisibleProgram:t,programTitle:m,setProgramTitle:s,programDescription:c,setProgramDescription:u,handleSaveProgram:p,visibleCourse:i,setVisibleCourse:n,courseTitle:a,setCourseTitle:f,courseDescription:v,setCourseDescription:C,setCourseFile:g,handleSaveCourse:y,modalVisible:N,setModalVisible:b,base64Doc:L,mimeType:R,fileName:E})=>{const[H,A]=l.useState(!1),[P,O]=l.useState(null),[I,te]=l.useState(""),[ne,oe]=l.useState("");return e.jsxs(e.Fragment,{children:[e.jsxs(M,{size:"lg",visible:r,onClose:()=>t(!1),children:[e.jsx(z,{children:e.jsx(le,{children:"Add Program"})}),e.jsx(W,{children:e.jsxs(ce,{children:[e.jsx(F,{className:"mb-3",children:e.jsxs(q,{md:12,children:[e.jsx(_,{children:"Program Title"}),e.jsx(X,{value:m,onChange:j=>s(j.target.value)})]})}),e.jsx(F,{className:"mb-3",children:e.jsxs(q,{md:12,children:[e.jsx(_,{children:"Program Description"}),e.jsx(de,{value:c,onChange:j=>u(j.target.value)})]})})]})}),e.jsxs(U,{children:[e.jsx(w,{color:"secondary",onClick:()=>t(!1),children:"Close"}),e.jsx(w,{color:"primary",onClick:p,children:"Save Program"})]})]}),e.jsxs(M,{size:"lg",visible:i,onClose:()=>n(!1),children:[e.jsx(z,{children:e.jsx(le,{children:"Add Course"})}),e.jsx(W,{children:e.jsxs(ce,{children:[e.jsx(F,{className:"mb-3",children:e.jsxs(q,{md:12,children:[e.jsx(_,{children:"Course Title"}),e.jsx(X,{value:a,onChange:j=>f(j.target.value)})]})}),e.jsx(F,{className:"mb-3",children:e.jsxs(q,{md:12,children:[e.jsx(_,{children:"Course Description"}),e.jsx(de,{value:v,onChange:j=>C(j.target.value)})]})}),e.jsx(F,{className:"mb-3",children:e.jsxs(q,{md:12,children:[e.jsx(_,{children:"Upload File"}),e.jsx(X,{type:"file",onChange:j=>g(j.target.files[0])})]})})]})}),e.jsxs(U,{children:[e.jsx(w,{color:"secondary",onClick:()=>n(!1),children:"Close"}),e.jsx(w,{color:"primary",onClick:y,children:"Save Course"})]})]}),e.jsxs(M,{visible:N,onClose:()=>b(!1),size:"xl",children:[e.jsx(z,{onClose:()=>b(!1),children:e.jsxs("strong",{children:["Document Preview: ",E]})}),e.jsxs(W,{style:{height:"600px"},children:[R==="application/pdf"&&e.jsx("iframe",{src:`https://hr4.axleshift.com/uploads/${E}`,title:"PDF Preview",style:{width:"100%",height:"100%"}}),R==="application/vnd.openxmlformats-officedocument.wordprocessingml.document"&&e.jsx("iframe",{src:`https://view.officeapps.live.com/op/embed.aspx?src=https://hr4.axleshift.com/uploads/${E}`,title:"DOCX Preview",style:{width:"100%",height:"100%"}})]}),e.jsx(U,{children:e.jsx(w,{color:"secondary",onClick:()=>b(!1),children:"Close"})})]})]})};fe.propTypes={visibleProgram:o.bool.isRequired,setVisibleProgram:o.func.isRequired,programTitle:o.string.isRequired,setProgramTitle:o.func.isRequired,programDescription:o.string.isRequired,setProgramDescription:o.func.isRequired,handleSaveProgram:o.func.isRequired,visibleCourse:o.bool.isRequired,setVisibleCourse:o.func.isRequired,courseTitle:o.string.isRequired,setCourseTitle:o.func.isRequired,courseDescription:o.string.isRequired,setCourseDescription:o.func.isRequired,setCourseFile:o.func.isRequired,handleSaveCourse:o.func.isRequired,modalVisible:o.bool.isRequired,setModalVisible:o.func.isRequired,base64Doc:o.string.isRequired,mimeType:o.string.isRequired,fileName:o.string.isRequired};const Ue=()=>{const[r,t]=l.useState([]),[m,s]=l.useState([]),[c,u]=l.useState(""),[p,i]=l.useState(""),[n,a]=l.useState(""),[f,v]=l.useState(""),[C,g]=l.useState(null),[y,N]=l.useState(null),[b,L]=l.useState(null),[R,E]=l.useState(!1),[H,A]=l.useState(!1),[P,O]=l.useState(!1),[I,te]=l.useState(""),[ne,oe]=l.useState(""),[j,he]=l.useState("");l.useEffect(()=>{(async()=>{try{const d=await D.get("/api/programs");t(d.data.data)}catch(d){console.error("Error fetching programs:",d)}})()},[]);const ve=async h=>{try{const d=await D.get(`/api/courses?program_id=${h}`);s(d.data.data)}catch(d){console.error("Error fetching courses:",d)}},Ce=async h=>{try{const d=await D.get(`/api/courses/${h}/preview`);te(d.data.base64),oe(d.data.mime_type),he(d.data.file_name),O(!0)}catch(d){console.error("Error fetching document preview:",d),alert("Failed to fetch document preview.")}},ge=async()=>{if(!c||!p){alert("Please provide both title and description for the program.");return}try{const h=await D.post("/api/programs",{title:c,description:p});t(d=>[...d,h.data.data]),u(""),i(""),E(!1)}catch(h){console.error("Error adding program:",h),alert("Failed to add program.")}},xe=async h=>{if(h.preventDefault(),!n||!f){alert("Please provide both title and description for the course.");return}const d=new FormData;d.append("title",n),d.append("description",f),d.append("program_id",y),C&&d.append("file",C);try{const T=await D.post("/api/courses",d,{headers:{"Content-Type":"multipart/form-data"}});s(V=>[...V,T.data]),A(!1),a(""),v(""),g(null)}catch(T){console.error("Error saving course:",T),alert("Failed to save course.")}},je=async h=>{try{await D.delete(`/api/courses/${h}`),s(d=>d.filter(T=>T.id!==h))}catch(d){console.error("Error deleting course:",d),alert("Failed to delete course.")}},ye=h=>{Ce(h)};return e.jsxs(F,{children:[e.jsx(q,{xs:12,children:e.jsxs(be,{className:"mb-4",children:[e.jsxs(Ee,{children:[e.jsx("strong",{children:"List of Programs"}),e.jsx("div",{className:"d-grid gap-2 d-md-flex justify-content-md-end",children:e.jsx(w,{color:"primary",onClick:()=>E(!0),children:"Add Program"})})]}),e.jsx(Ne,{children:e.jsx(Q,{alwaysOpen:!0,children:r.map(h=>e.jsxs(Z,{children:[e.jsx(ae,{onClick:()=>{ve(h.id)},children:h.title}),e.jsxs(re,{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Description:"})," ",h.description]}),e.jsx(w,{color:"primary",onClick:()=>{N(h.id),A(!0)},children:"Add Course"}),e.jsxs(Ae,{striped:!0,className:"mt-3",children:[e.jsx(De,{children:e.jsxs(ue,{children:[e.jsx(B,{children:"Course Title"}),e.jsx(B,{children:"Description"}),e.jsx(B,{children:"File"}),e.jsx(B,{children:"Actions"})]})}),e.jsx(Fe,{children:m.filter(d=>d.program_id===h.id).map(d=>{var T,V;return e.jsxs(ue,{children:[e.jsx(k,{children:d.title}),e.jsx(k,{children:d.description}),e.jsx(k,{children:(T=d.file_name)!=null&&T.endsWith(".docx")||(V=d.file_name)!=null&&V.endsWith(".pdf")?e.jsx(w,{color:"info",onClick:()=>ye(d.id),children:"View"}):e.jsx("span",{children:"No File"})}),e.jsx(k,{children:e.jsx(w,{color:"danger",onClick:()=>je(d.id),children:"Delete"})})]},d.id)})})]})]})]},h.id))})})]})}),e.jsx(fe,{visibleProgram:R,setVisibleProgram:E,programTitle:c,setProgramTitle:u,programDescription:p,setProgramDescription:i,handleSaveProgram:ge,visibleCourse:H,setVisibleCourse:A,courseTitle:n,setCourseTitle:a,courseDescription:f,setCourseDescription:v,setCourseFile:g,handleSaveCourse:xe,modalVisible:P,setModalVisible:O,base64Doc:I,mimeType:ne,fileName:j})]})};export{Ue as default};
