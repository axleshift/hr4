import{r as l,_ as P,R as C,a as b,c as R,P as h,j as r,q as _}from"./index-B7AcXAa_.js";import{C as K,a as O}from"./CRow-D8FkybyO.js";import{C as me,a as he}from"./CCardBody-D4h4UG_d.js";import{C as fe}from"./CCardHeader-iRb1ZuMg.js";import{a as w,c as $,d as Y}from"./index.esm-CZ0Di8le.js";import{_ as ve,f as Ce,a as xe,T as ge,u as je}from"./CCloseButton-D01J0ZEJ.js";import{C as Ne,a as Ee,b as Z,c as H,d as be,e as I}from"./CTable-JQ90va0y.js";import{a as ee,b as se,c as re,d as ae,e as ne}from"./DefaultLayout-CJf_Hmja.js";import{C as ie}from"./cil-user-C_ZUijRI.js";import{C as te}from"./CFormTextarea-7gL48j5r.js";var le=l.createContext({}),z=l.forwardRef(function(e,i){var u=e.children,s=e.activeItemKey,o=e.alwaysOpen,c=o===void 0?!1:o,p=e.className,a=e.flush,t=P(e,["children","activeItemKey","alwaysOpen","className","flush"]),n=l.useState(s),f=n[0],v=n[1];return C.createElement("div",b({className:R("accordion",{"accordion-flush":a},p)},t,{ref:i}),C.createElement(le.Provider,{value:{_activeItemKey:f,alwaysOpen:c,setActiveKey:v}},u))});z.propTypes={alwaysOpen:h.bool,activeItemKey:h.oneOfType([h.number,h.string]),children:h.node,className:h.string,flush:h.bool};z.displayName="CAccordion";var F=l.createContext({}),W=l.forwardRef(function(e,i){var u=e.children,s=e.className,o=e.id,c=e.itemKey,p=P(e,["children","className","id","itemKey"]),a=o??l.useId(),t=l.useRef(c??a),n=l.useContext(le),f=n._activeItemKey,v=n.alwaysOpen,x=n.setActiveKey,g=l.useState(f===t.current),N=g[0],E=g[1];return l.useEffect(function(){!v&&N&&x(t.current)},[N]),l.useEffect(function(){E(f===t.current)},[f]),C.createElement("div",b({className:R("accordion-item",s)},p,{ref:i}),C.createElement(F.Provider,{value:{id:a,setVisible:E,visible:N}},u))});W.propTypes={children:h.node,className:h.string,itemKey:h.oneOfType([h.number,h.string])};W.displayName="CAccordionItem";function k(){return k=Object.assign?Object.assign.bind():function(e){for(var i=1;i<arguments.length;i++){var u=arguments[i];for(var s in u)({}).hasOwnProperty.call(u,s)&&(e[s]=u[s])}return e},k.apply(null,arguments)}function ye(e,i){return e.classList?!!i&&e.classList.contains(i):(" "+(e.className.baseVal||e.className)+" ").indexOf(" "+i+" ")!==-1}function Ae(e,i){e.classList?e.classList.add(i):ye(e,i)||(typeof e.className=="string"?e.className=e.className+" "+i:e.setAttribute("class",(e.className&&e.className.baseVal||"")+" "+i))}function oe(e,i){return e.replace(new RegExp("(^|\\s)"+i+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function we(e,i){e.classList?e.classList.remove(i):typeof e.className=="string"?e.className=oe(e.className,i):e.setAttribute("class",oe(e.className&&e.className.baseVal||"",i))}var Se=function(i,u){return i&&u&&u.split(" ").forEach(function(s){return Ae(i,s)})},V=function(i,u){return i&&u&&u.split(" ").forEach(function(s){return we(i,s)})},q=function(e){ve(i,e);function i(){for(var s,o=arguments.length,c=new Array(o),p=0;p<o;p++)c[p]=arguments[p];return s=e.call.apply(e,[this].concat(c))||this,s.appliedClasses={appear:{},enter:{},exit:{}},s.onEnter=function(a,t){var n=s.resolveArguments(a,t),f=n[0],v=n[1];s.removeClasses(f,"exit"),s.addClass(f,v?"appear":"enter","base"),s.props.onEnter&&s.props.onEnter(a,t)},s.onEntering=function(a,t){var n=s.resolveArguments(a,t),f=n[0],v=n[1],x=v?"appear":"enter";s.addClass(f,x,"active"),s.props.onEntering&&s.props.onEntering(a,t)},s.onEntered=function(a,t){var n=s.resolveArguments(a,t),f=n[0],v=n[1],x=v?"appear":"enter";s.removeClasses(f,x),s.addClass(f,x,"done"),s.props.onEntered&&s.props.onEntered(a,t)},s.onExit=function(a){var t=s.resolveArguments(a),n=t[0];s.removeClasses(n,"appear"),s.removeClasses(n,"enter"),s.addClass(n,"exit","base"),s.props.onExit&&s.props.onExit(a)},s.onExiting=function(a){var t=s.resolveArguments(a),n=t[0];s.addClass(n,"exit","active"),s.props.onExiting&&s.props.onExiting(a)},s.onExited=function(a){var t=s.resolveArguments(a),n=t[0];s.removeClasses(n,"exit"),s.addClass(n,"exit","done"),s.props.onExited&&s.props.onExited(a)},s.resolveArguments=function(a,t){return s.props.nodeRef?[s.props.nodeRef.current,a]:[a,t]},s.getClassNames=function(a){var t=s.props.classNames,n=typeof t=="string",f=n&&t?t+"-":"",v=n?""+f+a:t[a],x=n?v+"-active":t[a+"Active"],g=n?v+"-done":t[a+"Done"];return{baseClassName:v,activeClassName:x,doneClassName:g}},s}var u=i.prototype;return u.addClass=function(o,c,p){var a=this.getClassNames(c)[p+"ClassName"],t=this.getClassNames("enter"),n=t.doneClassName;c==="appear"&&p==="done"&&n&&(a+=" "+n),p==="active"&&o&&Ce(o),a&&(this.appliedClasses[c][p]=a,Se(o,a))},u.removeClasses=function(o,c){var p=this.appliedClasses[c],a=p.base,t=p.active,n=p.done;this.appliedClasses[c]={},a&&V(o,a),t&&V(o,t),n&&V(o,n)},u.render=function(){var o=this.props;o.classNames;var c=xe(o,["classNames"]);return C.createElement(ge,k({},c,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},i}(C.Component);q.defaultProps={classNames:""};q.propTypes={};var G=l.forwardRef(function(e,i){var u=e.children,s=e.className,o=e.horizontal,c=e.onHide,p=e.onShow,a=e.visible,t=P(e,["children","className","horizontal","onHide","onShow","visible"]),n=l.useRef(null),f=je(i,n),v=l.useState(),x=v[0],g=v[1],N=l.useState(),E=N[0],y=N[1],S=function(){if(p&&p(),o){n.current&&y(n.current.scrollWidth);return}n.current&&g(n.current.scrollHeight)},M=function(){if(o){y(0);return}g(0)},T=function(){if(o){n.current&&y(n.current.scrollWidth);return}n.current&&g(n.current.scrollHeight)},X=function(){if(c&&c(),o){y(0);return}g(0)},D=function(){if(o){y(0);return}g(0)};return C.createElement(q,{in:a,nodeRef:n,onEntering:S,onEntered:M,onExit:T,onExiting:X,onExited:D,timeout:350},function(A){var B=x===0?null:{height:x},L=E===0?null:{width:E};return C.createElement("div",b({className:R(s,{"collapse-horizontal":o,collapsing:A==="entering"||A==="exiting","collapse show":A==="entered",collapse:A==="exited"}),style:b(b({},B),L)},t,{ref:f}),u)})});G.propTypes={children:h.node,className:h.string,horizontal:h.bool,onHide:h.func,onShow:h.func,visible:h.bool};G.displayName="CCollapse";var J=l.forwardRef(function(e,i){var u=e.children,s=e.className,o=P(e,["children","className"]),c=l.useContext(F),p=c.id,a=c.visible;return C.createElement(G,{className:"accordion-collapse",id:p,visible:a},C.createElement("div",b({className:R("accordion-body",s)},o,{ref:i}),u))});J.propTypes={children:h.node,className:h.string};J.displayName="CAccordionBody";var Q=l.forwardRef(function(e,i){var u=e.children,s=e.className,o=P(e,["children","className"]),c=l.useContext(F),p=c.id,a=c.visible,t=c.setVisible;return C.createElement("button",b({type:"button",className:R("accordion-button",{collapsed:!a},s),"aria-controls":p,"aria-expanded":a,onClick:function(){return t(!a)}},o,{ref:i}),u)});Q.propTypes={children:h.node,className:h.string};Q.displayName="CAccordionButton";var U=l.forwardRef(function(e,i){var u=e.children,s=e.className,o=P(e,["children","className"]);return C.createElement("div",b({className:R("accordion-header",s)},o,{ref:i}),C.createElement(Q,null,u))});U.propTypes={children:h.node,className:h.string};U.displayName="CAccordionHeader";const De=()=>{const[e,i]=l.useState([]),[u,s]=l.useState([]),[o,c]=l.useState(""),[p,a]=l.useState(""),[t,n]=l.useState(""),[f,v]=l.useState(""),[x,g]=l.useState({title:"",description:"",file:null}),[N,E]=l.useState(null),[y,S]=l.useState(!1),[M,T]=l.useState(!1),[X,D]=l.useState(!1),[A,B]=l.useState([]);l.useEffect(()=>{(async()=>{try{const m=await _.get("/api/programs");i(m.data.data)}catch(m){console.error("Error fetching programs:",m)}})()},[]);const L=async d=>{try{const m=await _.get(`/api/courses?program_id=${d}`);s(m.data.data)}catch(m){console.error("Error fetching courses:",m)}},ce=async d=>{try{const m=await _.get(`/api/modules?course_id=${d}`);B(m.data.data)}catch(m){console.error("Error fetching modules:",m)}},de=async()=>{try{const d=await _.post("/api/programs",{title:o,description:p});i(m=>[...m,d.data.data]),c(""),a(""),S(!1)}catch(d){console.error("Error adding program:",d)}},ue=async()=>{try{const d=await _.post("/api/courses",{title:t,description:f,program_id:N});s(m=>[...m,d.data]),T(!1)}catch(d){console.error("Error saving course:",d)}},pe=d=>{E(d),D(!0),ce(d)};return r.jsxs(K,{children:[r.jsx(O,{xs:12,children:r.jsxs(me,{className:"mb-4",children:[r.jsxs(fe,{children:[r.jsx("strong",{children:"List of Programs"}),r.jsx("div",{className:"d-grid gap-2 d-md-flex justify-content-md-end",children:r.jsx(w,{color:"primary",onClick:()=>S(!0),children:"Add Program"})})]}),r.jsx(he,{children:r.jsx(z,{alwaysOpen:!0,children:e.map(d=>r.jsxs(W,{children:[r.jsx(U,{onClick:()=>{L(d.id)},children:d.title}),r.jsxs(J,{children:[r.jsxs("p",{children:[r.jsx("strong",{children:"Description:"})," ",d.description]}),r.jsx(w,{color:"primary",onClick:()=>{E(d.id),T(!0)},children:"Add Course"}),r.jsxs(Ne,{striped:!0,className:"mt-3",children:[r.jsx(Ee,{children:r.jsxs(Z,{children:[r.jsx(H,{children:"Course Title"}),r.jsx(H,{children:"Description"}),r.jsx(H,{children:"Modules"}),r.jsx(H,{children:"Actions"})]})}),r.jsx(be,{children:u.filter(m=>m.program_id===d.id).map(m=>r.jsxs(Z,{children:[r.jsx(I,{children:m.title}),r.jsx(I,{children:m.description}),r.jsx(I,{children:r.jsxs("ul",{className:"mb-0",children:[A.filter(j=>j.course_id===m.id).map(j=>r.jsxs("li",{children:[r.jsx("strong",{children:j.title})," ","- ",j.description," ",j.file_url&&r.jsxs(r.Fragment,{children:["[",r.jsx("a",{href:j.file_url,target:"_blank",rel:"noopener noreferrer",children:j.file_name||"Download"}),"]"]})]},j.id)),A.filter(j=>j.course_id===m.id).length===0&&r.jsx("li",{children:"No modules available"})]})}),r.jsx(I,{children:r.jsx(w,{color:"success",size:"sm",onClick:()=>pe(m.id),children:"Add Module"})})]},m.id))})]})]})]},d.id))})})]})}),r.jsxs(ee,{size:"xl",visible:y,onClose:()=>S(!1),children:[r.jsx(se,{children:r.jsx(re,{children:"Add Program"})}),r.jsx(ae,{children:r.jsxs(ie,{children:[r.jsx(K,{className:"mb-3",children:r.jsxs(O,{md:12,children:[r.jsx($,{children:"Program Title"}),r.jsx(Y,{value:o,onChange:d=>c(d.target.value)})]})}),r.jsx(K,{className:"mb-3",children:r.jsxs(O,{md:12,children:[r.jsx($,{children:"Program Description"}),r.jsx(te,{value:p,onChange:d=>a(d.target.value)})]})})]})}),r.jsxs(ne,{children:[r.jsx(w,{color:"secondary",onClick:()=>S(!1),children:"Close"}),r.jsx(w,{color:"primary",onClick:de,children:"Save Program"})]})]}),r.jsxs(ee,{size:"xl",visible:M,onClose:()=>T(!1),children:[r.jsx(se,{children:r.jsx(re,{children:"Add Course"})}),r.jsx(ae,{children:r.jsxs(ie,{children:[r.jsx(K,{className:"mb-3",children:r.jsxs(O,{md:12,children:[r.jsx($,{children:"Course Title"}),r.jsx(Y,{value:t,onChange:d=>n(d.target.value)})]})}),r.jsx(K,{className:"mb-3",children:r.jsxs(O,{md:12,children:[r.jsx($,{children:"Course Description"}),r.jsx(te,{value:f,onChange:d=>v(d.target.value)})]})})]})}),r.jsxs(ne,{children:[r.jsx(w,{color:"secondary",onClick:()=>T(!1),children:"Close"}),r.jsx(w,{color:"primary",onClick:ue,disabled:!t||!f,children:"Save Course"})]})]})]})};export{De as default};
