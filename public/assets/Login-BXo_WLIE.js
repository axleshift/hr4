import{r,k as E,u as L,j as e,C as N,h as w,q as _}from"./index-DZSVTGu_.js";import{b as T,d as h,a as k}from"./index.esm-Dk4GI9T6.js";import{C,a as g}from"./CRow-X2glT5Js.js";import{C as q}from"./CCardGroup-D0SX0ICp.js";import{C as D,a as G}from"./CCardBody-D5fwiE2-.js";import{C as P}from"./CForm-BEUeFPSl.js";import{C as R}from"./CAlert-B7xOviMK.js";import{C as j,a as f}from"./CInputGroupText-CHbW1Qao.js";import{c as A}from"./cil-user-Ddrdy7PS.js";import{C as y}from"./CFormInput-CCdSjSId.js";import{c as B}from"./cil-lock-locked-DmxpJbVL.js";import"./CCloseButton-NIiRbeiK.js";const X=()=>{const[n,S]=r.useState(""),[l,b]=r.useState(""),[c,m]=r.useState(!1),[a,d]=r.useState({visible:!1,type:"",message:""}),p=E(),v=L(),I=async s=>{var u,x;s.preventDefault(),m(!0);try{const i=await w.post("/api/auth/login",{email:n,password:l}),{user:t,session_id:o}=i.data;p({type:"SET_USER",payload:t}),p({type:"SET_SESSION_ID",payload:o}),_.set("session_id",o,{expires:30,secure:!0,sameSite:"Strict"}),sessionStorage.setItem("session_id",o),sessionStorage.setItem("role",t.role),sessionStorage.setItem("user_id",t.id),sessionStorage.setItem("name",t.name),sessionStorage.setItem("email",t.email),v("/dashboard")}catch(i){d({visible:!0,type:"danger",message:((x=(u=i.response)==null?void 0:u.data)==null?void 0:x.message)||"Login failed. Please try again."})}finally{m(!1)}};return r.useEffect(()=>{if(a.visible){const s=setTimeout(()=>d({...a,visible:!1}),3e3);return()=>clearTimeout(s)}},[a]),e.jsx("div",{className:"bg-body-tertiary min-vh-100 d-flex flex-row align-items-center",children:e.jsx(T,{children:e.jsx(C,{className:"justify-content-center",children:e.jsx(g,{md:8,children:e.jsx(q,{children:e.jsx(D,{className:"p-4",children:e.jsx(G,{children:e.jsxs(P,{onSubmit:I,children:[e.jsx("h1",{children:"Login"}),e.jsx("p",{className:"text-body-secondary",children:"Sign in to your account"}),a.visible&&e.jsx(R,{color:a.type,children:a.message}),e.jsxs(j,{className:"mb-3",children:[e.jsx(f,{children:e.jsx(h,{icon:A})}),e.jsx(y,{type:"email",placeholder:"Email",value:n,onChange:s=>S(s.target.value),required:!0})]}),e.jsxs(j,{className:"mb-3",children:[e.jsx(f,{children:e.jsx(h,{icon:B})}),e.jsx(y,{type:"password",placeholder:"Password",value:l,onChange:s=>b(s.target.value),required:!0})]}),e.jsx(C,{children:e.jsx(g,{xs:6,children:e.jsx(k,{type:"submit",color:"primary",disabled:c,children:c?e.jsx(N,{size:"sm"}):"Login"})})})]})})})})})})})})};export{X as default};
