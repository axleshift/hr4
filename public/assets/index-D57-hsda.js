import{r as c,_ as F,R as j,a as T,c as $,P as o,j as e,i as A}from"./index-D6EjpClf.js";import{a as W,b as U,c as le,d as G,e as J}from"./DefaultLayout-DNQv9ZVO.js";import{C as ce}from"./cil-user-DWFLXiTS.js";import{C as D,a as q}from"./CRow-ML3bceaL.js";import{c as H,d as Q,a as N}from"./index.esm-BoevbiVk.js";import{C as de}from"./CFormTextarea-B91ubKYW.js";import{C as ge,a as je}from"./CCardBody-CW4aFHrr.js";import{C as be}from"./CCardHeader-DwRw6NMA.js";import{_ as ye,f as Ne,a as Ee,T as we,u as Te}from"./CCloseButton-DKp4La7q.js";import{C as Re,a as Se,b as ue,c as M,d as Pe,e as z}from"./CTable-DC1Vt4Jw.js";var me=c.createContext({}),Z=c.forwardRef(function(r,t){var m=r.children,s=r.activeItemKey,l=r.alwaysOpen,u=l===void 0?!1:l,p=r.className,a=r.flush,n=F(r,["children","activeItemKey","alwaysOpen","className","flush"]),i=c.useState(s),h=i[0],f=i[1];return j.createElement("div",T({className:$("accordion",{"accordion-flush":a},p)},n,{ref:t}),j.createElement(me.Provider,{value:{_activeItemKey:h,alwaysOpen:u,setActiveKey:f}},m))});Z.propTypes={activeItemKey:o.oneOfType([o.number,o.string]),alwaysOpen:o.bool,children:o.node,className:o.string,flush:o.bool};Z.displayName="CAccordion";function Y(){return Y=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var m=arguments[t];for(var s in m)({}).hasOwnProperty.call(m,s)&&(r[s]=m[s])}return r},Y.apply(null,arguments)}function Ae(r,t){return r.classList?!!t&&r.classList.contains(t):(" "+(r.className.baseVal||r.className)+" ").indexOf(" "+t+" ")!==-1}function De(r,t){r.classList?r.classList.add(t):Ae(r,t)||(typeof r.className=="string"?r.className=r.className+" "+t:r.setAttribute("class",(r.className&&r.className.baseVal||"")+" "+t))}function pe(r,t){return r.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function qe(r,t){r.classList?r.classList.remove(t):typeof r.className=="string"?r.className=pe(r.className,t):r.setAttribute("class",pe(r.className&&r.className.baseVal||"",t))}var Fe=function(t,m){return t&&m&&m.split(" ").forEach(function(s){return De(t,s)})},X=function(t,m){return t&&m&&m.split(" ").forEach(function(s){return qe(t,s)})},ee=function(r){ye(t,r);function t(){for(var s,l=arguments.length,u=new Array(l),p=0;p<l;p++)u[p]=arguments[p];return s=r.call.apply(r,[this].concat(u))||this,s.appliedClasses={appear:{},enter:{},exit:{}},s.onEnter=function(a,n){var i=s.resolveArguments(a,n),h=i[0],f=i[1];s.removeClasses(h,"exit"),s.addClass(h,f?"appear":"enter","base"),s.props.onEnter&&s.props.onEnter(a,n)},s.onEntering=function(a,n){var i=s.resolveArguments(a,n),h=i[0],f=i[1],C=f?"appear":"enter";s.addClass(h,C,"active"),s.props.onEntering&&s.props.onEntering(a,n)},s.onEntered=function(a,n){var i=s.resolveArguments(a,n),h=i[0],f=i[1],C=f?"appear":"enter";s.removeClasses(h,C),s.addClass(h,C,"done"),s.props.onEntered&&s.props.onEntered(a,n)},s.onExit=function(a){var n=s.resolveArguments(a),i=n[0];s.removeClasses(i,"appear"),s.removeClasses(i,"enter"),s.addClass(i,"exit","base"),s.props.onExit&&s.props.onExit(a)},s.onExiting=function(a){var n=s.resolveArguments(a),i=n[0];s.addClass(i,"exit","active"),s.props.onExiting&&s.props.onExiting(a)},s.onExited=function(a){var n=s.resolveArguments(a),i=n[0];s.removeClasses(i,"exit"),s.addClass(i,"exit","done"),s.props.onExited&&s.props.onExited(a)},s.resolveArguments=function(a,n){return s.props.nodeRef?[s.props.nodeRef.current,a]:[a,n]},s.getClassNames=function(a){var n=s.props.classNames,i=typeof n=="string",h=i&&n?n+"-":"",f=i?""+h+a:n[a],C=i?f+"-active":n[a+"Active"],x=i?f+"-done":n[a+"Done"];return{baseClassName:f,activeClassName:C,doneClassName:x}},s}var m=t.prototype;return m.addClass=function(l,u,p){var a=this.getClassNames(u)[p+"ClassName"],n=this.getClassNames("enter"),i=n.doneClassName;u==="appear"&&p==="done"&&i&&(a+=" "+i),p==="active"&&l&&Ne(l),a&&(this.appliedClasses[u][p]=a,Fe(l,a))},m.removeClasses=function(l,u){var p=this.appliedClasses[u],a=p.base,n=p.active,i=p.done;this.appliedClasses[u]={},a&&X(l,a),n&&X(l,n),i&&X(l,i)},m.render=function(){var l=this.props;l.classNames;var u=Ee(l,["classNames"]);return j.createElement(we,Y({},u,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},t}(j.Component);ee.defaultProps={classNames:""};ee.propTypes={};var se=c.forwardRef(function(r,t){var m=r.children,s=r.className,l=r.horizontal,u=r.onHide,p=r.onShow,a=r.visible,n=F(r,["children","className","horizontal","onHide","onShow","visible"]),i=c.useRef(null),h=Te(t,i),f=c.useState(),C=f[0],x=f[1],E=c.useState(),y=E[0],g=E[1],S=function(){if(p&&p(),l){i.current&&g(i.current.scrollWidth);return}i.current&&x(i.current.scrollHeight)},K=function(){if(l){g(0);return}x(0)},I=function(){if(l){i.current&&g(i.current.scrollWidth);return}i.current&&x(i.current.scrollHeight)},O=function(){if(u&&u(),l){g(0);return}x(0)},V=function(){if(l){g(0);return}x(0)};return j.createElement(ee,{in:a,nodeRef:i,onEntering:S,onEntered:K,onExit:I,onExiting:O,onExited:V,timeout:350},function(R){var P=C===0?null:{height:C},_=y===0?null:{width:y};return j.createElement("div",T({className:$(s,{"collapse-horizontal":l,collapsing:R==="entering"||R==="exiting","collapse show":R==="entered",collapse:R==="exited"}),style:T(T({},P),_)},n,{ref:h}),m)})});se.propTypes={children:o.node,className:o.string,horizontal:o.bool,onHide:o.func,onShow:o.func,visible:o.bool};se.displayName="CCollapse";var re=c.createContext({}),ie=c.forwardRef(function(r,t){var m=r.children,s=r.className,l=F(r,["children","className"]),u=c.useContext(re),p=u.id,a=u.visible;return j.createElement(se,{className:"accordion-collapse",id:p,visible:a},j.createElement("div",T({className:$("accordion-body",s)},l,{ref:t}),m))});ie.propTypes={children:o.node,className:o.string};ie.displayName="CAccordionBody";var ae=c.forwardRef(function(r,t){var m=r.children,s=r.className,l=F(r,["children","className"]),u=c.useContext(re),p=u.id,a=u.visible,n=u.setVisible;return j.createElement("button",T({type:"button",className:$("accordion-button",{collapsed:!a},s),"aria-controls":p,"aria-expanded":a,onClick:function(){return n(!a)}},l,{ref:t}),m)});ae.propTypes={children:o.node,className:o.string};ae.displayName="CAccordionButton";var te=c.forwardRef(function(r,t){var m=r.children,s=r.className,l=F(r,["children","className"]);return j.createElement("div",T({className:$("accordion-header",s)},l,{ref:t}),j.createElement(ae,null,m))});te.propTypes={children:o.node,className:o.string};te.displayName="CAccordionHeader";var ne=c.forwardRef(function(r,t){var m=r.children,s=r.className,l=r.id,u=r.itemKey,p=F(r,["children","className","id","itemKey"]),a=c.useId(),n=l??a,i=c.useRef(u??n),h=c.useContext(me),f=h._activeItemKey,C=h.alwaysOpen,x=h.setActiveKey,E=c.useState(f===i.current),y=E[0],g=E[1];return c.useEffect(function(){!C&&y&&x(i.current)},[y]),c.useEffect(function(){g(f===i.current)},[f]),j.createElement("div",T({className:$("accordion-item",s)},p,{ref:t}),j.createElement(re.Provider,{value:{id:n,setVisible:g,visible:y}},m))});ne.propTypes={children:o.node,className:o.string,itemKey:o.oneOfType([o.number,o.string])};ne.displayName="CAccordionItem";const he=({visibleProgram:r,setVisibleProgram:t,programTitle:m,setProgramTitle:s,programDescription:l,setProgramDescription:u,handleSaveProgram:p,visibleCourse:a,setVisibleCourse:n,courseTitle:i,setCourseTitle:h,courseDescription:f,setCourseDescription:C,setCourseFile:x,handleSaveCourse:E,modalVisible:y,setModalVisible:g,base64Doc:S,mimeType:K,fileName:I})=>{const[O,V]=c.useState(!1),[R,P]=c.useState(null),[_,k]=c.useState(""),[oe,B]=c.useState("");return e.jsxs(e.Fragment,{children:[e.jsxs(W,{size:"lg",visible:r,onClose:()=>t(!1),children:[e.jsx(U,{children:e.jsx(le,{children:"Add Program"})}),e.jsx(G,{children:e.jsxs(ce,{children:[e.jsx(D,{className:"mb-3",children:e.jsxs(q,{md:12,children:[e.jsx(H,{children:"Program Title"}),e.jsx(Q,{value:m,onChange:b=>s(b.target.value)})]})}),e.jsx(D,{className:"mb-3",children:e.jsxs(q,{md:12,children:[e.jsx(H,{children:"Program Description"}),e.jsx(de,{value:l,onChange:b=>u(b.target.value)})]})})]})}),e.jsxs(J,{children:[e.jsx(N,{color:"secondary",onClick:()=>t(!1),children:"Close"}),e.jsx(N,{color:"primary",onClick:p,children:"Save Program"})]})]}),e.jsxs(W,{size:"lg",visible:a,onClose:()=>n(!1),children:[e.jsx(U,{children:e.jsx(le,{children:"Add Course"})}),e.jsx(G,{children:e.jsxs(ce,{children:[e.jsx(D,{className:"mb-3",children:e.jsxs(q,{md:12,children:[e.jsx(H,{children:"Course Title"}),e.jsx(Q,{value:i,onChange:b=>h(b.target.value)})]})}),e.jsx(D,{className:"mb-3",children:e.jsxs(q,{md:12,children:[e.jsx(H,{children:"Course Description"}),e.jsx(de,{value:f,onChange:b=>C(b.target.value)})]})}),e.jsx(D,{className:"mb-3",children:e.jsxs(q,{md:12,children:[e.jsx(H,{children:"Upload File"}),e.jsx(Q,{type:"file",onChange:b=>x(b.target.files[0])})]})})]})}),e.jsxs(J,{children:[e.jsx(N,{color:"secondary",onClick:()=>n(!1),children:"Close"}),e.jsx(N,{color:"primary",onClick:E,children:"Save Course"})]})]}),e.jsxs(W,{size:"xl",visible:y,onClose:()=>g(!1),children:[e.jsx(U,{children:"Course Document Preview"}),e.jsx(G,{children:S?K==="application/pdf"?e.jsx("iframe",{src:S,style:{width:"100%",height:"500px",border:"none"}}):e.jsx("iframe",{src:`https://view.officeapps.live.com/op/embed.aspx?src=https://hr4.axleshift.com/uploads/${I}`,style:{width:"100%",height:"500px",border:"none"}}):e.jsx("p",{children:"No preview available."})}),e.jsx(J,{children:e.jsx(N,{color:"secondary",onClick:()=>g(!1),children:"Close"})})]})]})};he.propTypes={visibleProgram:o.bool.isRequired,setVisibleProgram:o.func.isRequired,programTitle:o.string.isRequired,setProgramTitle:o.func.isRequired,programDescription:o.string.isRequired,setProgramDescription:o.func.isRequired,handleSaveProgram:o.func.isRequired,visibleCourse:o.bool.isRequired,setVisibleCourse:o.func.isRequired,courseTitle:o.string.isRequired,setCourseTitle:o.func.isRequired,courseDescription:o.string.isRequired,setCourseDescription:o.func.isRequired,setCourseFile:o.func.isRequired,handleSaveCourse:o.func.isRequired,modalVisible:o.bool.isRequired,setModalVisible:o.func.isRequired,base64Doc:o.string.isRequired,mimeType:o.string.isRequired,fileName:o.string.isRequired};const Me=()=>{const[r,t]=c.useState([]),[m,s]=c.useState([]),[l,u]=c.useState(""),[p,a]=c.useState(""),[n,i]=c.useState(""),[h,f]=c.useState(""),[C,x]=c.useState(null),[E,y]=c.useState(null),[g,S]=c.useState(""),[K,I]=c.useState(""),[O,V]=c.useState(""),[R,P]=c.useState(!1),[_,k]=c.useState(!1),[oe,B]=c.useState(!1);c.useEffect(()=>{(async()=>{try{const d=await A.get("/api/programs");t(d.data.data)}catch(d){console.error("Error fetching programs:",d)}})()},[]);const b=async v=>{try{const d=await A.get(`/api/courses?program_id=${v}`);s(d.data.data)}catch(d){console.error("Error fetching courses:",d)}},fe=async v=>{try{const d=await A.get(`/api/courses/${v}/preview`);S(d.data.base64),I(d.data.mime_type),V(d.data.file_name),P(!0)}catch(d){console.error("Error fetching course document preview:",d),alert("Error fetching preview")}},ve=async()=>{if(!l||!p){alert("Please provide both title and description for the program.");return}try{const v=await A.post("/api/programs",{title:l,description:p});t(d=>[...d,v.data.data]),u(""),a(""),k(!1)}catch(v){console.error("Error adding program:",v),alert("Failed to add program.")}},Ce=async v=>{if(v.preventDefault(),!n||!h){alert("Please provide both title and description for the course.");return}const d=new FormData;d.append("title",n),d.append("description",h),d.append("program_id",E),C&&d.append("file",C);try{const w=await A.post("/api/courses",d,{headers:{"Content-Type":"multipart/form-data"}});s(L=>[...L,w.data]),B(!1),i(""),f(""),x(null)}catch(w){console.error("Error saving course:",w),alert("Failed to save course.")}},xe=async v=>{try{await A.delete(`/api/courses/${v}`),s(d=>d.filter(w=>w.id!==v))}catch(d){console.error("Error deleting course:",d),alert("Failed to delete course.")}};return e.jsxs(D,{children:[e.jsx(q,{xs:12,children:e.jsxs(ge,{className:"mb-4",children:[e.jsxs(be,{children:[e.jsx("strong",{children:"List of Programs"}),e.jsx("div",{className:"d-grid gap-2 d-md-flex justify-content-md-end",children:e.jsx(N,{color:"primary",onClick:()=>k(!0),children:"Add Program"})})]}),e.jsx(je,{children:e.jsx(Z,{alwaysOpen:!0,children:r.map(v=>e.jsxs(ne,{children:[e.jsx(te,{onClick:()=>b(v.id),children:v.title}),e.jsxs(ie,{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Description:"})," ",v.description]}),e.jsx(N,{color:"primary",onClick:()=>{y(v.id),B(!0)},children:"Add Course"}),e.jsxs(Re,{striped:!0,className:"mt-3",children:[e.jsx(Se,{children:e.jsxs(ue,{children:[e.jsx(M,{children:"Course Title"}),e.jsx(M,{children:"Description"}),e.jsx(M,{children:"File"}),e.jsx(M,{children:"Actions"})]})}),e.jsx(Pe,{children:m.filter(d=>d.program.id===v.id).map(d=>{var w,L;return e.jsxs(ue,{children:[e.jsx(z,{children:d.title}),e.jsx(z,{children:d.description}),e.jsx(z,{children:(((w=d.file_name)==null?void 0:w.endsWith(".docx"))||((L=d.file_name)==null?void 0:L.endsWith(".pdf")))&&e.jsx(N,{color:"info",onClick:()=>fe(d.id),children:"View"})}),e.jsx(z,{children:e.jsx(N,{color:"danger",onClick:()=>xe(d.id),children:"Delete"})})]},d.id)})})]})]})]},v.id))})})]})}),e.jsxs(W,{visible:R,onClose:()=>P(!1),children:[e.jsx(U,{children:"Document Preview"}),e.jsx(G,{children:g?K==="application/pdf"?e.jsx("iframe",{src:g,style:{width:"100%",height:"500px",border:"none"}}):e.jsx("iframe",{src:`https://view.officeapps.live.com/op/embed.aspx?src=https://hr4.axleshift.com/uploads/${O}`,style:{width:"100%",height:"500px",border:"none"}}):e.jsx("p",{children:"No preview available."})}),e.jsx(J,{children:e.jsx(N,{color:"secondary",onClick:()=>P(!1),children:"Close"})})]}),e.jsx(he,{visibleProgram:_,setVisibleProgram:k,programTitle:l,setProgramTitle:u,programDescription:p,setProgramDescription:a,handleSaveProgram:ve,visibleCourse:oe,setVisibleCourse:B,courseTitle:n,setCourseTitle:i,courseDescription:h,setCourseDescription:f,setCourseFile:x,handleSaveCourse:Ce})]})};export{Me as default};
